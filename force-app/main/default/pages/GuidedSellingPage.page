<apex:page standardStylesheets="false" action="{!updateEventSubject}" showHeader="false" sidebar="false" applyHtmlTag="false" applyBodyTag="false" docType="html-5.0" standardController="Opportunity" extensions="GuidedSellingControllerExtension,PreTSAControllerExtension">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en">    
<apex:form id="mainForm">
        <head>
        <meta charset="utf-8"/>
        <meta http-equiv="x-ua-compatible" content="ie=edge"/>
        <title>Guided Selling</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
        <apex:stylesheet value="{!URLFOR( $Resource.bootstrap, 'bootstrap-5.0.1-dist/css/bootstrap.min.css' )}" />
        <link REL="SHORTCUT ICON" HREF="{!URLFOR($Resource.accountantLogoFavicon)}"/>
        <!-- <link href="/GuidedSellingSales/slds/css/kaIoKnAZHZUvXbAOmzqoQg/min/scoped/one:oneNamespace,force:sldsTokens,force:base,force:formFactorLarge/slds.css" type="text/css" class="user" rel="stylesheet"/> -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
        <apex:slds />
        <style>
            body { 
            font-family: 'Poppins';
            font-feature-settings: 'ss01' on, 'ss02' on, 'ss04' on;
            margin: 0 auto; 
            float: center;
            overflow: hidden;
            }

            .slds-scope button {
            font-family: 'Poppins';
            font-feature-settings: 'ss01' on, 'ss02' on, 'ss04' on;
            color: none;
            }
            
            .slds-scope td {
            font-family: 'Poppins';
            font-feature-settings: 'ss01' on, 'ss02' on, 'ss04' on;
            }
            
            .slds-scope button, button {
            font-size: 17px;
            font-weight: 600;
            }
            
            .slds-scope hr {
            color: rgba(18, 23, 36, 0.2);
            margin: 0.7rem;
            width: 150%;
            margin-left: -125px;
            border-top: 0px;
            }
            
            hr {
            opacity: 1;
            }
            
            .slds-scope {
            font-family: 'Poppins';
            font-weight: 400;
            }
            
            .slds-scope .slds-box {
            border: none;
            border-radius: 0px;
            }
            
            .slds-scope .slds-wrap {
            flex-wrap: nowrap;
            }

            .textList li {
                font-size: 20px !important;
                line-height: 32px !important;
                letter-spacing: 0.01em !important;
                color: rgba(18, 23, 36, 0.91) !important;
            }

            .textList {
                list-style-type: disc !important;
                margin-left: 25px !important;
            }
            
            #formBody, #blastBody, #menuBody, #businessDisc, #businessDiscParts, #properEstityStrugleLLC,#properEstityStrugleSCorp, #flowThroughEntitySCorp, 
            #flowThroughEntityLLC, #entityClassificationElec, #properEntityStrugReviewLLC, #boiIntroLLC, #boiIntroSCorp,
            #selfEmploymentTaxSCorp, #reasonableSalarySCorp, #selfEmploymentTaxLLC, #properEntityStrugReviewSCorp, #deductionsIntro {
            margin: 0 auto;
            padding-left: 100px;
            padding-right: 100px;
            padding-bottom: 20px;
            overflow-y: auto;
            overflow-x: hidden;
            }
            
            #startUpCosts, #medicalDeduction, #vehicleDeduction, #homeOfficeDeduction, #codeDeduction, #reviewDeduction, #paperloss, #preparedPackages, #verifyInformation, 
            #scheduleDiscMeeting, #boiSummary,
            #paymentDetails, #postPurchase, #paymentDetails, #postPurchase, #features, #taxAdvisory, #portalTour, #filingBusinessTaxes, #filingECE, #presWrapUp {
            margin: 0 auto;
            padding-left: 100px;
            padding-right: 100px;
            padding-bottom: 20px;
            overflow-y: auto;
            overflow-x: hidden;
            width: 100%;
            }
            
            #blastBody, #formBody, #menuBody, #formClientDet, #formClientView, .slds-grid_vertical, #businessDisc, #businessDiscParts, #properEstityStrugleLLC, 
            #properEstityStrugleSCorp, #properEntityStrugReviewLLC, #boiIntroLLC, #boiIntroSCorp,
            #flowThroughEntitySCorp, #flowThroughEntityLLC, #entityClassificationElec, #selfEmploymentTaxSCorp, #reasonableSalarySCorp, #selfEmploymentTaxLLC, 
            #properEntityStrugReviewSCorp, #deductionsIntro {
            width: 100%;
            }

            #selfEmploymentTaxSCorp, #reasonableSalarySCorp, #selfEmploymentTaxLLC, #paperloss, #features, #portalTour {
            scroll-behavior: smooth;
            }
            
            #formClientDet {
            margin: 0 auto;
            overflow-y: auto;
            padding-left: 82px;
            padding-top: 37px;
            border: 1px solid #c0c0c0;
            }
            
            #formClientView {
            margin: 0 auto;
            background: #3F5261;
            overflow: hidden;
            position: relative;
            }

            #modalClientScreen {
            background: #3F5261;
            overflow: hidden;
            border-radius: 16px;
            width: 90%;
            height: 87%;
            margin-top: 1%;
            margin-left: 3%;
            }

            .clientContent {
                height: 87%;
                width: 94%;
                margin-top: -13%;
                margin-left: 3%;
                background: rgba(255, 255, 255, 1);
                top: 50%;
                -ms-transform: translateY(35%);
                transform: translateY(35%);
            }

            .openClientView {
                background: #FFFFFF;
                border-radius: 48px;
                width: 45px;
                height: 45px;
                right: 9px;
                top: 5px;
                border: none;
                color: rgba(18, 23, 36, 0.65);
                position: absolute;
            }
            
            #inlineFrameExample {
            position: absolute;
            top: 0;
            left: 4px;
            bottom: 0;
            right: 0;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
            margin-top: 50px;
            }

            #inlineFrameExampleClient {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
            }
            
            .noteClientView {
            font-weight: 600;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.02em;
            color: #FFFFFF;
            }
            
            .slds-scope p.noteClientView {
            bottom: 0px;
            position: absolute;
            text-align: center;
            margin-left: 30%;
            }
            
            .title {
            padding-top: 20px;
            }
            
            .titleTxt {
            font-weight: 500;
            font-size: 28px;
            line-height: 40px;
            color: #000000;
            }
            
            .formTxt {
            margin-top: 32px;
            max-width: 720px;
            }
            
            p.formTxtbottom {
            margin-bottom: 32px;
            }
            
            .subTitleTxt {
            font-weight: 500;
            font-size: 28px;
            line-height: 40px;
            letter-spacing: 0.01em;
            color: #000000;
            }
            
            .normalTxt {
            font-size: 20px;
            line-height: 32px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .slds-scope p.discoTitle {
            font-weight: 500;
            font-size: 18px;
            line-height: 28px;
            margin-bottom: 25px;
            margin-top: 90px;
            }
            
            .slds-scope p.discoTitle2 {
            font-weight: 500;
            font-size: 18px;
            line-height: 28px;
            margin-bottom: 25px;
            }
            
            .accInfo {
            margin-top: 24px;
            }
            
            .AccName {
            font-size: 24px;
            line-height: 36px;
            letter-spacing: 0.0075em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .leadSource, .blast {
            font-size: 18px;
            line-height: 28px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            }
            
            .blast {
            font-weight: 500;
            color: rgba(18, 23, 36, 0.91);
            }
            
            #buttons, .divider, .blast, .btnmodal {
            display: inline-block;
            }
            
            #btnEndNote {
            color: rgba(18, 23, 36, 0.65);
            font-size: 15px;
            line-height: 16px;
            }
            
            #buttons {
            margin-top: 12px;
            }
            
            #buttonsDisc {
            margin-top: 12px;
            margin-bottom: 25px;
            width: 50%;
            display: inline-block;
            }
            
            .divider {
            width: 12px;
            }
            
            .slds-scope button.yesBtn, .slds-scope button.noBtn  {
            font-size: 15px;
            border-radius: 30px;
            padding: 10px 16px;
            float: center;
            display: inline-block;
            font-weight: 600;
            letter-spacing: 0.02em;
            line-height: 24px;
            border: 1px solid #c0c0c0;
            background-color: white;
            color: black;
            background: white;
            }
            
            .slds-scope button.yesBtn:hover, .slds-scope button.noBtn:hover {
            background-color: #E6E6E6;
            border: 1px solid #c0c0c0;
            background: #E6E6E6;
            color: black;
            }
            
            .slds-scope button.hidequestion, .slds-scope button#showficaexample {
            font-size: 16px;
            border-radius: 30px;
            padding: 10px 16px;
            float: center;
            display: inline-block;
            font-weight: 600;
            letter-spacing: 0.02em;
            line-height: 24px;
            border: 1px solid #c0c0c0;
            background-color: white;
            color: #1776B6;
            background: white;
            }
            
            .slds-scope button.hidequestion:hover, .slds-scope button#showficaexample:hover {
            background-color: #1776B6;
            border: 1px solid #1776B6;
            background: #1776B6;
            color: white;
            }
            
            #txtRequired {
            font-weight: 600;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            }
            
            #txtRequiredOrange {
            font-weight: 600;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: #F15F22;
            }
            
            .slds-scope button.start, .start {
            font-size: 15px;
            border-radius: 36px;
            padding: 10px 16px;
            float: center;
            display: inline-block;
            font-weight: 500;
            line-height: 16px;
            letter-spacing: 0.75px;
            border: 1px solid #F15F22;
            background-color: #F15F22;
            color: white;
            background: #F15F22;
            opacity: 0.25;
            }
            
            #stopPres, #discardEditing {
            background-color: #C71331;
            background: #C71331;
            opacity: 0.5;
            padding: 13.7px 18px 13.7px 18px;
            }
                        
            #secondStart, #thirdStart #skiptoSale, #keepEditing, #btnDissolution, #saveEditClient, #saveEditPackage, #portalNextBtn, #skipficaexample, .start {
            opacity: 1;
            }
            
            #stopPres:hover, #discardEditing:hover {
            background-color: #cc2a45;
            color: #cc2a45;
            }
            
            #skiptoSale:hover, #btnDissolution:hover, #keepEditing:hover {
            background-color: rgb(23, 118, 182);
            color: white;
            }
            
            #btnAdd {
            align-items: right;
            text-align: right;
            }
            
            .slds-scope a.addPartnerstwo {
            color: #0780A6;
            font-size: 15px;
            line-height: 16px;
            letter-spacing: 0.75px;
            margin-left: 4px;
            margin-top: 50px;
            }
            
            .slds-scope a.addPartnerstwo:hover {
            text-decoration: none;
            color: #04475d;
            }
            
            .dims  {
            margin-top: 14px;
            margin-bottom: 1px;
            align-items: center;
            width: 99%;  
            height: 85%; 
            padding: 0.42em;
            }

            .changeover {
            align-items: center;
            width: 200px;  
            height: 400px; 
            }
            
            .accContacts {
            margin-top: 20px;
            }
            
            #contTable {
            border-collapse: collapse;
            width: 91.2%;  
            }
            
            #contTable td {
            padding-top: 16px;
            padding-bottom: 16px;
            }
            
            #contTable tr {
            border: solid rgba(18, 23, 36, 0.2);
            border-width: 1px 0;
            }
            
            #contTable tr:first-child {
            border-top: none;
            }
            
            #contTable tr td:first-child, #contTable tr td:last-child {
            width: 1%;
            white-space: nowrap;
            }
            
            #contTable tr:last-child {
            border-bottom: none;
            }
            
            .contIni {
            background: #3B7A80;
            font-weight: 600;
            font-size: 17px;
            line-height: 25.5px;
            color: #FFFFFF;
            margin-right: 16px;
            padding-left: 17px;
            padding-right: 17px;
            padding-top: 10px;
            padding-bottom: 10px;
            border-radius: 150px;
            }
            
            .contInfo {
            text-align: left;
            }
            
            .contContaInfo {
            text-align: right;
            }
            
            .contName {
            color: rgba(18, 23, 36, 0.91);
            font-weight: 600;
            }
            
            .contRole, .contPhone, .contEmail {
            color: rgba(18, 23, 36, 0.65);
            }
            
            .contName, .contRole, .contPhone, .contEmail {
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            }
            
            .contMore {
            font-size: 24px;
            margin-left: 16px;
            position: relative;
            display: inline-block;
            }
            
            form, .form-floating {
            width: 100%;
            margin: 0;
            }
            
            .form-floating>.form-control, .form-floating>.form-select {
            height: 44px;
            }
            
            .form-floating input#businessName, .form-floating input#ownersOutside {
            height: 52px;
            width: 40%;
            margin-top: 2%;
            }
            
            .form-floating>.form-select {
            padding-top: 3%;
            }
            
            .form-select {
            background-image: url({!$Resource.arrow});
            height: 5px;
            background-size: auto;
            }

            .date-select {
                height: auto;
                padding-top: 5%;
                padding-bottom: 5%;
                padding-left: 5%;
                padding-right: 2%;
                flex-direction: row;
                width: 100%;
            }
            
            .form-floating select {
            font-weight: 400;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            font-weight: normal;
            font-size: 15px;
            line-height: 20px;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .form-btn {
            align-items: right;
            float: right;
            }
            
            .slds-scope button.btnSkip, .slds-scope button.btnStop {
            background-color: #FFFFFF;
            background: #FFFFFF;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 30px;
            font-weight: 500;
            font-size: 15px;
            line-height: 16px;
            letter-spacing: 0.75px;
            margin: 0px 8px;
            padding: 13.7px 18px 13.7px 18px;
            }
            
            .slds-scope button.btnSkip {
            color: #1776B6;
            }
            
            .slds-scope button.btnStop {
            color: #C71331;
            }
            
            .btnSkip:hover {
            color: #0B3C5E;
            }
            
            .btnStop:hover {
            color: #0B3C5E;
            }
            
            .partTable {
            margin-top: 16px;
            margin-bottom: 16px;
            }

            .bullet {
                list-style-type: disc;
            }
            
            #addPartTable1, #addPartTable2 {
            border-collapse: collapse; 
            }
            
            #addPartTable1 td, #addPartTable2 td {
            padding-top: 24px;
            padding-bottom: 24px;
            }
            
            #addPartTable1 tr:first-child, #addPartTable2 tr:first-child {
            border-top: 2px solid rgba(18, 23, 36, 0.2);
            }
            
            #addPartTable1 tr:last-child, #addPartTable2 tr:last-child {
            border-bottom: 2px solid rgba(18, 23, 36, 0.2);
            }
            
            #addPartTable2 tr td:first-child, #addPartTable2 tr td:last-child {
            width: 1%;
            white-space: nowrap;
            }
            
            .modal {
            display: none;
            background: rgba(18, 23, 36, 0.2);
            position: fixed;
            margin:0 auto;
            width:100%;
            height:100%;
            }
            
            .content{
            width: 640px;
            background: rgba(255, 255, 255, 1);
            margin:0 auto;
            padding-top: 1%;
            padding-bottom: 2%;
            border-radius: 7px;
            top: 50%;
            -ms-transform: translateY(35%);
            transform: translateY(35%);
            }
            
            #modalHeaderTable td {
            padding-bottom: 2%;
            padding-left: 3.5%;
            padding-right: 3.5%;
            }
                        
            .modalHeaderTitle {
            font-weight: 500;
            font-size: 20px;
            line-height: 28px;
            letter-spacing: 0.15px;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .slds-scope button.modalHeaderClose {
            float: right;
            color: rgba(18, 23, 36, 0.65);
            background-color: #FFFFFF;
            background: #FFFFFF;
            border: 1px solid #FFFFFF;
            font-weight: 500;
            font-size: 15px;
            line-height: 16px;
            letter-spacing: 0.75px;
            margin-top: 2.5%;
            }
            
            .slds-scope button.modalHeaderClose:hover {
            color: #000000;
            }
            
            #modalBody {
            padding-top: 32px;
            padding-bottom: 32px;
            padding-right: 3.5%;
            padding-left: 3.5%;
            }
            
            .form-floating input {
            font-weight: 400;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 4px;
            display: flex;
            flex-direction: row;
            font-weight: normal;
            font-size: 15px;
            line-height: 20px;
            color: rgba(18, 23, 36, 0.65);
            }
            
            #modalBody>.form-floating>input {
            height: 54px;
            width: 480px;
            }
            
            #modalBody>.form-floating {
            padding-bottom: 24px;
            }
            
            #modalFooter {
            padding-right: 2%;
            padding-left: 2%;
            }
            
            .slds-scope button.btnAddRow, .slds-scope button.btnSaveEditClient, .slds-scope button.btnSaveEditPackage, .slds-scope button#skipficaexample {
            color: #FFFFFF;
            background-color: #F15F22;
            background: #F15F22;
            border: 1px solid #F15F22;
            opacity: 0.25;
            font-weight: 600;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.02em;
            border-radius: 30px;
            line-height: 16px;
            margin: 0px 8px;
            padding: 13.7px 18px 13.7px 18px;
            }
            
            .slds-scope button.btnCloseModal {
            color: rgba(18, 23, 36, 0.91);
            background-color: #FFFFFF;
            background: #FFFFFF;
            border: 1px solid rgba(18, 23, 36, 0.2);
            font-weight: 600;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.02em;
            border-radius: 30px;
            line-height: 16px;
            margin: 0px 8px;
            padding: 13.7px 18px 13.7px 18px;
            }
            
            .slds-scope button.btnCloseModal:hover {
            background-color: #E6E6E6;
            background: #E6E6E6;
            }
            
            .slds-scope button.backBtn {
            color: #1776B6;
            background-color: #FFFFFF;
            background: #FFFFFF;
            border: none;
            padding: 0;
            font-size: 15px;
            line-height: 24px;
            }
            
            .slds-scope button.backBtn:hover {
            color: #04475d;
            }
            
            .backDesc {
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            }
            
            .modalTitle {
            font-size: 20px;
            line-height: 32px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .modalDesc {
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            }

            #notLLC, #incomplete, #notInterested {
                margin-top: 1%;
            }
            
            .slds-scope p.modalOption {
                font-weight: 400;
                font-size: 16px;
                line-height: 24px;
                letter-spacing: 0.01em;
                color: rgba(18, 23, 36, 0.65);
                margin-bottom: 3%;
            }
            
            #btnSubMenu {
            cursor: pointer;
            }
            
            .dropdown-content {
            display: none;
            position: absolute;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            width: 166px;
            background: #FFFFFF;
            border-radius: 8px;
            top: 100%;
            left: -595%;
            }
            
            .slds-scope .dropdown-content a {
            padding: 12px;
            display: block;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.5px;
            float: left;
            }
            
            .slds-scope .contMore a:hover {
            text-decoration: none;
            color: #1776B6;
            }
            
            .show {
            display: block; 
            }
            
            #icon {
            color: rgba(0, 0, 0, 0.54);
            vertical-align: middle;
            }
            
            #edit {
            border-top: 1px solid rgba(18, 23, 36, 0.2);
            }
            
            .context-menu {
            position: absolute;
            text-align: center;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            background: #FFFFFF;
            border-radius: 8px;
            }
            
            .context-menu ul {
            min-width: 130px;
            }
            
            .context-menu ul li {
            padding-bottom: 7px;
            padding-top: 7px;
            }
            
            .context-menu ul li:hover {
            text-decoration: none;
            color: #1776B6;
            }
            
            .highlight {
            background-color: #8BD5C6;
            }
            
            .unhighlight {
            background-color: none;
            }
            
            #engageTxt {
            font-size: 24px;
            line-height: 36px;
            letter-spacing: 0.0075em;
            color: rgba(18, 23, 36, 0.65);
            vertical-align: middle;
            }
            
            #engage, #engagee, #emailSent {
            vertical-align: middle;
            border-bottom-style: solid;
            border-Top-style: solid;
            border-bottom-width: 1px;
            border-top-width: 1px;
            border-bottom-color: rgba(18, 23, 36, 0.2);
            border-Top-color: rgba(18, 23, 36, 0.2);
            margin-bottom: 20px;
            padding-Top: 10px;
            padding-bottom: 10px;            
            }

            #emailSent {
                display: none;
            }

            #engagee {
            margin-top: 24px;
            }
            
            .slds-scope button#currSlide2, .slds-scope button#currSlide1, .slds-scope button#currSlide3, 
            .slds-scope button#currentSlide1, .slds-scope button#currentSlide2, .slds-scope button#currentSlide3, 
            .slds-scope button#currtSlide3, .slds-scope button#currtSlide2, .slds-scope button#currtSlide1,
            .slds-scope button#currtSlide1features, .slds-scope button#currtSlide2features, .slds-scope button#currtSlide3features,
            .slds-scope button#currtSlide1portalTour, .slds-scope button#currtSlide2portalTour, .slds-scope button#currtSlide3portalTour, .slds-scope button#currtSlide4portalTour, 
            .slds-scope button#currtSlide5portalTour, .slds-scope button#currtSlide6portalTour, .slds-scope button#currtSlide7portalTour, .slds-scope button#currtSlide8portalTour , 
            .slds-scope button#currtSlide9portalTour {
            font-weight: 600;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.02em;
            color: rgba(18, 23, 36, 0.91);
            border-radius: 36px;
            padding: 5px 16px;
            float: center;
            display: inline-block;
            border: 1px solid #E7EAF0;
            background-color: #E7EAF0;
            background: #E7EAF0;
            }
            
            .placeHold {
            font-size: 15px;
            line-height: 20px;
            letter-spacing: 0.15px;
            color: rgba(18, 23, 36, 0.65);
            }
            
            .form-floating select#state option:first-child { 
            color: rgba(18, 23, 36, 0.65);
            }
            
            #verticaltLine1,  #verticaltLine2,  #verticaltLine3, 
            #verticalSectLine1, #verticalSectLine2, #verticalSectLine3,
            #vertSectLine1, #vertSectLine2, #vertSectLine3, 
            #vertLine1features, #vertLine2features, #vertLine3features, 
            #vertLine1portalTour, #vertLine2portalTour, #vertLine3portalTour, #vertLine4portalTour, #vertLine5portalTour, #vertLine6portalTour, #vertLine7portalTour, #vertLine8portalTour, #vertLine9portalTour {
            border-radius: 4px;
            border-left: 5px solid #F15F22;
            padding-left: 16px;
            margin-left: -20px;
            }
            
            .quote {
            display: none;
            padding: 10px 10px 10px 20px;
            width: 91.2%;
            height: 60px;
            left: 0px;
            background: #F7F5F2;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 64px;
            }
            
            .slds-scope p.quoteTitle {
            font-weight: 500;
            font-size: 18px;
            line-height: 28px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .slds-scope p.quoteText {
            font-weight: 600;
            font-size: 18px;
            line-height: 28px;
            text-align: right;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .slds-scope button#quoteEdit {
            padding: 8px 16px;
            width: 62px;
            height: 40px;
            font-weight: 600;
            line-height: 24px;
            letter-spacing: 0.02em;
            opacity: 1;
            float: right;
            }
                        
            .form-floating>.form-select[data-id=mainCategory] {
            padding-top: 16px;
            padding-bottom: 16px;
            height: 2%;
            }
            
            #quetionsTable > tbody > tr {
            border-bottom: 1px solid rgba(18, 23, 36, 0.2);
            }
            
            #quetionsTable > tbody > tr > td.actionRow {
            display: flex;
            margin-top: 25%;
            }
            
            #quetionsTable > tbody > tr > td.questionRow {
            width: 85%;
            }

            .checkboxes label {
                font-size: 20px;
                line-height: 32px;
                letter-spacing: 0.01em;
                color: rgba(18, 23, 36, 0.91);
                background: none;
            }

            .checkboxes input {
                width: 15px;
                height: 15px;
                margin-right: 5px;
            }
            
            #showtxt {
            font-weight: 500;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            margin-right: 7%;
            }
            
            .switch {
            position: relative;
            display: inline-block;
            width: 36px;
            height: 22px;
            margin-top: 1.6%;
            margin-right: 4%
            }
            
            .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
            }
            
            .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #75777A;
            -webkit-transition: .4s;
            transition: .4s;
            }
            
            .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 3px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
            
            }
            
            input:checked + .slider {
            background-color: #F15F22;
            /* opacity: 0.25; */
            
            
            }
            
            input:checked + .slider:before {
            -webkit-transform: translateX(80%);
            -ms-transform: translateX(80%);
            transform: translateX(80%);
            
            
            }
            
            .slider.round {
            border-radius: 34px;
            }
            
            .slider.round:before {
            border-radius: 50%;
            }
            
            #optTitle {
            font-weight: 600;
            font-size: 16px;
            line-height: 24px;
            }
            
            p.optText {
            background: #F6F4F2;     
            padding: 20px;
            border-left: 4px solid rgba(18, 23, 36, 0.2);
            border-radius: 5px;
            }
            
            #shadowText {
            text-shadow: 1px 1px grey;
            }

            #employees, #hasEmpContractors, #hasRentals, #workingHome, #drive {
                border: none !important;
            }
            
            #editPackage, #reschedule {
            display: flex;
            margin-bottom: 3%;
            vertical-align: middle;
            }
            
            #ending {
            opacity: 1;
            margin-bottom: 3%;
            vertical-align: middle;
            }
            
            #btnSendQuote {
            border: 1px solid rgb(231, 234, 240);
            color: rgb(23, 118, 182);
            background: white;
            font-weight: 600;
            font-size: 15px;
            line-height: 24px;
            letter-spacing: 0.02em;
            border-radius: 36px;
            padding: 5px 16px;
            float: center;
            display: inline;
            margin-bottom: 3%;
            margin-top: 3%;
            vertical-align: middle;
            }
            
            #skiptoSale, #btnDissolution, #keepEditing {
            border: 1px solid rgb(231, 234, 240);
            color: rgb(23, 118, 182);
            background: white;
            font-weight: 500;
            font-size: 15px;
            line-height: 16px;
            letter-spacing: 0.75px;
            border-radius: 36px;
            padding: 13.7px 18px 13.7px 18px;
            display: inline;
            vertical-align: middle;
            }

            #keepEditing {
            padding: 9.7px 18px 9.7px 18px;
            }

            .slds-scope button.accordion {
            width: 100%;
            border: none;
            background-color: white; 
            border-bottom: solid 1px rgba(18, 23, 36, 0.2);
            text-align: left;
            outline: none;
            font-weight: 500;
            font-size: 24px;
            line-height: 36px;
            letter-spacing: 0.0075em;
            color: rgba(18, 23, 36, 0.91);
            transition: 0.4s;
            margin-bottom: 3%;
            }

            .active, .accordion:hover {
            background-color: white; 
            }

            .panel {
            display: none;
            overflow: hidden;
            padding-left: 1%;
            padding-right: 1%;
            }
            
            .slds-scope p#commonObjections {
            font-weight: 500;
            font-size: 28px;
            line-height: 40px;
            color: rgba(18, 23, 36, 0.91);
            margin-bottom: 5%;
            margin-top: 5%;
            }
            
            .arrows {
            text-align: right;
            padding: 4px;
            float: right;
            background: #E7EAF0;
            border-radius: 32px;
            }
            
            #lessArrow1, #lessArrow2, #lessArrow3, #lessArrow4, #lessArrow5, #lessArrow6 {
            display: none;
            }
            
            #modalBodyPackage {
            padding-top: 1.5%;
            padding-right: 1.5%;
            padding-left: 1.5%;
            }
            
            .tabs {
            display: flex;
            margin: 0;
            overflow: hidden; 
            }
            
            .tabs [class^="tab"] label, .tabs [class*=" tab"] label {
            color: rgba(18, 23, 36, 0.91);
            cursor: pointer;
            display: block;
            font-weight: 500;
            font-size: 14px;
            line-height: 24px;
            letter-spacing: 0.75px;
            padding: 7px 15px;
            text-align: center;
            background: #FFFFFF;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 40px;
            margin-right: 6px;
            }
  
            .tabs [class^="tab"] [type="radio"], .tabs [class*=" tab"] [type="radio"] {
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            display: block;
            width: 100%;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out; 
            }

            .tabs [class^="tab"] label:hover, .tabs [class^="tab"] label:focus, 
            .tabs [class*=" tab"] label:hover, .tabs [class*=" tab"] label:focus {
            background: #e3e4e4;
            }
                
            .tabs [class^="tab"] [type="radio"]:checked + div, .tabs [class*=" tab"] [type="radio"]:checked + div {
            opacity: 1; 
            }
    
            .tabs [class^="tab"] [type="radio"] + div, .tabs [class*=" tab"] [type="radio"] + div {
            display: block;
            opacity: 0;
            padding: 10px 0;
            width: 90%;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out; 
            }
              
            .tabs .tab-2 [type="radio"]:checked + div {
            margin-left: 0; 
            }
            
            input[type=checkbox].radiobtn, output[type=checkbox].radiobtn {
            position: absolute;
            visibility: hidden;
            display: none;
            }
        
            .radioLabel {
            color: #1776B6;
            display: table-cell;
            cursor: pointer;
            font-weight: bold;
            padding: 11px 9px;
            }
        
            input[type=checkbox]:checked.radiobtn + label, output[type=checkbox]:checked.radiobtn + label {
            color: rgba(18, 23, 36, 0.91);
            background: rgba(23, 118, 182, 0.16);
            }
        
            label + input[type=checkbox] + label, label + output[type=checkbox] + label {
            border-left: 1px solid rgba(18, 23, 36, 0.2);
            }
            
            .radio-group {
            border: 1px solid rgba(18, 23, 36, 0.2);
            display: inline-block;
            margin-left: 11px;
            margin-right: 11px;
            border-radius: 10px;
            overflow: hidden;
            }
            
            .slds-scope p.planPackageTableTitle {
            font-weight: 500;
            font-size: 14px;
            line-height: 20px;
            text-align: center;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            }
            
            .slds-scope p.planPackageTableProd {
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            margin-left: 18px;
            }
            
            .slds-scope p.planPackageTableCost {
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            text-align: right;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .slds-scope p.planPackageTableSubtotal {
            font-weight: 600;
            font-size: 16px;
            line-height: 24px;
            text-align: right;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .form-floating>#planPackageTableQuantity:not(:placeholder-shown), .form-floating>#planPackageTableQuantityOutput:not(:placeholder-shown) {
            padding-top: 0.6rem;
            width: 105px;
            float: right;
            }
            
            input[type=checkbox]#actionPlanTable:checked, input[type=checkbox]#authorizes:checked, input[type=checkbox]#receiveMessages:checked {
            background: #3B7A80;
            background-color: #3B7A80;
            }
            
            input[type=checkbox]#actionPlanTable, input[type=checkbox]#authorizes, input[type=checkbox]#receiveMessages {
            background: #FFFFFF;
            Width: 25px;
            Height: 15px;
            }
            
            .modalNote {
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            text-align: right;
            letter-spacing: 0.01em;
            color: #000000;
            }
            
            .modalAmount {
            font-weight: 800;
            font-size: 18px;
            line-height: 28px;
            text-align: right;
            letter-spacing: 0.01em;
            color: #000000;
            }
            
            #currentPlan, #AllPlan, #frequentPlan, #businessPlan, #personalPlan, #payrollPlan, #bookkeepingPlan, #entityFormationPlan {
            overflow-y: auto;         
            height: 271px;
            position: relative;
            }
            
            .slds-scope table.planPackageTable {
            width: 99%;
            }
            
            #mainCategoryDiv {
            position: sticky;
            top: -8px;
            background-color: white;
            z-index: 20;
            width: 100%;
            margin-bottom: 8%;
            }
            
            #errorMessage, #errorMess, #errorMesse {
            background: rgba(222, 38, 68, 0.12);
            border-radius: 4px;
            margin-top: 15px;
            }
            
            #errorMessageText {
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            vertical-align: middle;
            margin-top: 12px;
            margin-bottom: 12px;
            margin-left: 25px;
            }
            
            #errorMessageIcon {
            color: red;
            vertical-align: middle;
            }
            
            .slds-scope button#errorMessageBtn {
                background-color: transparent;
                background: transparent;
                border: 1px solid rgba(18, 23, 36, 0.2);
                padding: 5px;
                font-size: 14px;
                line-height: 20px;
                border-radius: 4px;
                margin-right: 2%;
                display: inline;
                margin-top: 1%;
                margin-bottom: 1%
            }
            
            .slds-scope button#errorMessageBtn:hover {
            background-color: rgba(222, 38, 68, 0.12);
            background: rgba(222, 38, 68, 0.12);
            }
            
            .form-floating>.form-control:focus~label#searchProd, .form-floating>.form-control:not(:placeholder-shown)~label#searchProd, .form-floating>.form-select~label#searchProd{
            transform: scale(0.95) translateY(-0.4rem) translateX(0.15rem);
            top: 0;
            }

            .form-control:not(:has(+ label)){
                padding-top: 0px;
            }
            
            .form-floating>label#searchProd {
            top: -8px;
            }
            
            #switchText {
            font-weight: 500;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: #000000;
            float: left;
            margin-top: 1.6%;
            margin-right: 1%
            }
            
            .planPackageTable {
            border-collapse: collapse; 
            }
            
            .planPackageTable td {
            padding-top: 10px;
            padding-bottom: 9px;
            }
            
            .planPackageTable tr {
            border: solid rgba(18, 23, 36, 0.2);
            border-width: 1px 0;
            }
            
            .planPackageTable tr:first-child {
            border-top: none;
            }
                        
            .planPackageTable tr:last-child {
            border-bottom: none;
            }
            
            #proceedTxt {
            font-style: italic;
            font-weight: 400;
            font-size: 24px;
            line-height: 36px;
            letter-spacing: 0.0075em;
            color: rgba(18, 23, 36, 0.65);
            }
            
            #proceed {
            vertical-align: middle;
            border-bottom-style: solid;
            border-Top-style: solid;
            border-bottom-width: 1px;
            border-top-width: 1px;
            border-bottom-color: rgba(18, 23, 36, 0.2);
            border-Top-color: rgba(18, 23, 36, 0.2);
            margin-bottom: 30px;
            margin-top: 45px;
            padding-Top: 10px;
            padding-bottom: 10px;     
            }
            
            .no-js #loader, #financingScript { 
            display: none;  
            }
            
            .js #loader { 
            display: block; 
            position: absolute; 
            left: 100px;
            top: 0; 
            }
            
            .se-pre-con {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            z-index: 9999;
            /* background: url(https://smallenvelop.com/wp-content/uploads/2014/08/Preloader_11.gif) center no-repeat #fff; */
            }

            #payTermsLabel {
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }

            #payTable {
            width: 70%;
            margin-top: 4%;
            }

            .payTableTitle {
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }

            .payTableAmount {
            font-weight: 800;
            font-size: 16px;
            line-height: 24px;
            text-align: right;
            letter-spacing: 0.02em;
            color: rgba(18, 23, 36, 0.91);
            }
            
            .scheduleCalendar {
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 5px;
            padding: 3%;
            }

            #scheduleCalendarTitle {
            font-weight: 500;
            font-size: 24px;
            line-height: 36px;
            letter-spacing: 0.0075em;
            color: #000000;
            }

            #scheduleCalendarDate {
            width: 60%;
            height: 45px;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 5px;
            margin: 3% 0%;
            color: #000000;
            }

            #scheduleCalendarNote {
            font-weight: 500;
            font-size: 14px;
            line-height: 20px;
            text-align: center;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.65);
            margin-top: 5%;
            }

            .slds-scope button.hourBtn {
            box-sizing: border-box;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 9px 16px;
            width: 98.67px;
            height: 42px;
            border: 1px solid rgba(18, 23, 36, 0.2);
            border-radius: 4px;
            background-color: transparent;
            background: transparent;
            font-size: 14px;
            line-height: 20px;
            color: #000000;
            margin: 5px;
            display: inline-flex;  
            }
            
            .slds-scope button.hourBtn:hover {
            background-color: #e9fcf6;
            background: #e9fcf6;
            }

            .slds-scope button.saveChanges:hover {
            background-color: #FFA07A;
            background: #FFA07A;
            }

            #scheduleCalendarHours {
            margin-left: -5px;
            }

            .scheduleCalendarDatePayroll {
            font-weight: 600;
            font-size: 18px;
            line-height: 28px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }

            .scheduleCalendarDateSelect {
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            }

            .scheduleCalendarTable {
            margin: 3% 0%;
            }

            .cal {
            width: 56px;
            height: 56px;
            background: #AAF2DC;
            border-radius: 800px;
            color: #3B7A80;
            padding-top: 16px;
            padding-left: 16px;
            }

            .slds-scope button#confAppoi {
            font-size: 15px;
            border-radius: 36px;
            padding: 10px 16px;
            float: center;
            display: inline-block;
            font-weight: 500;
            line-height: 16px;
            letter-spacing: 0.75px;
            background: #F15F22;
            border: 1px solid #F15F22;
            background-color: #F15F22;
            color: white;
            }

            .slds-scope button#confAppoi:hover { 
            background-color: #f7a987;
            background: #f7a987;
            border: 1px solid #f7a987;
            }

            .slds-scope p.scheduleCalendarInfoNote {
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0.01em;
            color: rgba(18, 23, 36, 0.91);
            padding: 10px 0px;
            }

            #scheduleCalendarTable {
            background: rgba(23, 118, 182, 0.12);
            border-radius: 4px;
            }
            
            #cardInformation {
            margin-top: 32px;
            }

            #Changeover{
            width: 100%;
            height: 600px;
            }

            #ficaBtns, .slds-scope button#showficaexample, .slds-scope button#skipficaexample {
            display: block;
            }

            .slds-scope button#showficaexample {
                margin-bottom: 28px;
                padding: 8px;
            }

            .slds-scope button#skipficaexample {
                margin: 0;
                padding: 8px;
            }

            .slds-scope input.master {
            margin-left: 11px;
            }

            #waitingScreen {
            position: absolute;
            display: none;
            background: transparent;
            margin:0 auto;
            width:100%;
            height:100%;
            }

            #whiteWaiting {
                z-index: 200;
                width: 100%;
                height: 100%;
                background-color: white;
                background: white;
                opacity: 0.65;
            }

            .slds-scope button#optionBack {
            margin-left: 2%;
            margin-left: 3%;
            color: rgba(18, 23, 36, 0.91);
            }
            
            #backArrow {
            padding-right: 17px;
            }
            
            .backTitle {
            font-weight: 600;
            letter-spacing: 0.02em;
            }

            #addNoteBtn {
                background: #3F5261;
                color: #FFFFFF;
                font-weight: 600;
                font-size: 16px;
                line-height: 24px;
                letter-spacing: 0.02em;
                position: absolute;
                bottom: 12px;
                right: 32px;
                padding: 12px;
                border: 1px solid #3F5261;
                border-radius: 12px;
            }  

            #modalNotes {
                display: none;
                position: absolute;
                bottom: 12px;
                right: 32px;
                border-radius: 12px;
                box-shadow: 12px 12px 15px 17px rgb(0 0 0 / 20%);
                background: #ffffff;
                width: 380px;
                height: 430px;
            }

            #modalNotesHeader {
                background: #3F5261;
                color: #FFFFFF;
                font-weight: 600;
                font-size: 16px;
                line-height: 24px;
                letter-spacing: 0.02em;
                display: inline-flex;
                padding: 12px 25px;
                border-radius: 12px 12px 0px 0px;
                width: 100%;
            }

            .slds-scope button#modalNotesHeaderBtn {
                float: right;
                color: #FFFFFF;
                background: #3F5261;
                font-weight: 600;
                font-size: 16px;
                line-height: 24px;
                letter-spacing: 0.02em;
                border: none;
                display: flex;
                right: -140px;
                position: relative;
            }

            #modalNotesContent {
                background: #FFFFFF;
                padding: 15px;
            }

            #modalNoteNote {
                background: rgba(23, 118, 182, 0.12);
                border-radius: 4px;
                width: fit-content;
                padding: 3%;
                font-weight: 400;
                font-size: var(--step--1);
                line-height: 20px;
                letter-spacing: 0.01em;
                color: rgba(18, 23, 36, 0.91);
                margin-bottom: 15px;
            }

            #noteTitle {
                height: 50px;
                margin-bottom: 15px;
            }

            #noteBody {
                height: 215px;
            }

            .row {
                margin-left: 0px;
                flex: 0;
                width: 100%;
            }

            .col, .row>.col {
                flex: 0;
                display: table-cell;
                vertical-align: middle;
            }

            .row>* {
                padding: 7px 7px;
                width: auto;
            }
                        
            @media screen and (max-width: 1280px) {
            #formBody, #blastBody, #menuBody, #businessDisc, #businessDiscParts, #properEstityStrugleLLC, #flowThroughEntitySCorp, #entityClassificationElec, 
            #selfEmploymentTaxSCorp, #reasonableSalarySCorp, #selfEmploymentTaxLLC, #properEntityStrugReviewSCorp, #deductionsIntro, #startUpCosts, #medicalDeduction, 
            #vehicleDeduction, #homeOfficeDeduction, #properEntityStrugReviewLLC, #boiIntroLLC, #boiSummary, #boiIntroSCorp,
            #codeDeduction, #reviewDeduction, #paperloss, #preparedPackages, #verifyInformation, #scheduleDiscMeeting, #paymentDetails, #postPurchase, 
            #features, #taxAdvisory, #portalTour, #filingBusinessTaxes, #filingECE, #presWrapUp, #properEstityStrugleSCorp #flowThroughEntityLLC { 
            padding-right: 37px;
            padding-left: 37px;
            }
            }

            @media screen and (max-width: 2200px) {
            .slds-scope p.noteClientView {
            margin-left: 33%;
            }
            }

            @media screen and (max-width: 1600px) {
            .slds-scope p.noteClientView {
            margin-left: 32%;
            }
            }

            @media screen and (max-width: 1500px) {
            .slds-scope p.noteClientView {
            margin-left: 30%;
            }
            }
        </style>
    </head>
    <script src="https://kit.fontawesome.com/8e2856d80f.js" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/jquery.inputmask.bundle.min.js"></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.3.1/socket.io.js'></script>
    <apex:includeScript value="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
    <apex:actionFunction name="rerenderProducts" rerender="functionPanel" />
    <apex:outputPanel id="functionPanel">
        <script>
            function processProductData(){
                console.log('processProductData()');
                billingFreqFromController = '{!billingFreq}';
                //bookkeepingStartFromController = '{existingBookkeepingStart}';
                tempSelectedProducts = JSON.parse('{!selectedProductsJson}');
                selectedProductsMap = new Map();
                finalProducts = JSON.parse('{!finalProductsJson}');
                finalProductsMap = new Map();
                lastProductData = JSON.parse('{!finalProductsJson}');
                originalPriceMap = new Map();
                selectedProductsToQuote = new Array();//
                deletedProducts = new Array();
                billingAnnualMonthly = new Map();
                productsToPrice = JSON.parse('{!productToPrice}');
                pricesMap = new Map(Object.entries(productsToPrice));
                oridinalPricesMap = new Map(Object.entries(productsToPrice));
                frequentProducts = JSON.parse('{!frequentProductsJson}');
                businessProducts = JSON.parse('{!businessProductsJson}');
                personalProducts = JSON.parse('{!personalProductsJson}');
                payrollProducts = JSON.parse('{!payrollProductsJson}');
                bookkeepingProducts = JSON.parse('{!bookkeepingProductsJson}');
                entityFormationProducts = JSON.parse('{!entityFormationProductsJson}');

                for(var i=0; i < tempSelectedProducts.length; i++){
                    var prodId = tempSelectedProducts[i].Product.Id;
                    selectedProductsMap.set(prodId, tempSelectedProducts[i]);
                    if(!defaultProductIds.includes(prodId)){
                        defaultProductIds.push(prodId);
                    }
                }
                for(var i=0; i < finalProducts.length; i++){
                    finalProductsMap.set(finalProducts[i].Product.Id, finalProducts[i]);
                    originalPriceMap.set(finalProducts[i].Product.Id, finalProducts[i].adjustedPrice);
                    productNameToId.set(finalProducts[i].Product.Name, finalProducts[i].Product.Id);
                    productIdToName.set(finalProducts[i].Product.Id, finalProducts[i].Product.Name);
                    if(finalProducts[i].enabled == false){
                        enableProduct(finalProducts[i].Product.Name,false);
                    }
                }
                // for(var i=0; i < tempSelectedProducts.length; i++){
                //     autoChecks(tempSelectedProducts[i].Product.Name, {checked: true});
                // }

                if(!tempSelectedProducts.map(x => x.Product.Name).includes('Beneficial Owner Information Report')){
                    enableProduct('Beneficial Owner Information Report', true);
                }
                updateBookkeeping();
                if(getBundleStatus() == 'removed'){
                    autoCheckBundleAddons(false);
                } else {
                    autoCheckBundleAddons(true);
                }
                
                if(transactionCount != null && transactionCount != ''){
                    var minTransactionCount = Number.parseInt(transactionCount.substring(0,transactionCount.indexOf('-')));
                    var prodId = productNameToId.get('Dedicated Bookkeeping');
                    if(prodId){
                        if(minTransactionCount > 250){                    
                            calcFrecuencyChange({checked: true, id: 'monthly'}, prodId, true);
                            disableFrequency(true, prodId);
                        } else {
                            disableFrequency(false, prodId);
                        }
                    }                    
                }

                if(numberOfEmployeeContractors != null && numberOfEmployeeContractors != ''){
                    var employeeNum = Number.parseInt(numberOfEmployeeContractors);
                    var prodId = productNameToId.get('Payroll');
                    if(prodId){
                        if(employeeNum > 3){                    
                            calcFrecuencyChange({checked: true, id: 'monthly'}, prodId, true);
                            disableFrequency(true, prodId);
                        } else {
                            disableFrequency(false, prodId);
                        }
                    }
                }

                autoAmountBundleItems();
                lastProductData = JSON.parse(JSON.stringify(finalProducts));
                updateQuoteTotals();
                // for(var i=0; i < tempSelectedProducts.length; i++){
                //     syncProdToClient(tempSelectedProducts[i]);
                // }
                syncProdsToClient();
                console.log('sanity');
                enableEditButton(true);
            }
        </script>
    </apex:outputPanel>
    <apex:messages />
    <apex:outputPanel >
    <script type='text/javascript'> 

    
    
        $(window).load(function() {
            $(".se-pre-con").fadeOut("slow");
        });
        
        $(document).ready(function () {
            Inputmask("+9[9] (9{3}) 9{3}-9{4}", {
                placeholder: " ",
                greedy: true
            }).mask('#phone');
            Inputmask("+9[9] (9{3}) 9{3}-9{4}", {
                placeholder: " ",
                greedy: true
            }).mask('#contphone');
            Inputmask("+9[9] (9{3}) 9{3}-9{4}", {
                placeholder: " ",
                greedy: true
            }).mask('#phoneEditClient');
            Inputmask("+9[9] (9{3}) 9{3}-9{4}", {
                placeholder: " ",
                greedy: true
            }).mask('#phoneModalEditClientInfo');
            
        });
        
        window.addEventListener('resize', function(event) {
            var newHeight = window.innerHeight; 
            var height = document.getElementById('menuBody').offsetHeight;

            var quarterHeight = newHeight / 5;
            var clientHeight = quarterHeight * 3;
            var detailsHeight = quarterHeight * 2;

            document.getElementById("blastBody").style.height = (newHeight - height) + 'px';
            document.getElementById("businessDisc").style.height = (newHeight - height) + 'px';
            document.getElementById("formBody").style.height = (newHeight - height) + 'px';
            document.getElementById("formClientDet").style.height = (detailsHeight) + 'px';
            document.getElementById("formClientView").style.height = (clientHeight) + 'px';
            document.getElementById('businessDiscParts').style.height = (newHeight - height) + 'px';
            document.getElementById('properEstityStrugleLLC').style.height = (newHeight - height) + 'px'; 
            document.getElementById('properEstityStrugleSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('placeholder').style.height = (newHeight - height) + 'px';
            document.getElementById('flowThroughEntityLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('flowThroughEntitySCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('entityClassificationElec').style.height = (newHeight - height) + 'px';
            document.getElementById('selfEmploymentTaxLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('selfEmploymentTaxSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('reasonableSalarySCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('boiIntroLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('boiIntroSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('properEntityStrugReviewLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('properEntityStrugReviewSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('deductionsIntro').style.height = (newHeight - height) + 'px';
            document.getElementById('startUpCosts').style.height = (newHeight - height) + 'px';
            document.getElementById('medicalDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('vehicleDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('homeOfficeDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('codeDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('reviewDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('paperloss').style.height = (newHeight - height) + 'px';
            document.getElementById('preparedPackages').style.height = (newHeight - height) + 'px';
            document.getElementById('verifyInformation').style.height = (newHeight - height) + 'px';
            document.getElementById('paymentDetails').style.height = (newHeight - height) + 'px';
            document.getElementById('postPurchase').style.height = (newHeight - height) + 'px';
            document.getElementById('features').style.height = (newHeight - height) + 'px';
            document.getElementById('taxAdvisory').style.height = (newHeight - height) + 'px';
            document.getElementById('portalTour').style.height = (newHeight - height) + 'px';
            document.getElementById('filingBusinessTaxes').style.height = (newHeight - height) + 'px';
            document.getElementById('filingECE').style.height = (newHeight - height) + 'px';
            document.getElementById('boiSummary').style.height = (newHeight - height) + 'px';
            document.getElementById('presWrapUp').style.height = (newHeight - height) + 'px';
        });

        var pageObjects = [ //no scorp slides in figma?
            {id: 'formBody', name: "Introduction"},
            {id: 'blastBody', name:"1-800Accountant Blast"},
            {id: 'businessDisc', name:"Business Discovery Intro"},
            {id: 'businessDiscParts', name: "Discovery Questions"},
            {id: 'properEstityStrugleLLC', name: "Proper Entity Structuring", entity: 'LLC'},
            {id: 'properEstityStrugleSCorp', name: "Proper Entity Structuring", entity: 'S Corporation'},
            //{id: 'placeholder', name: "Placeholder"},
            {id: 'flowThroughEntityLLC', name: "Flow Through Entity", entity: 'LLC'},
            {id: 'flowThroughEntitySCorp', name: "Flow Through Entity", entity: 'S Corporation'},
            //{id: 'pesForLLC', name: "Proper Entity Structuring", subpages:[{id: "properEstityStrugleLLC"}, {id: "flowThroughEntityLLC"}, {id: "entityClassificationElec"}]},
            //{id: 'pesForSCorp', name: "Proper Entity Structuring"},
            {id: 'entityClassificationElec', name: "Entity Classification Election (ECE)"},
            {id: 'selfEmploymentTaxSCorp', name: "Self-Employment Tax (FICA)", entity: 'S Corporation'},
            {id: 'selfEmploymentTaxLLC', name: "Self-Employment Tax (FICA)", entity: 'LLC'},
            {id: 'reasonableSalarySCorp', name: "Reasonable Salary", entity: 'S Corporation'},
            {id: 'boiIntroLLC', name: "Beneficial Ownership Information (BOI)", entity: 'LLC'},
            {id: 'boiIntroSCorp', name: "Beneficial Ownership Information (BOI)", entity: 'S Corporation'},
            {id: 'properEntityStrugReviewLLC', name: "Review Proper Entity Structuring", entity: 'LLC'},
            {id: 'properEntityStrugReviewSCorp', name: "Review Proper Entity Structuring", entity: 'S Corporation'},
            {id: 'deductionsIntro', name: "Deductions Introduction"},
            {id: 'startUpCosts', name: "Start-up Costs"},
            {id: 'medicalDeduction', name: "Medical Deduction"},
            {id: 'vehicleDeduction', name: "Vehicle Deduction"},
            {id: 'homeOfficeDeduction', name: "Home Office Deduction"},
            {id: 'codeDeduction', name: "Code Section 199A Deduction"},
            {id: 'reviewDeduction', name: "Review Deductions"},
            {id: 'paperloss', name: "Paper Loss"},
            {id: 'features', name: "1-800Accountant Introduction"},
            //{id: 'expertAccountant', name: "Your Expert Accountant Team"}, //replace with advisory page
            {id: 'taxAdvisory', name: "Tax Advisory"},
            {id: 'portalTour', name: "Features - 1-800Accountant Portal"},
            {id: 'filingBusinessTaxes', name: "Features - Business & Personal..."},
            {id: 'filingECE', name: "Features - Filing ECE"},
            {id: 'boiSummary', name: "Features - BOI Summary"},
            {id: 'presWrapUp', name: "Features - Wrap Up"},
            //{id: 'preparedPackages', name: "Prepared Packages"}, //need to remove the rep page
            {id: 'verifyInformation', name: "Verify Information"},
            {id: 'paymentDetails', name: "Payment Details"},
            {id: 'postPurchase', name: "Post Purchase"},
            //{id: 'waitingScreen', name: }
        ];
        
        //var bundleStatus = 'standard';
        var cInd;
        var answerMap;
        var answers = '';
        var isFirstTime = false;
        var isFirstTime2 = true;
        var isFirstTime3 = true;
        var isFirstTime4 = true;
        var isFirstTime5 = true;
        var flagOne = false;
        var flagTwo = false;
        var flagThree = false;
        var flagFour = false;
        var flagFive = false;
        var flagDoSubmit = false
        var pulledPartners = false;
        var partnersGone = true;
        var isfinalScreen = false;
        var firstPackage = false;
        const currentPlan = new Array();
        const AllPlan = new Array();
        const frequentPlan = new Array();
        const businessPlan = new Array();
        const personalPlan = new Array();
        const payrollPlan = new Array();
        const bookkeepingPlan = new Array();
        const entityFormationPlan = new Array();
        var chosenProducts = new Array();
        var uniquechosenProducts = new Array();
        const productIdToBilling = new Map();
        const defaultAnswers = new Map();
        var tempSelectedProducts = JSON.parse('{!selectedProductsJson}');
        var discoveryQuestions = JSON.parse('{!discoveryQuestionsJson}');
        var questionNameToQuestionMap = new Map();
        var selectedProductsMap = new Map();
        var finalProducts = JSON.parse('{!finalProductsJson}');
        var finalProductsMap = new Map();
        var lastProductData = JSON.parse('{!finalProductsJson}');
        var originalPriceMap = new Map();
        var selectedProductsToQuote = new Array();
        var deletedProducts = new Array();
        var billingAnnualMonthly = new Map();
        var productsToPrice = JSON.parse('{!productToPrice}');
        var questionLabelToQuestionMap = new Map();
        var pricesMap = new Map(Object.entries(productsToPrice));
        var oridinalPricesMap = new Map(Object.entries(productsToPrice));
        var productNameToId = new Map();
        var productIdToName = new Map();
        var frequentProducts = new Array();
        var businessProducts = new Array();
        var defaultProductIds = new Array();
        var personalProducts = new Array();
        var payrollProducts = new Array();
        var bookkeepingProducts = new Array();
        var entityFormationProducts = new Array();
        var payTermsLabelToValue = new Map([
            ['No Financing', 'yrl'],
            ['2 Pay', '2pay'],
            ['3 Pay', '3pay'],
            ['4 Pay', '4pay'],
            ['6 Pay', '6pay'],
            ['Apply for Monthly Installments', 'mon']
        ]);
        var payTermsValueToLabel = new Map([
            ['yrl', 'No Financing'],
            ['2pay', '2 Pay'],
            ['3pay', '3 Pay'],
            ['4pay', '4 Pay'],
            ['6pay', '6 Pay'],
            ['mon', 'Apply for Monthly Installments']
        ]);
        var payTermsNumToLabel = new Map([
            [1, 'No Financing'],
            [2, '2 Pay'],
            [3, '3 Pay'],
            [4, '4 Pay'],
            [6, '6 Pay'],
            [12, 'Apply for Monthly Installments']
        ]);

        var advisoryAddons = JSON.parse('{!advisoryAddonsJSON}');
        var quoteId = '{!quoteId}';
        var isEditQuote = (quoteId && quoteId != '' && quoteId != 'null');
        var currentProgress = getProgress();

        var hasPayroll = '';
        var stateBilli = '';
        var payTerms = 'yrl';
        var entity = '';
        var primaryDisp = 'Consulted';
        var secondaryDisp = 'Not Interested';
        var notEntityType = '';
        var eventId = "{!$CurrentPage.parameters.rId}";
        var whenDisposition = 'early';
        var schedulerURL = '';
        var useStaticPackage = true; //"{!useStaticPackage}" == 'true' ? true : false;
        var entitySelected = "{!defaultEntity}" == 'Select an Entity Type' ? '' : "{!defaultEntity}";
        var bookkeepingStartDate = null;
        var bookkeepingEndDate = null;
        var transactionCount = ("{!defaultNumTransactions}" == "---" ? null : "{!defaultNumTransactions}");
        var numberOfEmployeeContractors = ("{!defaultNumEmployees}" == "---" ? null : "{!defaultNumEmployees}");
        var nonProfit = ("{!isNonProfit}" == "true");
        var billingFreqFromController;
        var bookkeepingStartFromController;
        // var quoteTotal = 0;
        // var quoteTotalAnnual = 0;
        // var quoteTotalMonthly = 0;
        defaultAnswers.set('Is this your first business?', '');
        defaultAnswers.set('How many years have you been in business?', '---');
        defaultAnswers.set('What entity type is your business?', 'defaultEntity');
        defaultAnswers.set('What industry is your business in?', 'defaultIndustry');
        defaultAnswers.set('What is your state of incorporation?', 'defaultDomesticState');
        defaultAnswers.set('What is your foreign state of incorporation?', 'defaultForeignState ');
        //defaultAnswers.set('What is your state of residence?', 'defaultPersonalState');
        defaultAnswers.set('How much have you invested so far in start-up costs?', 'defaultStartupCosts');
        defaultAnswers.set('What do you anticipate your revenue to be over the next 12 months?', 'defaultRevenue');
        defaultAnswers.set('What do you project your 1st year profit to be over the next 12 months?', 'defaultFirstYearProfit');
        //defaultAnswers.set('What is your total investor funding?', 'defaultInvestorFunding');
        defaultAnswers.set('How many monthly bookkeeping transactions do you have?', 'defaultNumTransactions'); 

        var splittableProductsTotal = 0;
        var nonsplittableProductsTotal = 0;
        var monthlyProductsTotal = 0;
        var nonmonthlyProductsTotal = 0;
        var meteredProductTotal = 0;
        var numberOfPayments = 1;
        var currentPageIndex = 0;

        

        var taxHotlineIntro = 'Congratulations on your Tax Hotline purchase through {!opportunity.Account.Lead_Source__c}! This entitles you to a discounted rate on our Tax Advisory services.';
        var btpIntro = 'It looks like you purchased our accounting services through {!opportunity.Account.Lead_Source__c}, and as part of our partnership, 1800Accountant will handle the preparation and filing of your business income tax return. Congratulations  you\'re now a valued client, and you\'ve made an excellent decision by choosing 1800Accountant!';
        var btpHotlineIntro = 'I see youve purchased Tax Hotline and Business Tax Prep through {!opportunity.Account.Lead_Source__c}. Congratulations! You\'ve secured a discount on our Tax Advisory services and 1800Accountant will handle the preparation and filing of your business income tax return. You\'re now a valued client, and you\'ve made great choices in enhancing your tax and accounting services with us!';
        var btpPTPIntro = 'It looks like you purchased our accounting services through {!opportunity.Account.Lead_Source__c}, and as part of our partnership, 1800Accountant will handle the preparation and filing of your personal and business income tax returns. Congratulations  you\'re now a valued client, and you\'ve made an excellent decision by choosing 1800Accountant!';
        var btpPTPHotlineIntro = 'I see youve purchased Tax Hotline, Business Tax Prep, and Personal Tax Prep through {!opportunity.Account.Lead_Source__c}. Congratulations! You\'ve secured a discount on our Tax Advisory services and 1800Accountant will handle the preparation and filing of your business income tax return. You\'re now a valued client, and you\'ve made great choices in enhancing your tax and accounting services with us!';

        var questionFilters = JSON.parse('{!questionFiltersJson}');
        //var parentNameToChildQuestions = JSON.parse('{parentNameMapJson}');

        function getInstallmentAmount(){
            var amount = splittableProductsTotal / numberOfPayments;
            if(payTerms == 'mon'){ amount *= 1.2; } //extra fee for monthly financing
            return parseFloat(amount.toFixed(2));
        }
        function getTotalAmountDue(){
            var totalAmount = 0;
            if(payTerms == 'mon'){
                totalAmount = (monthlyProductsTotal * 12) + nonmonthlyProductsTotal;
            } else {
                totalAmount = splittableProductsTotal + nonsplittableProductsTotal;
            }
            return totalAmount;
        }
        function getDueToday(){
            return getInstallmentAmount() + nonsplittableProductsTotal;
        }
        function getSelectedProductIds(){
            return tempSelectedProducts?.map(x => x.Id);
        }
        function getSelectedProductNames(){
            return tempSelectedProducts?.map(x => x.Name);
        }

        function getBundleStatus(){
            var returnStatus = 'standard';
            if(tempSelectedProducts.length > 3){
                returnStatus = 'added';
            } 
            // else if(tempSelectedProducts.length < defaultProductIds.length){
            //     returnStatus = 'removed';
            // }
            if(!isAdvisoryClient() || !isBTPClient() || !isPTPClient()){
                returnStatus = 'removed';
            }
            return returnStatus;
        }

        var dueTodayIds = [];
        var totalDueIds = [];
        var annualAndOneTimeIds = [];
        var monthlyIds = [];
        var separatedTotalIds = [];
        var editPages = ['Discovery Questions','Prepared Packages',
        'Verify Information', 'Payment Details', 'Post Purchase'];

        var leadSource;
        var leadType;

        function loadingPage() {
            eligibleBundle = '{!eligibleBundle}';
            payTerms = ('{!billingFreq}' == '' ? 'yrl' : '{!billingFreq}');
            console.log('eligible bundle: '+eligibleBundle);
            leadSource = '{!opportunity.Account.Lead_Source__c}';
            console.log('lead source: '+leadSource);

            if(leadSource == 'Tailor Brands'){
                document.querySelector('.advisoryScriptNoBOI').style.display = 'block';
            } else {
                document.querySelector('.advisoryScriptDefault').style.display = 'block';
            }
        
            var newHeight = window.innerHeight; 
            var height = document.getElementById('menuBody').offsetHeight;

            var quarterHeight = newHeight / 5;
            var clientHeight = quarterHeight * 3;
            var detailsHeight = quarterHeight * 2; 

            var menuOpts = document.getElementById('menuOpts');
            var ind = 0;
            var pageNames = getPageNames();
            for(var page of pageNames){
                menuOpts[ind++] = new Option(page, page);
            }


            for(var question of discoveryQuestions){
                question.isPicklist = (question.QuestionType == 'Single Selection' || question.QuestionType == 'Multi Selection' || question.QuestionType == 'State');
                questionNameToQuestionMap.set(question.DevName, question);
                questionLabelToQuestionMap.set(question.Label, question);
            }
            document.getElementById("blastBody").style.height = (newHeight - height) + 'px';
            document.getElementById("businessDisc").style.height = (newHeight - height) + 'px';
            document.getElementById("formBody").style.height = (newHeight - height) + 'px';
            document.getElementById("formClientDet").style.height = (detailsHeight) + 'px';
            document.getElementById("formClientView").style.height = (clientHeight) + 'px';
            document.getElementById('businessDiscParts').style.height = (newHeight - height) + 'px';
            document.getElementById('properEstityStrugleLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('properEstityStrugleSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('placeholder').style.height = (newHeight - height) + 'px';
            document.getElementById('flowThroughEntityLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('flowThroughEntitySCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('entityClassificationElec').style.height = (newHeight - height) + 'px';
            document.getElementById('selfEmploymentTaxLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('selfEmploymentTaxSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('reasonableSalarySCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('boiIntroLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('boiIntroSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('properEntityStrugReviewLLC').style.height = (newHeight - height) + 'px';
            document.getElementById('properEntityStrugReviewSCorp').style.height = (newHeight - height) + 'px';
            document.getElementById('deductionsIntro').style.height = (newHeight - height) + 'px';
            document.getElementById('startUpCosts').style.height = (newHeight - height) + 'px';
            document.getElementById('medicalDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('vehicleDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('homeOfficeDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('codeDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('reviewDeduction').style.height = (newHeight - height) + 'px';
            document.getElementById('paperloss').style.height = (newHeight - height) + 'px';
            document.getElementById('preparedPackages').style.height = (newHeight - height) + 'px';
            document.getElementById('verifyInformation').style.height = (newHeight - height) + 'px';
            document.getElementById('paymentDetails').style.height = (newHeight - height) + 'px';
            document.getElementById('postPurchase').style.height = (newHeight - height) + 'px';
            document.getElementById('features').style.height = (newHeight - height) + 'px';
            document.getElementById('taxAdvisory').style.height = (newHeight - height) + 'px';
            document.getElementById('portalTour').style.height = (newHeight - height) + 'px';
            document.getElementById('filingBusinessTaxes').style.height = (newHeight - height) + 'px';
            document.getElementById('filingECE').style.height = (newHeight - height) + 'px';
            document.getElementById('boiSummary').style.height = (newHeight - height) + 'px';
            document.getElementById('presWrapUp').style.height = (newHeight - height) + 'px';

            //document.getElementById('joinCall').style.display = "none";
            document.getElementById('partnersTable').style.display = "none";
            document.getElementById('start').setAttribute("disabled", "disabled");
            document.getElementById('stopPres').setAttribute("disabled", "disabled");
            document.getElementById('btnAddRow').setAttribute("disabled", "disabled");
            document.getElementById('blastBody').style.display = "none";
            document.getElementById('businessDisc').style.display = "none";
            document.getElementById("menuOpts").value = "Introduction"; //sets dropdown value to match starting page
            document.getElementById('businessDiscParts').style.display = "none";
            document.getElementById('properEstityStrugleLLC').style.display = "none";
            document.getElementById('properEstityStrugleSCorp').style.display = "none";
            document.getElementById('placeholder').style.display = "none";
            //document.getElementById('pesForLLC').style.display = "none";
            //document.getElementById('pesForSCorp').style.display = "none";
            document.getElementById('flowThroughEntityLLC').style.display = "none";
            document.getElementById('flowThroughEntitySCorp').style.display = "none";
            document.getElementById('entityClassificationElec').style.display = "none";
            document.getElementById('selfEmploymentTaxSCorp').style.display = "none";
            document.getElementById('reasonableSalarySCorp').style.display = "none";
            document.getElementById('selfEmploymentTaxLLC').style.display = "none";
            document.getElementById('boiIntroLLC').style.display = "none";
            document.getElementById('boiIntroSCorp').style.display = "none";
            document.getElementById('properEntityStrugReviewLLC').style.display = "none";
            document.getElementById('properEntityStrugReviewSCorp').style.display = "none";
            document.getElementById('deductionsIntro').style.display = "none";
            document.getElementById('startUpCosts').style.display = "none";
            document.getElementById('medicalDeduction').style.display = "none";
            document.getElementById('vehicleDeduction').style.display = "none";
            document.getElementById('homeOfficeDeduction').style.display = "none";
            document.getElementById('codeDeduction').style.display = "none";
            document.getElementById('reviewDeduction').style.display = "none";
            document.getElementById('paperloss').style.display = "none";
            document.getElementById('preparedPackages').style.display = "none";
            document.getElementById('verifyInformation').style.display = "none";
            document.getElementById('paymentDetails').style.display = "none";
            document.getElementById('postPurchase').style.display = "none";
            document.getElementById('features').style.display = "none";
            document.getElementById('taxAdvisory').style.display = "none";
            document.getElementById('portalTour').style.display = "none";
            document.getElementById('filingBusinessTaxes').style.display = "none";
            document.getElementById('filingECE').style.display = "none";
            document.getElementById('boiSummary').style.display = "none";
            document.getElementById('presWrapUp').style.display = "none";
            document.getElementById('waitingScreen').style.display = "none";
            
            var menuList = document.getElementById("menuOpts").options;
            for (let i = 1; i < menuList.length; i++) {
                menuList[i].setAttribute("disabled", "disabled"); //disable all dropdown options at the beginning?
            }

            setRequiredUnasweredFields();
            setDefaultDiscoveryAnswers(true);

            
            filterQuestions('Required Questions');
            document.getElementById("mainCategory").value = "Required Questions";
            if(isEditQuote){
                document.getElementById("menuOpts").value = "Discovery Questions";
                pageObjects = pageObjects.filter(x => editPages.includes(x.name));
                document.getElementById('formBody').style.display = 'none';
                goToPage();
                whatToDo();
                //setDefaultDiscoveryAnswers();
                getNextBtn('First Business');
                if(checkRequiredQuestions()){
                    document.getElementById('thirdStart').removeAttribute('disabled');
                    document.getElementById('thirdStart').style.opacity = "1";
                    document.getElementById('errorMessage').style.display = "none";
                } else {
                    document.getElementById('thirdStart').setAttribute("disabled", "disabled");
                    document.getElementById('thirdStart').style.opacity = "0.25";
                    document.getElementById('errorMessage').style.display = "flex"; 
                }
                // var indicesToRemove = [];
                // for(var i = 0; i < document.getElementById("menuOpts").options.length; i++){
                //     option = document.getElementById("menuOpts").options.item(i);
                //     option.removeAttribute('disabled');
                //     if(!editPages.includes(option.value)){
                //         indicesToRemove.push(i);
                //     }
                // }
                // for(var index of indicesToRemove.reverse()){
                //     document.getElementById("menuOpts").options.item(index).remove();
                // }
                var menuOpts = document.getElementById('menuOpts');
                var ind = 0;
                var pageNames = getPageNames();
                var originalLength = menuOpts.options.length;
                for (let i = 0; i < originalLength; i++) {
                    menuOpts.options.remove(0); //clear the list
                }
                for(var page of pageNames){ //populate with the appropriate pages
                    menuOpts[ind++] = new Option(page, page);
                }
                document.getElementById("formClientView").style = 'display: none';
                document.querySelector('.discoveryBackButton').setAttribute("disabled", "disabled");
                document.querySelector('.discoveryBackButton').style = 'display: none';
                document.querySelector('.backToPrep').style = 'display: none';
                document.querySelector('.backToReview').style = 'display: block';
                //nextSection(3, 'Discovery Questions', 'businessDisc', 'businessDiscParts');
                if(payTerms){
                    var financing;
                    if(payTerms == 'yrl') { financing = 'No Financing'; }
                    if(payTerms == '2pay') { financing = '2 Pay'; }
                    if(payTerms == '3pay') { financing = '3 Pay'; }
                    if(payTerms == '4pay') { financing = '4 Pay'; }
                    if(payTerms == '6pay') { financing = '6 Pay'; }
                    if(payTerms == 'mon') { financing = 'Apply for Monthly Installments'; }
                    if(financing) { calcFinance(financing, false); }
                }
            }

            var introText = '';
            if(isHotlineClient() && isBTPClient() && isPTPClient()){
                introText = btpPTPHotlineIntro;
            } else if (isHotlineClient() && isBTPClient()){
                introText = btpHotlineIntro;
            } else if (isPTPClient() && isBTPClient()){
                introText = btpPTPIntro;
            } else if (isHotlineClient()) {
                introText = taxHotlineIntro;
            } else if (isBTPClient()){
                introText = btpIntro;
            }
            document.getElementsByClassName('dynamicIntroText')[0].innerHTML = introText;

            setTimeout(() => {
                console.log('disabling date input');
                for(var i of document.querySelectorAll('[type=date]')){i.addEventListener("keydown", function (e) {
                    e.preventDefault(); //disable typing into date inputs
                })}
            }, 200);
            

        }

        
        

        //const socket = io('https://staging.1800accountant.com', { path: '/socket.io', autoConnect: false });
        const socket = io('{!socketBaseUrl}', { path: '/socket.io', autoConnect: false });
        console.log('sessionId: {!$CurrentPage.parameters.sessionId}');
        console.log('token: {!$CurrentPage.parameters.token}');
        socket.connect();
        socket.auth = {sessionID: '{!$CurrentPage.parameters.sessionId}', authToken: '{!$CurrentPage.parameters.token}', source: 'controller'}; 
        socket.on("connect", () => {
            console.log('socket.id: ' + socket.id);
        });
            
        socket.on("private message", (message) => {
            console.log("message", message);
        });
            
        socket.onerror = function(event) {
            console.error("WebSocket error observed:", event);
        }
            
        socket.on('disconnect', function (reason) {
            console.log('disconnecting:');
            console.log(reason);
        });

        var businessId = '{!businessId}';
        var accId = '{!opportunity.AccountId}';

        function getIntroQuestionsAnswered(){
            var partners = document.getElementById('yesBtn1').style.color == 'white' || document.getElementById('noBtn1').style.color == 'white';
            var spouse = document.getElementById('yesBtn1.4').style.color == 'white' || document.getElementById('noBtn1.4').style.color == 'white';
            var businessName = document.getElementById('businessName').value != '';
            var entity = entitySelected != '';
            return partners && spouse && businessName && entity;
        }

        function savePartnerNumber(){
            // if(document.getElementById('yesBtn1').style.color == "white" && document.getElementById('numberOfPartners') != ''){
            //     document.getElementById('start').removeAttribute('disabled'); 
            //     document.getElementById('start').style.opacity = "1";
            // } else {
            //     document.getElementById('start').setAttribute("disabled", "disabled");
            //     document.getElementById('start').style.opacity = "0.25";
            // }
        }

        function getJoinCall() {
            //document.getElementById('joinCall').style.display = "block";
            document.getElementById('numberOfPartners').style.display = "block";
            document.getElementsByClassName('getOnPhone')[0].style.display = "block";
            document.getElementById('partnersTable').style.display = "block";
            YesDecision(1);

            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
            
        }
            
        function NoBusiPart() {
            //document.getElementById('joinCall').style.display = "none";
            document.getElementById('partnersTable').style.display = "none";
            document.getElementById('numberOfPartners').style.display = "none";

            NoDecision(1);
            
            document.getElementById("menuOpts").options[1]?.removeAttribute('disabled'); 
            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
            
        }

        function yesSpouse(){
            document.getElementsByClassName('getOnPhone')[0].style.display = "block";
            YesDecision(1.4);
            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
        }

        function noSpouse(){
            NoDecision(1.4);
            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
        }
            
        function addPartners() {
            console.log('addPartners');
            document.getElementById('partnersTable').style.display = "block";
            
            YesDecision(2);
            
            document.getElementById('start').setAttribute("disabled", "disabled");
            document.getElementById('start').style.opacity = "0.25";
            
            //If there are Partners already in Salesforce, add them to the sales & client page
            if(!pulledPartners){
                <apex:repeat var="partner" value="{!partners}">
                    document.getElementById("addPartTable1").style.display = "none";  
                    var name = '{!partner.First_Name__c}' + ' ' + '{!partner.Last_Name__c}';            
                    var ind1 = document.getElementById('contTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
                    var rowData1 = getRowData(ind1, "prin", name, '{!partner.Partner_Role__c}', '{!partner.Email__c}', '{!partner.Phone__c}', '{!partner.Id}');
                
                    var ind2 = document.getElementById('addPartTable2').getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
                    var rowData2 = getRowData(ind2, "sec", name, '{!partner.Partner_Role__c}', '{!partner.Email__c}', '{!partner.Phone__c}', '{!partner.Id}');
                
                    if(tBody.innerHTML != null) {
                        tableBody.innerHTML = tableBody.innerHTML + rowData1;
                        tBody.innerHTML = tBody.innerHTML + rowData2;
                    } else {
                        tableBody.innerHTML = rowData1;
                        tBody.innerHTML = rowData2;
                    }
                    
                    socket.connect();
                    content = {
                        page: "Partner Info",
                        name: name,
                        role: '{!partner.Partner_Role__c}',
                        email: '{!partner.Email__c}',
                        phone: '{!partner.Phone__c}'
                    }
                    socket.emit("private message", {
                        content
                    });
                    pulledPartners = true;
                    partnersGone = false;
                    
                    document.getElementById('start').removeAttribute('disabled');
                    document.getElementById('start').style.opacity = "1";
            
                </apex:repeat>
            
            } 
                        
            if(!partnersGone) {
                //document.getElementById("menuOpts").options[1].removeAttribute('disabled');
                document.getElementById('start').removeAttribute('disabled');
                document.getElementById('start').style.opacity = "1";
            }
        }
            
        function YesDecision(num) {
            document.getElementById('yesBtn' + num).style.border = "1px solid #3B7A80";
            document.getElementById('yesBtn' + num).style.color = "white";
            document.getElementById('yesBtn'+num).style.background = "#3B7A80";
            
            document.getElementById('noBtn' + num).style.border = "1px solid #c0c0c0";
            document.getElementById('noBtn' + num).style.color = "black";
            document.getElementById('noBtn' + num).style.background = "white";
        }
            
        function NoDecisionTwo() {
            document.getElementById('partnersTable').style.display = "none";
            
            NoDecision(2);
            
            //document.getElementById("menuOpts").options[1].removeAttribute('disabled'); 
            document.getElementById('start').removeAttribute('disabled');
            document.getElementById('start').style.opacity = "1";
        }
            
        function NoDecision(num) {
            document.getElementById('yesBtn' + num).style.border = "1px solid #c0c0c0";
            document.getElementById('yesBtn' + num).style.color = "black";
            document.getElementById('yesBtn' + num).style.background = "white";
            
            document.getElementById('noBtn' + num).style.border = "1px solid #3B7A80";
            document.getElementById('noBtn' + num).style.color = "white";
            document.getElementById('noBtn' + num).style.background = "#3B7A80";
        }

        function updateYesNoButtons(buttonId){
            var buttonStyle = document.querySelector('[html-data-id='+buttonId+']').style;
            buttonStyle.border = "1px solid #3B7A80";
            buttonStyle.color = "white";
            buttonStyle.background = "#3B7A80";

            var oppositeButtonId = buttonId.includes('yesBtn') ? buttonId.replace('yesBtn', 'noBtn') : buttonId.replace('noBtn', 'yesBtn');
            var oppositeButtonStyle = document.querySelector('[html-data-id='+oppositeButtonId+']').style;
            oppositeButtonStyle.border = "1px solid #c0c0c0";
            oppositeButtonStyle.color = "black";
            oppositeButtonStyle.background = "white";
        }
        
        function hideAll() {
            var idsToHide = ['formBody',
            'blastBody',
            'businessDisc',
            'businessDiscParts',
            'properEstityStrugleLLC',
            'properEstityStrugleSCorp',
            'placeholder',
            //'pesForLLC',
            //'pesForSCorp',
            'flowThroughEntityLLC',
            'flowThroughEntitySCorp',
            'entityClassificationElec',
            'selfEmploymentTaxSCorp',
            'reasonableSalarySCorp',
            'selfEmploymentTaxLLC',
            'boiIntroLLC',
            'boiIntroSCorp',
            'properEntityStrugReviewLLC',
            'properEntityStrugReviewSCorp',
            'deductionsIntro',
            'startUpCosts',
            'medicalDeduction',
            'vehicleDeduction',
            'homeOfficeDeduction',
            'codeDeduction',
            'reviewDeduction',
            'paperloss',
            'preparedPackages',
            'verifyInformation',
            'paymentDetails',
            'postPurchase',
            'features',
            'taxAdvisory',
            'portalTour',
            'filingBusinessTaxes',
            'filingECE',
            'boiSummary',
            'presWrapUp',
            'waitingScreen'];
            for(var elId of idsToHide){
                document.getElementById(elId).style.display = "none";
            }
            
        }

        
                        
        function goToPage() {
            var selected = document.getElementById("menuOpts").value;
            console.log('goToPage '+selected);
            //socket.connect();
            if(selected == "Review Business Discovery"){
                selected = 'Discovery Questions';
            }
            previousPage(selected);
            return;
            
            if(selected == "Introduction") {
                hideAll();
                document.getElementById('formBody').style.display = "block";
                        
                //If they have partners, show the partner page, else show the introduction slide again
                var page = ('white' == document.getElementById('yesBtn1').style.color) ? 'Back To Partners' : 'Back To Intro';
                content = {
                    page: page,
                }
                socket.emit("private message", {
                    content
                });
            } else if(selected == "1-800Accountant Blast") {
                hideAll();
                document.getElementById('blastBody').style.display = "block";
                document.getElementById("menuOpts").options[2]?.removeAttribute('disabled'); 
                content = {
                    page: "Blast"
                }
                socket.emit("private message", {
                    content
                });
            } else if(selected == "Business Discovery Intro") {
                hideAll();
                document.getElementById('businessDisc').style.display = "block";
                document.getElementById("menuOpts").options[3]?.removeAttribute('disabled'); 
                content = {
                    page: "Business Discovery Intro", 
                }
                socket.emit("private message", {
                    content
                });
            } else if(selected == "Discovery Questions") {
                hideAll();
                document.getElementById('businessDiscParts').style.display = "block";
                document.getElementById("menuOpts").value = "Discovery Questions"; //?
                document.getElementById("discoveryQuestionTitle").innerHTML = "Business Discovery";
                //document.getElementById('engagee').style.display = "none";

                document.getElementById('mainCategoryDiv').style.background = "white";
                document.getElementById('mainCategoryDiv').style.border = "none";
                document.getElementById('mainCategoryDiv').style.borderRadius = "0px";
                document.querySelector('[data-id="mainCategory"]').style.marginTop = "0px";
                document.querySelector('[data-id="mainCategory"]').style.width = "100%";
                document.querySelector('[data-id="mainCategory"]').style.marginLeft = "0px";
                document.getElementById('showAllAnswer').style.display = "none";

            } else if(selected == "Review Business Discovery") {
                hideAll();
                document.getElementById('businessDiscParts').style.display = "block";
                reviewBusiDisc(true);
            } else if(selected == "Proper Entity Structuring") {
                hideAll();
                reviewBusiDisc(false);
            } else if(selected == "Flow Through Entity") { //changes slide but blank rep page
                hideAll();
                if(entitySelected == 'LLC') {
                    document.getElementById('flowThroughEntityLLC').style.display = "block";
                    document.getElementById('pesForLLC').style.display = "block";
                    nextSection(6, 'Flow Through Entity', 'properEstityStrugleLLC', 'flowThroughEntityLLC');
                } else if(entitySelected == 'S Corporation') {
                    document.getElementById('flowThroughEntitySCorp').style.display = "block";
                    document.getElementById('pesForSCorp').style.display = "block";
                    nextSection(6, 'Flow Through Entity', 'properEstityStrugleSCorp', 'flowThroughEntitySCorp');
                }
            } else if(selected == "Start-up Costs") {
                hideAll();
                document.getElementById('startUpCosts').style.display = "block";
                if(entitySelected == 'LLC') {
                    nextSection(7, 'Start-up Costs', 'flowThroughEntityLLC', 'startUpCosts');
                } else if(entitySelected == 'S Corporation') {
                    nextSection(7, 'Start-up Costs', 'flowThroughEntitySCorp', 'startUpCosts');
                }
            } else if(selected == "Medical Deduction") {
                hideAll();
                document.getElementById('medicalDeduction').style.display = "block";
                nextSection(8, 'Medical Deduction', 'startUpCosts', 'medicalDeduction');
                validateButtons();
            } else if(selected == "Vehicle Deduction") {
                hideAll();
                document.getElementById('vehicleDeduction').style.display = "block";
                nextSection(9, 'Vehicle Deduction', 'startUpCosts', 'vehicleDeduction');
            } else if(selected == "Home Office Deduction") {
                hideAll();
                document.getElementById('homeOfficeDeduction').style.display = "block";
                nextSection(10, 'Home Office Deduction', 'startUpCosts', 'homeOfficeDeduction');
            } else if(selected == "Code Section 199A Deduction") {
                hideAll();
                document.getElementById('codeDeduction').style.display = "block";
                nextSection(11, 'Code Section 199A Deduction', 'startUpCosts', 'codeDeduction');
            } else if(selected == "Review Deductions") {
                hideAll();
                document.getElementById('reviewDeduction').style.display = "block";
                nextSection(12, 'Review Deductions', 'codeDeduction', 'reviewDeduction');
            } else if(selected == "Paper Loss") {
                hideAll();
                document.getElementById('paperloss').style.display = "block";
                nextSection(13, 'Paperloss', 'reviewDeduction', 'paperloss');
            } else if(selected == "Prepared Packages") {
                hideAll();
                document.getElementById('preparedPackages').style.display = "block";
                nextSection(28, 'Prepared Packages', 'paperloss', 'preparedPackages');
            } else if(selected == "Verify Information") {
                hideAll();
                document.getElementById('verifyInformation').style.display = "block";
                nextSection(29, 'Verify Information', 'preparedPackages', 'verifyInformation');
            } else if(selected == "Payment Details") {
                hideAll();
                document.getElementById('paymentDetails').style.display = "block";
                nextSection(30, 'Payment Details', 'preparedPackages', 'paymentDetails');
            } else if(selected == "Post Purchase") {
                hideAll();
                document.getElementById('postPurchase').style.display = "block";
                nextSection(31, 'Post Purchase', 'paymentDetails', 'postPurchase');
            } else if(selected == "1-800Accountant Introduction") {
                hideAll();
                document.getElementById('features').style.display = "block";
                nextSection(14, '1-800Accountant Introduction', 'postPurchase', 'features');
            } else if(selected == "Your Expert Accountant Team") {
                hideAll();
                document.getElementById('taxAdvisory').style.display = "block";
                nextSection(15, 'Your Expert Accountant Team', 'features', 'taxAdvisory');
            } else if(selected == "Features - 1-800Accountant Portal") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(16, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Appointment Scheduler") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(17, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Message Center") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(18, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Tax Planner") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(19, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Bookkeeping") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(20, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Document Center") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(21, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Invoices") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(22, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Mobile App") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(23, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Summary") {
                hideAll();
                document.getElementById('portalTour').style.display = "block";
                nextSection(24, 'Features - 1-800Accountant Portal', 'taxAdvisory', 'portalTour');
            } else if(selected == "Features - Business &#38; Personal...") {
                hideAll();
                document.getElementById('filingBusinessTaxes').style.display = "block";
                nextSection(25, 'Features - Business &#38; Personal...', 'portalTour', 'filingBusinessTaxes');
            } else if(selected == "Features - Filing ECE") {
                hideAll();
                document.getElementById('filingECE').style.display = "block";
                nextSection(26, 'Features - Filing ECE', 'filingBusinessTaxes', 'filingECE');
            } else if(selected == "Features - Wrap Up") {
                hideAll();
                document.getElementById('presWrapUp').style.display = "block";
                nextSection(27, 'Features - Wrap Up', 'filingECE', 'presWrapUp');
            }
        }
        
        function goToBlast() {
            socket.connect();
            content = {
                page: "Blast",
                eligibleBundle: eligibleBundle,
                leadSource: leadSource
            }
            socket.emit("private message", {
                content
            });
        }
                
        function broadcastChannel() {
            document.getElementById("btnAddRow").innerHTML = "Add Partner";
            document.getElementById("emailFormatError").innerHTML = '';
            document.getElementById("partnerResponseErrors").innerHTML = '';
            var rows = document.getElementById('addPartTable2').getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            
            if (rows.length < 4) {
                showModal();
            } else {
                document.getElementById("btnAdd").style.display = "none";  
                showModal();
            }
        } 
                
        function disableButton() {
            var firstName = document.getElementById("firstName").value;
            var lastName = document.getElementById("lastName").value;
            var email = document.getElementById("email").value;
            var phone = document.getElementById("phone").value;
                
            if(firstName != '' && lastName != '' && email != '' && phone != '') {
                document.getElementById('btnAddRow').removeAttribute('disabled');
                document.getElementById('btnAddRow').style.opacity = "1";
            } else {
                document.getElementById('btnAddRow').setAttribute("disabled", "disabled");
                document.getElementById('btnAddRow').style.opacity = "0.25";
            }
        }

        function isAdvisoryClient(){
            // var taxAdvisoryList = document.querySelectorAll("[data-product='Tax Advisory']");
            // var taxAdvisoryFlag = false;
            // for (let j = 0; j < taxAdvisoryList.length; j++) {
            //     if(taxAdvisoryList[j].checked == true) {
            //         taxAdvisoryFlag = true;
            //         break;
            //     }
            // }
            var taxAdvisoryFlag = selectedProductsMap.has(productNameToId.get('Tax Advisory'));
            
            if('{!hasActiveAdvisory}' == 'true' || taxAdvisoryFlag){
                return true;
            }
            return false;
        }

        function isBTPClient(){
            var btpFlag = selectedProductsMap.has(productNameToId.get('Business Tax Preparation'));

            
            if('{!hasActiveBTP}' == 'true' || btpFlag){
                return true;
            }
            return false;
        }

        function isHotlineClient(){
            return '{!hasActiveHotline}' == 'true';
        }


        function isBTPNSClient(){
            // var btpList = document.querySelectorAll("[data-product='Business Tax Preparation']");
            // var btpFlag = false;
            // for (let j = 0; j < btpList.length; j++) {
            //     if(btpList[j].checked == true) {
            //         btpFlag = true;
            //         break;
            //     }
            // }
            var btpFlag = selectedProductsMap.has(productNameToId.get('Business Tax Preparation - Federal Only'));

            
            if('{!hasActiveBTPNS}' == 'true' || btpFlag){
                return true;
            }
            return false;
        }

        function isPTPClient(){
            // var ptpList = document.querySelectorAll("[data-product='Personal Tax Preparation']");
            // var ptpFlag = false;
            // for (let j = 0; j < ptpList.length; j++) {
            //     if(ptpList[j].checked == true) {
            //         ptpFlag = true;
            //         break;
            //     }
            // }
            var ptpFlag = selectedProductsMap.has(productNameToId.get('Personal Tax Preparation'));


            if('{!hasActivePTP}' == 'true' || ptpFlag){
                return true;
            }
            return false;
        }



                
        function showModal() {
            console.log('showModal()');
            document.getElementById("modal").style.display = "block";  
        }
                
        function showModalSkip() {
            console.log('showModalSkip()');
            document.getElementById("modalSkip").style.display = "block";  
        }

        function showModalClientScreen() {
            console.log('showModalClientScreen()');
            document.getElementById("modalClientScreenn").style.display = "block";  
        }

        function showModalConfirmQuote() {
            console.log('showModalConfirmQuote()');
            if(flagDoSubmit == false){
                console.log('showModalConfirmQuote');
                document.getElementById("confirmQuoteModal").style.display = "block"; 
            } else { 
                nextSection(30, 'Payment Details', 'verifyInformation', 'paymentDetails');
                getChargeOverURL();
            }         
        }
                
        function showModalCancel() {
            console.log('showModalCancel()');
            if(isfinalScreen == true) {
                endPresentation();
            } else {
                document.getElementById('stopPres').setAttribute("disabled", "disabled");
                document.getElementById("modalCancel").style.display = "block";  
            }
        }
                
        function showModalEditClient() {
            console.log('showModalEditClient()');
            document.getElementById("modalEditClient").style.display = "block";  
        }
                
        function showModalEditPackage() {
            console.log('showModalEditPackage()');
            document.getElementById("skiptoSale").style.display = "inline";
            document.getElementById("closeOptions").style.display = "inline";
            document.getElementById("keepEditing").style.display = "none";
            document.getElementById("discardEditing").style.display = "none";
            //var selectedProducts = JSON.parse('{!selectedProductsJson}');
            
            //firstPackage = false; //debugging
            if(firstPackage == false) {
                var productIdToIdentifier = JSON.parse('{!productToIdentifier}');
                const nameMap = new Map(Object.entries(productIdToIdentifier));
                console.log('showModalEditPackage false');
                        
                // for (let i = 0; i < currentPlan.length; i++) {
                //     var productName = nameMap.get(currentPlan[i]);
                //     productSelected(true, currentPlan[i], productName); //this probably won't be necessary in the new structure
                // } 

                // //check for any auto-selected products based on default selections
                // for (let i = 0; i < tempSelectedProducts.length; i++) {
                //     var productName = nameMap.get(tempSelectedProducts[i].Product.Id);
                //     if(document.getElementById(tempSelectedProducts[i].Product.Id).childNodes.length > 6) {
                //         autoChecks(productName, document.getElementById(tempSelectedProducts[i].Product.Id).childNodes[1].childNodes[1]);
                //     } else {
                //         autoChecks(productName, document.getElementById(tempSelectedProducts[i].Product.Id).childNodes[0].childNodes[0]);
                //     }
                // }
                //calcFinance(false);
            } else {
                console.log('showModalEditPackage true');
            }
            
            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.getBusinessInfo', accId, function(r,e) {
                if(e.status) {
                    hasPayroll = e.result;
                }
            });

            document.getElementById("modalEditPackage").style.display = "block";  

            displayTablePlan('currentPlan', document.getElementById("tab2-1"), true);

            firstPackage = true;
        }

        function showModalEditClientInfo() {
            console.log('showModalEditClientInfo()');
            document.getElementById("modalEditClientInfo").style.display = "block";  
        }

        function showModalEditBillingAdd() {
            console.log('showModalEditBillingAdd()');
            document.getElementById("modalEditBillingAdd").style.display = "block";  
        }

        var lastPayTerms = 'No Financing';

        function getMinimumNumberOfPayments() {
            var total = getTotalAmountDue();
            return Math.ceil(total / 10000.0);
        }

        function showModalEditPayTerms() {
            console.log('showModalEditPayTerms()');
            var total = getTotalAmountDue();
            var payList = document.getElementById("payTerms").options;
            lastProductData = JSON.parse(JSON.stringify(finalProducts));
            lastPayTerms = payTerms;
            if(payTerms != 'mon'){
                for (let i = 1; i < payList.length; i++) {
                    payList[i].setAttribute("disabled", "disabled");
                }

                payList[0].removeAttribute('disabled');

                if(total < 500) {
                    document.getElementById('payTerms').setAttribute('disabled', 'disabled');
                    document.getElementById("payTerms").value = "No Financing";
                } else {
                    document.getElementById('payTerms').removeAttribute('disabled');
                    if(total >= 500 && total < 1000) {
                        payList[1].removeAttribute('disabled');
                        payList[2].removeAttribute('disabled');
                    } else if(total >= 1000 && total < 1450) {
                        payList[1].removeAttribute('disabled');
                        payList[2].removeAttribute('disabled');
                        payList[3].removeAttribute('disabled');
                    } else if(total >= 1450 && total < 1790) {
                        payList[1].removeAttribute('disabled');
                        payList[2].removeAttribute('disabled');
                        payList[3].removeAttribute('disabled');
                        payList[4].removeAttribute('disabled');
                    } else if(total >= 1790 && total < 10000) {
                        payList[1].removeAttribute('disabled');
                        payList[2].removeAttribute('disabled');
                        payList[4].removeAttribute('disabled');
                        payList[3].removeAttribute('disabled');
                        payList[5].removeAttribute('disabled');
                    } else {
                        payList[5].removeAttribute('disabled');
                        var minPayments = getMinimumNumberOfPayments();
                        if(minPayments <= 6) { payList[4].removeAttribute('disabled'); }
                        if(minPayments <= 4) { payList[3].removeAttribute('disabled'); }
                        if(minPayments <= 3) { payList[2].removeAttribute('disabled'); }
                        if(minPayments <= 2) { payList[1].removeAttribute('disabled'); }
                        if(minPayments > 1) { payList[0].setAttribute("disabled", "disabled"); }
                    }
                     
                }
            } else {
                for (let i = 0; i < payList.length-1; i++) {
                    payList[i].setAttribute("disabled", "disabled");
                }
                
                var minPayments = getMinimumNumberOfPayments();
                if(minPayments <= 6) { payList[4].removeAttribute('disabled'); }
                if(minPayments <= 4) { payList[3].removeAttribute('disabled'); }
                if(minPayments <= 3) { payList[2].removeAttribute('disabled'); }
                if(minPayments <= 2) { payList[1].removeAttribute('disabled'); }
                if(minPayments <= 1) { payList[0].removeAttribute('disabled'); }
            }
            
            document.getElementById("modalEditPayTerms").style.display = "block";  
        }

        function showModalOptions() {
            console.log('showModalOptions()');
            document.getElementById("modalOptionCloseEditing").style.display = "block";  
        }
                
        function closeModal() {
            console.log('closeModal()');
            document.getElementById("modal").style.display = "none";  
            document.getElementById("firstName").value = "";
            document.getElementById("lastName").value = "";
            document.getElementById("role").value = "";
            document.getElementById("email").value = "";
            document.getElementById("phone").value = "";
            document.getElementById("partnerResponseErrors").value = "";
        }

        function getDefaultProds(){
            return "{!defaultProducts}";
        }
                
        function closeModalSkip() {
            console.log('closeModalSkip()');
            document.getElementById("modalSkip").style.display = "none";  
        }

        function closeModalConfirmQuote() {
            console.log('closeModalConfirmQuote');
            document.getElementById("confirmQuoteModal").style.display = "none";  
        }

        function closeModalClientScreen() {
            console.log('closeModalClientScreen()');
            document.getElementById("modalClientScreenn").style.display = "none";  
        }
                
        function closeModalCancel() {
            console.log('closeModalCancel()');
            document.getElementById("modalCancel").style.display = "none";  
        }
                
        function closeModalEditClient() {
            console.log('closeModalEditClient()');
            document.getElementById("modalEditClient").style.display = "none";  
        }
                
        function closeModalEditPackage() {
            console.log('closeModalEditPackage()');
            document.getElementById("skiptoSale").style.display = "none";
            document.getElementById("closeOptions").style.display = "none";
            document.getElementById("keepEditing").style.display = "inline";
            document.getElementById("discardEditing").style.display = "inline";
        }

        function closeAndSave() {
            console.log('closeAndSave()');

            // displayTablePlan('currentPlan', {id: 'tab2-1', checked: true}, false);

            document.getElementById("skiptoSale").style.display = "inline";
            document.getElementById("closeOptions").style.display = "inline";
            document.getElementById("keepEditing").style.display = "none";
            document.getElementById("discardEditing").style.display = "none";
            document.getElementById("modalEditPackage").style.display = "none"; 

            document.getElementById("showPackagelabel").childNodes[0].checked = false;
            lastProductData = JSON.parse(JSON.stringify(finalProducts));
            //calcFinance(false);

            socket.connect();
            content = {
                page: "Bundle Status", 
                status: getBundleStatus()
            }
            socket.emit("private message", {
                content
            });
        }

        //discard changes
        function confimCloseModalEditPackage() {
            console.log('confimCloseModalEditPackage()');
            // displayTablePlan('currentPlan', {id: 'tab2-1', checked: true}, false);

            document.getElementById("skiptoSale").style.display = "inline";
            document.getElementById("closeOptions").style.display = "inline";
            document.getElementById("keepEditing").style.display = "none";
            document.getElementById("discardEditing").style.display = "none";
            document.getElementById("modalEditPackage").style.display = "none"; 

            document.getElementById("showPackagelabel").childNodes[0].checked = false;
            //var tempSelectedProducts = JSON.parse('{!selectedProductsJson}'); //overwrite temp values to discard changes
            discardProductChanges();

            //this code probably isn't running
            for (let i = 0; i < currentPlan.length; i++) {
                for (let j = 0; j < tempSelectedProducts.length; j++) {
                    if(!currentPlan[i].includes(tempSelectedProducts[j])) {
                        const list = document.getElementsByClassName(tempSelectedProducts[j]);
                        for (let l = 0; l < list.length; l++) {
                            if(list[l].id.includes("actionPlanTable")) {
                                list[l].checked = false;
                                list[l].value = false;
                                
                            }
                        }
                    }
                }
            }

            //I have no idea why this is here
            calculateTaxSavings();
            //CallApexMethod();
        }



        function discardProductChanges(){
            console.log('discardProductChanges');
            //revert product data to pre-edit values
            for(var oldProd of lastProductData){
                var curProd = finalProductsMap.get(oldProd.Product.Id);
                //curProd.selected = oldProd.selected;
                if(curProd.currentBillingFrequency != oldProd.currentBillingFrequency){
                    var isMonthly = oldProd.currentBillingFrequency == 'Monthly';
                    var monthlyOnes = document.getElementsByClassName(oldProd.Product.Id + 'monthly');
                    var yearlyOnes = document.getElementsByClassName(oldProd.Product.Id + 'yearly');
                    for(var r = 0; r < monthlyOnes.length; r++) {
                        monthlyOnes[r].checked = isMonthly;
                        monthlyOnes[r].value = isMonthly;
                        yearlyOnes[r].checked = !isMonthly;
                        yearlyOnes[r].value = !isMonthly;
                    }
                }
                curProd.enabled = oldProd.enabled;
                curProd.currentQuantity = oldProd.currentQuantity;
                curProd.currentBillingFrequency = oldProd.currentBillingFrequency;
                curProd.adjustedPrice = oldProd.adjustedPrice;
                //curProd.subtotal = oldProd.subtotal;
                if(selectedProductsMap.has(oldProd.Product.Id)){
                    curProd = selectedProductsMap.get(oldProd.Product.Id);
                    //curProd.selected = oldProd.selected;
                    curProd.enabled = oldProd.enabled;
                    curProd.currentQuantity = oldProd.currentQuantity;
                    curProd.currentBillingFrequency = oldProd.currentBillingFrequency;
                    curProd.adjustedPrice = oldProd.adjustedPrice;
                    //curProd.subtotal = oldProd.subtotal;
                } 
                if(curProd.selected != oldProd.selected){
                    addRemoveProduct(oldProd.Product.Id);
                } else {
                    updateProductSubtotal(oldProd.Product.Id);
                }
                // for(var x of document.getElementsByClassName("form-control "+oldProd.Product.Id)){
                //     x.value = oldProd.currentQuantity;
                //     x.nextElementSibling.value= oldProd.currentQuantity;
                // }
                const qtyBtnList = document.querySelectorAll("[data-product-qty='" + oldProd.Product.Name + "']");
                for(var i = 0; i < qtyBtnList.length; i++) {
                    qtyBtnList[i].value = oldProd.currentQuantity;
                }
                // updateQuoteTotals();
                // syncProdToClient(oldProd);
            }
            updateQuoteTotals();
            syncProdsToClient();
        }

        function backToEditing() {
            console.log('backToEditing()');
            document.getElementById("skiptoSale").style.display = "inline";
            document.getElementById("closeOptions").style.display = "inline";
            document.getElementById("keepEditing").style.display = "none";
            document.getElementById("discardEditing").style.display = "none";
        }

        function backToEdit() {
            console.log('backToEdit()');
            closeModalOptions();
            showModalEditPackage();
        }

        function showOptionsToClose() {
            console.log('showOptionsToClose()');
            document.getElementById("skiptoSale").style.display = "inline";
            document.getElementById("closeOptions").style.display = "inline";
            document.getElementById("keepEditing").style.display = "none";
            document.getElementById("discardEditing").style.display = "none";
            document.getElementById("modalEditPackage").style.display = "none";
            showModalOptions();
            document.getElementById("showPackagelabel").childNodes[0].checked = false;
        }

        function closeModalEditClientInfo() {
            console.log('closeModalEditClientInfo()');
            document.getElementById("modalEditClientInfo").style.display = "none";
            document.getElementById("modalEditClientInfoErrors").value = "";
        }

        function closeModalEditBillingAdd() {
            console.log('closeModalEditBillingAdd()');
            document.getElementById("modalEditBillingAdd").style.display = "none";
            document.getElementById("modalEditBillingAddErrors").value = "";
        }

        function closeModalEditPayTerms(discardChanges) {
            console.log('closeModalEditPayTerms()');
            if(discardChanges){                
                calcFinance(payTermsValueToLabel.get(lastPayTerms), true);
                for(var oldProd of lastProductData){              
                    if(oldProd.Product.Billing_Frequency__c == 'Annual' || oldProd.Product.Billing_Frequency__c == 'Monthly'){
                        var oldFrequency = (oldProd.currentBillingFrequency == 'Annual' ? 'yearly' : 'monthly');
                        calcFrecuencyChange({checked: true, id: oldFrequency}, oldProd.Product.Id, true);
                    }
                }
                document.getElementById('payTerms').value = payTermsValueToLabel.get(lastPayTerms);
            } else {
                lastProductData = JSON.parse(JSON.stringify(finalProducts));
            }
            document.getElementById("modalEditPayTerms").style.display = "none";
            document.getElementById("modalEditPayTermsErrors").value = "";     
        }

        function closeModalOptions() {
            console.log('closeModalOptions()');
            document.getElementById("modalOptionCloseEditing").style.display = "none";
        }
                
        function addRow(j) {
            console.log('addRow '+j);
            document.getElementById('btnAddRow').setAttribute("disabled", "disabled");
            document.getElementById('btnAddRow').style.opacity = "0.25";

            document.getElementById('thirdStart').removeAttribute('disabled');


            var action = document.getElementById("btnAddRow").innerHTML;
            var firstName = document.getElementById("firstName").value;
            var lastName = document.getElementById("lastName").value;
            var role = document.getElementById("role").value;
            var email = document.getElementById("email").value;
            
            if (!(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email))) {
                document.getElementById("emailFormatError").innerHTML = "Invalid email format.";
            } else {
                var phone = document.getElementById("phone").value;
                var contactId = (undefined == document.getElementById("contactId").value) ? null : document.getElementById("contactId").value;           
                
                var name = firstName + ' ' + lastName;
                var businessName = document.getElementById("businessName").value;
                var tBody = document.getElementById("tBody");
                var tableBody = document.getElementById("tableBody");
                var success = false;
                var jsonString = JSON.stringify({firstName: firstName, lastName: lastName, role: role, email: email, phone: phone});
            
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.createUpdatePartner', businessId, contactId, businessName, jsonString, function(r,e) {
                    if(e.status) {
                        if(action == "Add Partner") {
                            document.getElementById("addPartTable1").style.display = "none";  
                        
                            var ind1 = document.getElementById('contTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
                            var rowData1 = getRowData(ind1, "prin", name, role, email, phone, e.result);
                        
                            var ind2 = document.getElementById('addPartTable2').getElementsByTagName('tbody')[0].getElementsByTagName('tr').length;
                            var rowData2 = getRowData(ind2, "sec", name, role, email, phone, e.result);
                        
                            if(tBody.innerHTML != null) {
                                tableBody.innerHTML = tableBody.innerHTML + rowData1;
                                tBody.innerHTML = tBody.innerHTML + rowData2;
                            } else {
                                tableBody.innerHTML = rowData1;
                                tBody.innerHTML = rowData2;
                            }
                        
                            socket.connect();
                            content = {
                                page: "Partner Info",
                                name: name,
                                role: role,
                                email: email,
                                phone: phone 
                            }
                            socket.emit("private message", {
                                content
                            });
                            document.getElementById("menuOpts").options[1]?.removeAttribute('disabled'); 
                            
                            document.getElementById('start').removeAttribute('disabled');
                            document.getElementById('start').style.opacity = "1";
                            
                        } else if(action == "Save Partner") {
                            document.getElementById("addPartTable1").style.display = "none";  
                            var col;
                            
                            if(cPar.includes("prin")) {
                                col = cInd - 1;
                                
                                tBody.rows[cInd - 1].cells[0].childNodes[0].innerText = name[0];
                                tBody.rows[cInd - 1].cells[1].childNodes[0].childNodes[0].innerText = name;
                                tBody.rows[cInd - 1].cells[1].childNodes[0].childNodes[1].innerText = role;
                                tBody.rows[cInd - 1].cells[2].childNodes[0].childNodes[0].innerText = phone;
                                tBody.rows[cInd - 1].cells[2].childNodes[0].childNodes[1].innerText = email;
                                
                                tableBody.rows[cInd].cells[0].childNodes[0].innerText = name[0];
                                tableBody.rows[cInd].cells[1].childNodes[0].childNodes[0].innerText = name;
                                tableBody.rows[cInd].cells[1].childNodes[0].childNodes[1].innerText = role;
                                tableBody.rows[cInd].cells[2].childNodes[0].childNodes[0].innerText = phone;
                                tableBody.rows[cInd].cells[2].childNodes[0].childNodes[1].innerText = email;
                            
                            } else if (cPar.includes("sec")) {
                                col = cInd;
                                
                                tBody.rows[cInd].cells[0].childNodes[0].innerText = name[0];
                                tBody.rows[cInd].cells[1].childNodes[0].childNodes[0].innerText = name;
                                tBody.rows[cInd].cells[1].childNodes[0].childNodes[1].innerText = role;
                                tBody.rows[cInd].cells[2].childNodes[0].childNodes[0].innerText = phone;
                                tBody.rows[cInd].cells[2].childNodes[0].childNodes[1].innerText = email;
                                
                                tableBody.rows[cInd + 1].cells[0].childNodes[0].innerText = name[0];
                                tableBody.rows[cInd + 1].cells[1].childNodes[0].childNodes[0].innerText = name;
                                tableBody.rows[cInd + 1].cells[1].childNodes[0].childNodes[1].innerText = role;
                                tableBody.rows[cInd + 1].cells[2].childNodes[0].childNodes[0].innerText = phone;
                                tableBody.rows[cInd + 1].cells[2].childNodes[0].childNodes[1].innerText = email;
                            } 
                            
                            socket.connect();
                            content = {
                                page: "Edit Partner", 
                                index: col,
                                name: name,
                                role: role,
                                email: email,
                                phone: phone
                            }
                            socket.emit("private message", {
                                content
                            });
                            
                            cInd = '';
                            cPar = '';
                        } else if(action == "Save Primary Contact") {
                            tableBody.rows[0].cells[0].childNodes[1].innerText = name[0];
                            tableBody.rows[0].cells[1].childNodes[1].childNodes[1].innerText = name;
                            tableBody.rows[0].cells[1].childNodes[1].childNodes[3].innerText = role;
                            tableBody.rows[0].cells[2].childNodes[1].childNodes[1].innerText = phone;
                            tableBody.rows[0].cells[2].childNodes[1].childNodes[3].innerText = email;
                            document.getElementById('additionalName0').innerText = name;
                            for(x = 0; x < 18; x++){
                                document.getElementById('additionalFirstName' + x).innerText = firstName;
                            }
                        }
                    
                        name = '';
                        role = '';
                        email = '';
                        phone = '';
                        document.getElementById("btnAddRow").removeAttribute('disabled'); 
                        document.getElementById('btnAddRow').style.opacity = "1";
                    
                        closeModal();
                    } else if(e.type === 'exception') {
                        document.getElementById("partnerResponseErrors").innerHTML = e.message + "<br/>\n<pre>" + e.where + "</pre>";
                        document.getElementById("btnAddRow").removeAttribute('disabled'); 
                        document.getElementById('btnAddRow').style.opacity = "1";
                    }
                });
            }
        }
        
        function getRowData(num, diff, name, role, email, phone, contactId) {
            console.log('getRowData');
            var rowData = '<tr>'
            + '<td>' 
            + '<spam class="contIni">' + name[0] + '</spam>'
            + '</td>'
            + '<td>'
            + '<div class="contInfo">'
            + '<p class="contName">' + name + '</p>'
            + '<p class="contRole">' +  role + '</p>'
            + '</div>'
            + '</td>'
            + '<td>'
            + '<div class="contContaInfo">'
            + '<p class="contPhone">' + phone + '</p>'
            + '<p class="contEmail">' + email + '</p>'
            + '<p class="contContactId" style="display:none">' + contactId + '</p>'
            + '</div>'
            + '</td>'
            + '<td>'
            + '<div class="contMore">'
            + '<span class="material-icons" onClick="' + diff + 'rowMenu' + num + '();" id="btnSubMenu">more_vert</span>'
            + '<div id="' + diff + 'menu' + num + '" class="dropdown-content">'
            + '<a onclick="editPartner(this);"><span class="material-icons" id="icon">edit</span>&nbsp;Edit Partner</a>'
            + '<a onclick="deletePartner(this);" id="edit"><span class="material-icons" id="icon">delete</span>&nbsp;Delete Partner</a>'
            + '</div>'                               
            + '</div>'
            + '</td>'
            + '</tr>';
            return rowData;
        }
        var seenDefaults = false;

        function getProgress(){
            //var pageTotal = pageObjects.filter((x) => !x.entity || x.entity = entitySelected).length;
            var progress = Number.parseInt(((currentPageIndex+1) / (getFilteredPageObjects().length+1)) * 100);
            if(isNaN(progress)){progress = 3;}
            console.log('getProgress '+progress);
            return progress;
        }
        
        function nextSection(pickNum, opt, hideOne, showOne) { 
            nextPage();
            return;
            
        } 

        function getFilteredPageObjects(){
            if(!entitySelected){ return pageObjects; }
            return pageObjects.filter(x => !x.entity  || x.entity == entitySelected);
        }

        function getPageNames(){
            return [...new Set(getFilteredPageObjects().map((x) => x.name))];
        }

        function nextPage(pageName){
            var filteredPages = getFilteredPageObjects();
            if(currentPageIndex >= filteredPages.length-1){
                return;
            }
            //var currentProgress = getProgress();
            var current = filteredPages[currentPageIndex];
            currentPageIndex++;
            if(pageName){
                var index = filteredPages.findIndex((x) => x.name == pageName);
                if(index != -1) {currentPageIndex = index;}
            }
            var next = filteredPages[currentPageIndex];
            // if(beenPastReview && next.name == 'Business Discovery Intro'){
            //     next = filteredPages[++currentPageIndex];
            // }
            // while(next.entity && next.entity != entitySelected){
            //     currentPageIndex++;
            //     if(currentPageIndex >= pageObjects.length){ return; }
            //     next = pageObjects[currentPageIndex];
            // }

            document.getElementById(current.id).style.display = "none";
            document.getElementById(next.id).style.display = "block";
            //document.getElementById("menuOpts").options[currentPageIndex]?.removeAttribute('disabled');

            currentProgress = Math.max(currentProgress, getProgress());
            if(document.getElementById("menuOpts").options.length > currentPageIndex){
                document.getElementById("menuOpts").options[currentPageIndex]?.removeAttribute('disabled');
            }
            var nextPageName = next.name;
            var opt = next.name;
            console.log(nextPageName);
            document.getElementById("menuOpts").value = nextPageName;
            switch(next.name){
                case '1-800Accountant Blast':
                    nextPageName = ('white' == document.getElementById('yesBtn1').style.color) ? 'Back To Partners' : 'Back To Intro';
                    break;
                // case 'Business Discovery Intro':
                //     if(beenPastReview){
                //         reviewBusiDisc(true);
                //     }
                //     break;
                case 'Discovery Questions':
                    nextPageName = 'Business Discovery Parts';
                    //document.getElementById("menuOpts").options[pickNum]?.removeAttribute('disabled'); 
                    document.getElementById("menuOpts").value = opt;
                    document.getElementById("discoveryQuestionTitle").innerHTML = "Business Discovery";
                    //document.getElementById('engagee').style.display = "none";
                    if(checkRequiredQuestions()){
                        document.getElementById('thirdStart').removeAttribute('disabled');
                        document.getElementById('thirdStart').style.opacity = "1";
                        document.getElementById('errorMessage').style.display = "none";
                    } else {
                        document.getElementById('thirdStart').setAttribute("disabled", "disabled");
                        document.getElementById('thirdStart').style.opacity = "0.25";
                        document.getElementById('errorMessage').style.display = "flex"; 
                    }
                    setDefaultDiscoveryAnswers();
                    for(var question of discoveryQuestions){
                        if(question.Answered && question.QuestionType != 'Text Only'){
                            var questionObj = {checked: true, value:question.Value, className: (question.Value == 'Yes' || question.Value == true)  ? 'yesBtn' : 'noBtn' }
                            populateAnswer(question.DevName, questionObj, question.QuestionType, false, true);
                        }
                    }

                    document.getElementById('mainCategoryDiv').style.background = "white";
                    document.getElementById('mainCategoryDiv').style.border = "none";
                    document.getElementById('mainCategoryDiv').style.borderRadius = "0px";
                    document.querySelector('[data-id="mainCategory"]').style.marginTop = "0px";
                    document.querySelector('[data-id="mainCategory"]').style.width = "100%";
                    document.querySelector('[data-id="mainCategory"]').style.marginLeft = "0px";
                    document.getElementById('showAllAnswer').style.display = "none";
                    // if(beenPastReview){
                    //     whatToDo();
                    //     return;
                    // }
                    break;
                case 'Self-Employment Tax (FICA)':
                    getSlideOne();
                    return;
                case 'Review Proper Entity Structuring': 
                    if(entitySelected == 'LLC'){
                        nextPageName = "Proper Entity Structuring Review LLC";
                    } else {
                        nextPageName = "Proper Entity Structuring Review SCorp";
                    }
                    break;
                case 'Deductions Introduction':
                    nextPageName = 'Deductions Intro';
                    break;
                case 'Start-up Costs':
                    validateButtons()
                    break;
                case 'Medical Deduction':
                    showDeductBtns();
                    document.getElementById('dedMedical').style.display = "flex";
                    break;
                case 'Vehicle Deduction':
                    showDeductBtns();
                    document.getElementById('dedVehicle').style.display = "flex";
                    break;
                case 'Home Office Deduction':
                    showDeductBtns();
                    document.getElementById('dedHomeOffice').style.display = "flex";
                    break;
                case 'Code Section 199A Deduction':
                    showDeductBtns();
                    document.getElementById('dedCodeSec').style.display = "flex";
                    break;
                case 'Review Deductions':
                    if(entitySelected == 'LLC') {
                        document.getElementById('revDeductForEntity').innerHTML = 'We have discussed Flow Through Entity, ECE, Self-Employment Tax, Startup and Organizational Expenses,';
                    } else if(entitySelected == 'S Corporation') {
                        document.getElementById('revDeductForEntity').innerHTML = 'We have discussed Flow Through Entity, Self-Employment Tax, Fair and Reasonable Salary, Start-up Costs, and Organizational Expenses,';
                    }
                    break;
                case 'Paper Loss':
                    getSecOne();
                    return;
                case 'Prepared Packages':
                    document.getElementById("switchText").style.display = "inline-block";
                    document.getElementById("showPackagelabel").style.display = "inline-block";

                    document.getElementById("entityFormationPlan").style.display = "none";
                    document.getElementById("bookkeepingPlan").style.display = "none";
                    document.getElementById("payrollPlan").style.display = "none";
                    document.getElementById("personalPlan").style.display = "none";
                    document.getElementById("businessPlan").style.display = "none";
                    document.getElementById("frequentPlan").style.display = "none";
                    document.getElementById("AllPlan").style.display = "none";
                    
                    displayTablePlan('currentPlan', document.getElementById("tab2-1"), true);
                    break;
                case 'Verify Information':
                    var t = formatMoney(getTotalAmountDue());//document.getElementById('payAmountDue').innerHTML;
                    var d = formatMoney(getDueToday());//document.getElementById('payAmountToday').innerHTML;
                    socket.connect();
                    content = {
                        showProgress: true,
                        progress: currentProgress,
                        page: "Payment Details",
                        name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                        total: t, //sets element with id=balanceSectionAmount
                        due: d, //sets element with id=balanceSectionTitle
                        installAmount: formatMoney(getInstallmentAmount()) //sets element with id=monthlyDue
                    }
                    socket.emit("private message", {
                        content
                    });
                    return;
                    //break;
                case 'Payment Details':
                    document.getElementById('nextPayment').setAttribute('disabled', 'disabled');
                    document.getElementById('nextPayment').style.opacity = "0.25";

                    var t = formatMoney(getTotalAmountDue());//document.getElementById('payAmountDue').innerHTML;
                    var d = formatMoney(getDueToday());//document.getElementById('payAmountToday').innerHTML;

                    socket.connect();
                    content = {
                        showProgress: true,
                        progress: currentProgress,
                        page: "Payment Details",
                        name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                        total: t,//sets element with id=balanceSectionAmount
                        due: d, //sets element with id=balanceSectionTitle
                        installAmount: formatMoney(getInstallmentAmount()) //sets element with id=monthlyDue
                    }
                    socket.emit("private message", {
                        content
                    });
                    return;
                case 'Post Purchase':
                    isfinalScreen = true;

                    // document.getElementById("menuOpts").options[pickNum]?.removeAttribute('disabled'); 
                    // document.getElementById("menuOpts").value = opt;

                    schedulerURL = schedulerURL + '&Frame=1';
                    document.getElementById('Scheduler').src = schedulerURL;

                    socket.connect();
                    content = {
                        page: "Post Purchase"
                    }
                    socket.emit("private message", {
                        content
                    });

                    secondaryDisp = 'Sale';  
                    whenDisposition = 'afterPayment';
                    return;
                case '1-800Accountant Introduction':
                    getSecOnefeat();
                    return;
                case 'Features - 1-800Accountant Portal':
                    getSectionsPortal('Intro');
                    return;
                case 'Features - BOI Summary':
                    nextPageName = "Beneficial Ownership Information (BOI)";
                    break;
                default:
                    break;
                }

            socket.connect();
            content = {
                page: nextPageName,
                progress: currentProgress,
                showProgress: true
            }
            socket.emit("private message", {
                content
            });
        }

        function previousPage(pageName){
            var filteredPages = getFilteredPageObjects();
            if(currentPageIndex <= 0 && !pageName){
                return;
            }
            //var currentProgress = getProgress();
            var current = filteredPages[currentPageIndex];            
            
            currentPageIndex--;
            if(pageName){
                var index = filteredPages.findIndex((x) => x.name == pageName);
                if(index != -1) {currentPageIndex = index;}
            }
            var previous = filteredPages[currentPageIndex];
            // while(previous.entity && previous.entity != entitySelected){
            //     currentPageIndex--;
            //     if(currentPageIndex < 0){ return; }
            //     previous = pageObjects[currentPageIndex];
            // }
            

            document.getElementById(current.id).style.display = "none";
            document.getElementById(previous.id).style.display = "block";
            //document.getElementById("menuOpts").options[currentPageIndex]?.removeAttribute('disabled');

            currentProgress = Math.max(currentProgress, getProgress());
            var previousPageName = previous.name;
            var opt = previous.name;
            document.getElementById("menuOpts").value = previousPageName;
            switch(previous.name){
                case 'Introduction':
                    previousPageName = ('white' == document.getElementById('yesBtn1').style.color) ? 'Back To Partners' : 'Back To Intro';
                    break;
                case '1-800Accountant Blast':
                    previousPageName = "Blast";
                    break;
                case 'Discovery Questions':
                    //previousPageName = 'Business Discovery Review';
                    previousPageName = 'Business Discovery Parts';
                    // setDefaultDiscoveryAnswers();
                    // //document.getElementById("menuOpts").options[pickNum]?.removeAttribute('disabled'); 
                    // document.getElementById("menuOpts").value = opt;
                    // document.getElementById("discoveryQuestionTitle").innerHTML = "Business Discovery";
                    // document.getElementById('engagee').style.display = "none";
                    // document.getElementById('thirdStart').setAttribute("disabled", "disabled");
                    // document.getElementById('thirdStart').style.opacity = "0.25";
                    // document.getElementById('errorMessage').style.display = "flex"; 

                    // document.getElementById('mainCategoryDiv').style.background = "white";
                    // document.getElementById('mainCategoryDiv').style.border = "none";
                    // document.getElementById('mainCategoryDiv').style.borderRadius = "0px";
                    // document.getElementById('mainCategory').style.marginTop = "0px";
                    // document.getElementById('mainCategory').style.width = "100%";
                    // document.getElementById('mainCategory').style.marginLeft = "0px";
                    // document.getElementById('showAllAnswer').style.display = "none";
                    break;
                case 'Self-Employment Tax (FICA)':
                    getSlideOne();
                    return;
                case 'Review Proper Entity Structuring': 
                    if(entitySelected == 'LLC'){
                        previousPageName = "Proper Entity Structuring Review LLC";
                    } else {
                        previousPageName = "Proper Entity Structuring Review SCorp";
                    }
                    break;
                case 'Deductions Introduction':
                    previousPageName = 'Deductions Intro';
                    break;
                case 'Start-up Costs':
                    validateButtons()
                    break;
                case 'Medical Deduction':
                    showDeductBtns();
                    document.getElementById('dedMedical').style.display = "flex";
                    break;
                case 'Vehicle Deduction':
                    showDeductBtns();
                    document.getElementById('dedVehicle').style.display = "flex";
                    break;
                case 'Home Office Deduction':
                    showDeductBtns();
                    document.getElementById('dedHomeOffice').style.display = "flex";
                    break;
                case 'Code Section 199A Deduction':
                    showDeductBtns();
                    document.getElementById('dedCodeSec').style.display = "flex";
                    break;
                case 'Review Deductions':
                    if(entitySelected == 'LLC') {
                        document.getElementById('revDeductForEntity').innerHTML = 'We have discussed Flow Through Entity, ECE, Self-Employment Tax, Startup and Organizational Expenses,';
                    } else if(entitySelected == 'S Corporation') {
                        document.getElementById('revDeductForEntity').innerHTML = 'We have discussed Flow Through Entity, Self-Employment Tax, Fair and Reasonable Salary, Start-up Costs, and Organizational Expenses,';
                    }
                    break;
                case 'Paper Loss':
                    getSecOne();
                    return;
                case 'Prepared Packages':
                    document.getElementById("switchText").style.display = "inline-block";
                    document.getElementById("showPackagelabel").style.display = "inline-block";

                    document.getElementById("entityFormationPlan").style.display = "none";
                    document.getElementById("bookkeepingPlan").style.display = "none";
                    document.getElementById("payrollPlan").style.display = "none";
                    document.getElementById("personalPlan").style.display = "none";
                    document.getElementById("businessPlan").style.display = "none";
                    document.getElementById("frequentPlan").style.display = "none";
                    document.getElementById("AllPlan").style.display = "none";
                    
                    displayTablePlan('currentPlan', document.getElementById("tab2-1"), true);
                    break;
                case 'Verify Information':
                    var t = formatMoney(getTotalAmountDue());//document.getElementById('payAmountDue').innerHTML;
                    var d = formatMoney(getDueToday());//document.getElementById('payAmountToday').innerHTML;
                    socket.connect();
                    content = {
                        showProgress: true,
                        progress: currentProgress,
                        page: "Payment Details",
                        name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                        total: t, //sets element with id=balanceSectionAmount
                        due: d, //sets element with id=balanceSectionTitle
                        installAmount: formatMoney(getInstallmentAmount()) //sets element with id=monthlyDue
                    }
                    socket.emit("private message", {
                        content
                    });
                    //return;
                    break;
                case 'Payment Details':
                    document.getElementById('nextPayment').setAttribute('disabled', 'disabled');
                    document.getElementById('nextPayment').style.opacity = "0.25";

                    var t = formatMoney(getTotalAmountDue());//document.getElementById('payAmountDue').innerHTML;
                    var d = formatMoney(getDueToday());//document.getElementById('payAmountToday').innerHTML;

                    socket.connect();
                    content = {
                        showProgress: true,
                        progress: currentProgress,
                        page: "Payment Details",
                        name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                        total: t,//sets element with id=balanceSectionAmount
                        due: d, //sets element with id=balanceSectionTitle
                        installAmount: formatMoney(getInstallmentAmount()) //sets element with id=monthlyDue
                    }
                    socket.emit("private message", {
                        content
                    });
                    return;
                case 'Post Purchase':
                    isfinalScreen = true;

                    //document.getElementById("menuOpts").options[pickNum]?.removeAttribute('disabled'); 
                    document.getElementById("menuOpts").value = opt;

                    schedulerURL = schedulerURL + '&Frame=1';
                    document.getElementById('Scheduler').src = schedulerURL;

                    socket.connect();
                    content = {
                        page: "Post Purchase"
                    }
                    socket.emit("private message", {
                        content
                    });

                    secondaryDisp = 'Sale';  
                    whenDisposition = 'afterPayment';
                    return;
                case '1-800Accountant Introduction':
                    getSecOnefeat();
                    return;
                case 'Features - 1-800Accountant Portal':
                    getSectionsPortal('Intro');
                    return;
                case 'Features - BOI Summary':
                    previousPageName = "Beneficial Ownership Information (BOI)";
                    break;
                default:
                    break;
                }

            socket.connect();
            content = {
                page: previousPageName,
                progress: currentProgress,
                showProgress: true
            }
            socket.emit("private message", {
                content
            });
        }

        function setDefaultDiscoveryAnswers(skipSync){
            return;
            var defaultYearsInBusiness = answerMap?.get('How many years have you been in business') ? answerMap?.get('How many years have you been in business') : '{!defaultYearsInBusiness}';
            var defaultEntity = answerMap?.get('What entity type is your business') ? answerMap?.get('What entity type is your business') : '{!defaultEntity}';
            var defaultIndustry = answerMap?.get('What industry is your business in') ? answerMap?.get('What industry is your business in') :'{!defaultIndustry}';
            var defaultDomesticState = answerMap?.get('What is your state of incorporation') ? answerMap?.get('What is your state of incorporation') :'{!defaultDomesticState}';
            var defaultForeignState = answerMap?.get('What is your foreign state of incorporation') ? answerMap?.get('What is your foreign state of incorporation') : '{!defaultForeignState}';
            //var defaultPersonalState = '{defaultPersonalState}';
            var defaultStartupCosts = answerMap?.get('How much have you invested so far in start-up costs') ? answerMap?.get('How much have you invested so far in start-up costs') :'{!defaultStartupCosts}';
            var defaultRevenue = answerMap?.get('What do you anticipate your revenue to be over the next 12 months') ? answerMap?.get('What do you anticipate your revenue to be over the next 12 months') : '{!defaultRevenue}';
            var defaultFirstYearProfit = answerMap?.get('What do you project your 1st year profit to be over the next 12 months') ? answerMap?.get('What do you project your 1st year profit to be over the next 12 months') : '{!defaultFirstYearProfit}';
            //var defaultInvestorFunding = '{defaultInvestorFunding}';
            var defaultNumTransactions = answerMap?.get('How many monthly bookkeeping transactions do you have') ? answerMap?.get('How many monthly bookkeeping transactions do you have') : '{!defaultNumTransactions}';
            //var defaultNumForeignOwners = '{defaultNumForeignOwners}';
            var defaultNumOwners = answerMap?.get('How many owners does your business have') ? answerMap?.get('How many owners does your business have') :'{!defaultNumOwners}';
            var defaultNumEmployees = answerMap?.get('How many employees do you have') ? answerMap?.get('How many employees do you have') : '{!defaultNumEmployees}';
            //var defaultNumContractors = '{defaultNumContractors}';
            var defaultFilingStatus = answerMap?.get('What is your tax filing status') ? answerMap?.get('What is your tax filing status') : '{!defaultFilingStatus}';
            var defaultPersonalIncome = answerMap?.get('What was your household W-2 income last year') ? answerMap?.get('What was your household W-2 income last year') : '{!defaultPersonalIncome}';
            var defaultNumberOfRentalProperties = answerMap?.get('How many rental properties do you have') ? answerMap?.get('How many rental properties do you have') : '{!defaultNumberOfRentalProperties}';
            //var defaultOtherInvestments = '{defaultOtherInvestments}';
            var defaultOffice = answerMap?.get('What is the approximate square footage of your home office') ? answerMap?.get('What is the approximate square footage of your home office') : '{!defaultOffice}';
            var defaultMileage = answerMap?.get('How many business-related miles do you estimate youll drive per year') ? answerMap?.get('How many business-related miles do you estimate youll drive per year') : '{!defaultMileage}';
            var firstBusiness = answerMap?.get('Is this your first business') ? answerMap?.get('Is this your first business') : '{!firstBusiness}';
            var runPayrollBefore = answerMap?.get('Have you run payroll before') ? answerMap?.get('Have you run payroll before') : '{!runPayrollBefore}';
            var hasEmployeesContractors = answerMap?.get('Do you currently have any employees') ? answerMap?.get('Do you currently have any employees') : '{!hasEmployeesContractors}';
            //var foreignIncome = '{foreignIncome}';
            var hasRentalProperties = answerMap?.get('Do you currently have any rental properties') ? answerMap?.get('Do you currently have any rental properties') : '{!hasRentalProperties}';
            var isWorkingFromHome = answerMap?.get('Will you be working from home') ? answerMap?.get('Will you be working from home') : '{!isWorkingFromHome}';
            var commutesWithOwnVehicle = answerMap?.get('Will you use your personal vehicle for business purposes') ? answerMap?.get('Will you use your personal vehicle for business purposes') : '{!commutesWithOwnVehicle}';
            //var eCommerce = '{eCommerce}';
            var bookStart = answerMap?.get('What transaction date should your bookkeeper start on') ? answerMap?.get('What transaction date should your bookkeeper start on') : '{!existingBookkeepingStart}';
            var bookEnd = answerMap?.get('What transaction date should your bookkeeper end on') ? answerMap?.get('What transaction date should your bookkeeper end on') : '{!existingBookkeepingEnd}';
            console.log('{!existingBookkeepingEnd}');
            console.log(bookEnd);
            //setRequiredUnasweredFields();

            if('---' != defaultYearsInBusiness){
                getNextBtn('Years In Business');
                populateAnswer('How many years have you been in business?', defaultYearsInBusiness, false, skipSync);
            }
            if('Select an Entity Type' != defaultEntity){
                updateEntity({value: defaultEntity});
                getNextBtn('Entity Type');
                populateAnswer('What entity type is your business?', defaultEntity, false, skipSync);
            }
            if('Select an Industry' != defaultIndustry){
                getNextBtn('Industry Type');
                populateAnswer('What industry is your business in?', defaultIndustry, false, skipSync);
            }
            if('Select a State' != defaultDomesticState){
                getNextBtn('State of Incorporation');
                populateAnswer('What is your state of incorporation?', defaultDomesticState, false, skipSync);
            }
            if('Select a State' != defaultForeignState){
                getNextBtn('Foreign State');
                populateAnswer('What is your foreign state of incorporation?', defaultForeignState, false, skipSync);
            }
            // if('Select a State' != defaultPersonalState){
            //     getNextBtn('State of Residence');
            //     populateAnswer('What is your state of residence?', defaultPersonalState, false, skipSync);
            // }
            if('---' != defaultStartupCosts){
                getNextBtn('Total Startup Cost');
                populateAnswer('How much have you invested so far in start-up costs?', defaultStartupCosts, false, skipSync);
            }
            if('---' != defaultRevenue){
                getNextBtn('Projected 1st Year Revenue');
                populateAnswer('What do you anticipate your revenue to be over the next 12 months?', defaultRevenue, false, skipSync);
            }
            if('---' != defaultFirstYearProfit){
                getNextBtn('Projected 1st Year Profit');
                populateAnswer('What do you project your 1st year profit to be over the next 12 months?', defaultFirstYearProfit, false, skipSync);
            }
            // if('---' != defaultInvestorFunding){
            //     getNextBtn('Investor Funding');
            //     populateAnswer('What is your total investor funding?', defaultInvestorFunding, false, skipSync);
            // }
            if('---' != defaultNumTransactions){
                getNextBtn('Number of Transactions');
                populateAnswer('How many monthly bookkeeping transactions do you have?', defaultNumTransactions, false, skipSync);
            }
            if('---' != defaultNumOwners){
                getNextBtn('Number of Owners');
                populateAnswer('How many owners does your business have?', defaultNumOwners, false, skipSync);
            }
            // if('---' != defaultNumForeignOwners){
            //     getNextBtn('Number of Owners');
            //     getNextBtn('Foreign Owners');
            //     populateAnswer('How many owners are outside the USA?', defaultNumForeignOwners, false, skipSync);
            // }
            if('---' != defaultNumEmployees){
                getNextBtn('Number of Employees');
                populateAnswer('How many employees do you have?', defaultNumEmployees, false, skipSync);
            }
            // if('---' != defaultNumContractors){
            //     getNextBtn('Number of Contractors');
            //     populateAnswer('How many contractors do you have?', defaultNumContractors, false, skipSync);
            // }
            if('Select a Filing Status' != defaultFilingStatus){
                getNextBtn('Filing Status');
                populateAnswer('What is your tax filing status?', defaultFilingStatus, false, skipSync);
            }
            if('---' != defaultPersonalIncome){
                getNextBtn('Personal Income');
                populateAnswer('What was your household W-2 income last year?', defaultPersonalIncome, false, skipSync);
            }
            if('---' != defaultNumberOfRentalProperties){
                getNextBtn('Number of Rental Properties');
                populateAnswer('How many rental properties do you have?', defaultNumberOfRentalProperties, false, skipSync);
            }
            // if('---' != defaultOtherInvestments){
            //     getNextBtn('Number of Rental Properties');
            //     populateAnswer('How many K-1s are from other investments?', defaultOtherInvestments, false, skipSync);
            // }
            if('---' != defaultOffice){
                getNextBtn('Office Square Footage');
                populateAnswer('What is the approximate square footage of your home office?', defaultOffice, false, skipSync);
            }
            if('---' != defaultMileage){
                getNextBtn('Business Miles');
                populateAnswer('How many business-related miles do you estimate youll drive per year?', defaultMileage, false, skipSync);
            }
            if('' != bookStart){
                document.querySelector('.date-select.start-date').value = bookStart;
                getNextBtn('Bookkeeping Start Date');
                populateAnswer('What transaction date should your bookkeeper start on?', bookStart, false, skipSync);
            }
            if('' != bookEnd){
                document.querySelector('.date-select.end-date').value = bookEnd;
                getNextBtn('Bookkeeping End Date');
                populateAnswer('What transaction date should your bookkeeper end on?', bookEnd, false, skipSync);
            }

            if(firstBusiness == 'true'){
                YesDecision(1.1);
                populateAnswer('Is this your first business?', 'Yes', false, skipSync);
                getNextBtn('First Business');
            } else if(isEditQuote && firstBusiness == 'false') {
                NoDecision(1.1);
                populateAnswer('Is this your first business?', 'No', false, skipSync);
                getNextBtn('First Business');
            }

            if(runPayrollBefore == 'true'){
                YesDecision(1.2);
                populateAnswer('Have you run payroll before?', 'Yes', false, skipSync);
                getNextBtn('Run Payroll Before');
            } else if(isEditQuote && runPayrollBefore == 'false') {
                NoDecision(1.2);
                populateAnswer('Have you run payroll before?', 'No', false, skipSync);
                getNextBtn('Run Payroll Before');
            }

            if(hasEmployeesContractors == 'true'){
                YesDecision(1.3);
                populateAnswer('Do you currently have any employees?', 'Yes', false, skipSync);
                linkedYesNo('Employees and Contractors');
            } else if(isEditQuote && hasEmployeesContractors == 'false') {
                NoDecision(1.3);
                populateAnswer('Do you currently have any employees?', 'No', false, skipSync);
                linkedYesNo('Employees and Contractors');
            }
            // if(foreignIncome == 'true'){
            //     YesDecision(1.5);
            //     populateAnswer('Do you have any foreign sourced income?', 'Yes', false, skipSync);
            // }
            if(hasRentalProperties == 'true'){
                YesDecision(1.6);
                populateAnswer('Do you currently have any rental properties?', 'Yes', false, skipSync);
                linkedYesNo('Number of Rental Properties');
            } else if(isEditQuote && hasRentalProperties == 'false') {
                NoDecision(1.6);
                populateAnswer('Do you currently have any rental properties?', 'No', false, skipSync);
                linkedYesNo('Number of Rental Properties');
            }

            if(isWorkingFromHome == 'true'){
                YesDecision(1.7);
                populateAnswer('Will you be working from home?', 'Yes', false, skipSync);
                linkedYesNo('Working from Home');
            } else if(isEditQuote && isWorkingFromHome == 'false') {
                NoDecision(1.7);
                populateAnswer('Will you be working from home?', 'No', false, skipSync);
                linkedYesNo('Working from Home');
            }

            if(commutesWithOwnVehicle == 'true'){
                YesDecision(1.8);
                populateAnswer('Will you use your personal vehicle for business purposes?', 'Yes', false, skipSync);
                linkedYesNo('Driving');
            } else if(isEditQuote && commutesWithOwnVehicle == 'false') {
                NoDecision(1.8);
                populateAnswer('Will you use your personal vehicle for business purposes?', 'No', false, skipSync);
                linkedYesNo('Driving');
            }
            // if(eCommerce == 'true'){
            //     YesDecision(1.9);
            //     populateAnswer('Will your business have a web or e-commerce presence?', 'Yes', false, skipSync);
            // }
        }
                    
        function backSection(opt, showOne, hideOne) {
            console.log('backsection');
            previousPage();
            return;
        }
            
        function backThirdSection() {
            socket.connect();
            //go back to first discovery page
            if (document.getElementById('busiDisc').innerHTML != "Business Discovery Intro" && !beenPastReview) {
                document.getElementById("menuOpts").value = "Discovery Questions";
                document.getElementById("discoveryQuestionTitle").innerHTML = "Business Discovery";
                //document.getElementById('engagee').style.display = "none";
                document.getElementById('busiDisc').innerHTML = "Business Discovery Intro";
                document.getElementById('endNote').innerHTML = "Review Business Discovery";

                document.getElementById('mainCategoryDiv').style.background = "white";
                document.getElementById('mainCategoryDiv').style.border = "none";
                document.getElementById('mainCategoryDiv').style.borderRadius = "0px";
                document.querySelector('[data-id="mainCategory"]').style.marginTop = "0px";
                document.querySelector('[data-id="mainCategory"]').style.width = "100%";
                document.querySelector('[data-id="mainCategory"]').style.marginLeft = "0px";
                document.getElementById('showAllAnswer').style.display = "none";

                content = {
                    page: "Business Discovery Parts", 
                    name: "Initial"
                }
                socket.emit("private message", {
                    content
                });
            } else {
                //go back to intro page
                document.getElementById("menuOpts").value = "Business Discovery Intro";
                document.getElementById('businessDisc').style.display = "block";
                document.getElementById('businessDiscParts').style.display = "none";
                content = {
                    page: "Business Discovery Intro"
                }
                socket.emit("private message", {
                    content
                });
            }
            currentPageIndex--;
        }
            
        function prinrowMenu0() { document.getElementById("prinmenu0").classList.toggle("show"); }
        function prinrowMenu1() { document.getElementById("prinmenu1").classList.toggle("show"); }
        function prinrowMenu2() { document.getElementById("prinmenu2").classList.toggle("show"); }
        function prinrowMenu3() { document.getElementById("prinmenu3").classList.toggle("show"); }
        function prinrowMenu4() { document.getElementById("prinmenu4").classList.toggle("show"); }
        function prinrowMenu5() { document.getElementById("prinmenu5").classList.toggle("show"); }
                    
        function secrowMenu0() { document.getElementById("secmenu0").classList.toggle("show"); }
        function secrowMenu1() { document.getElementById("secmenu1").classList.toggle("show"); }
        function secrowMenu2() { document.getElementById("secmenu2").classList.toggle("show"); }
        function secrowMenu3() { document.getElementById("secmenu3").classList.toggle("show"); }
        function secrowMenu4() { document.getElementById("secmenu4").classList.toggle("show"); }
                    
        window.onclick = function(event) {
            if (!event.target.matches('#btnSubMenu')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                var i;
                for (i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }
                    
        function deletePartner(i) { 
            var parent = i.parentElement.id;
            var index = i.parentElement.parentElement.parentElement.parentElement.rowIndex;
            var col;
                    
            cInd = i.parentElement.parentElement.parentElement.parentElement.rowIndex;
            cPar = i.parentElement.id;
                    
            var path = i.parentElement.parentElement.parentElement.parentElement;
            var contactId = path.childNodes[2].childNodes[0].childNodes[2].innerText;
            
            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.createUpdatePartner', businessId, contactId, null, null, function(r,e) {
                if(e.status) {
                    if(parent.includes("prin")) {
                        col = index - 1;
                        document.getElementById("contTable").deleteRow(index);
                        document.getElementById("addPartTable2").deleteRow(index - 1);
                    } else if (parent.includes("sec")) {
                        col = index;
                        document.getElementById("contTable").deleteRow(index + 1);
                        document.getElementById("addPartTable2").deleteRow(index);
                    }
                    
                    var tableLength = document.getElementById("addPartTable2").rows.length;
                    
                    if(tableLength == 0) {
                        document.getElementById("addPartTable1").style.display = "table";
                        document.getElementById('start').setAttribute("disabled", "disabled");
                        document.getElementById('start').style.opacity = "0.25";
                        partnersGone = true;
                    
                    } 
                    
                    if(tableLength == 4) {
                        document.getElementById("btnAdd").style.display = "block";  
                    } 
                    
                    socket.connect();
                    content = {
                        page: "Delete Partner", 
                        index: col
                    }
                    socket.emit("private message", {
                        content
                    });
                } else if(e.type === 'exception') {
                    alert(e.message);
                }
            });
        }
        
        function editPartner(x) { 
            document.getElementById("modal").style.display = "block";
            
            cInd = x.parentElement.parentElement.parentElement.parentElement.rowIndex;
            cPar = x.parentElement.id;
            
            var path = x.parentElement.parentElement.parentElement.parentElement;
            var name = path.childNodes[1].childNodes[0].childNodes[0].innerText;
            var role = path.childNodes[1].childNodes[0].childNodes[1].innerText;
            var phone = path.childNodes[2].childNodes[0].childNodes[0].innerText;
            var email = path.childNodes[2].childNodes[0].childNodes[1].innerText;
            var contactId = path.childNodes[2].childNodes[0].childNodes[2].innerText;
            
            var theName = name.split(" ");
            
            document.getElementById("firstName").value = theName[0];
            document.getElementById("lastName").value = theName[1];
            document.getElementById("role").value = role;
            document.getElementById("email").value = email;
            document.getElementById("phone").value = phone;
            document.getElementById("contactId").value = contactId;
            
            document.getElementById("btnAddRow").innerHTML = "Save Partner";
        }
        
        function editPrimary(x) { 
            document.getElementById("modal").style.display = "block";
            
            cInd = x.parentElement.parentElement.parentElement.parentElement.rowIndex;
            cPar = x.parentElement.id;
            
            var path = document.querySelector("#prinmenu0 > a:nth-child(1)").parentElement.parentElement.parentElement.parentElement;
            var name = path.childNodes[3].childNodes[1].childNodes[1].innerText;
            var role = path.childNodes[3].childNodes[1].childNodes[3].innerText;
            var phone = path.childNodes[5].childNodes[1].childNodes[1].innerText;
            var email = path.childNodes[5].childNodes[1].childNodes[3].innerText;
            var contactId = path.childNodes[5].childNodes[1].childNodes[5].innerText;
            
            var theName = name.split(" ");
            
            document.getElementById("firstName").value = theName[0];
            document.getElementById("lastName").value = theName[1];
            document.getElementById("role").value = role;
            document.getElementById("email").value = email;
            document.getElementById("phone").value = phone;
            document.getElementById("contactId").value = contactId;
            
            document.getElementById("btnAddRow").innerHTML = "Save Primary Contact";
        }
        
        //document.onclick = hideMenu;
        //document.oncontextmenu = rightClick;
        
        function hideMenu() {
            document.getElementById("contextMenu").style.display = "none";
        }
        
        function rightClick(e) {
            var targetId = event.target.id;
            if (targetId == "script" || targetId == "high") {
                e.preventDefault();
            }
            
            if (document.getElementById("contextMenu").style.display == "block") {
                hideMenu();
            } else {
                var menu = document.getElementById("contextMenu");
                
                menu.style.display = 'block';
                menu.style.left = e.pageX + "px";
                menu.style.top = e.pageY + "px";
            }
        }
        
        function highlight() {
            var selection;
            if(window.getSelection) {
                selection = window.getSelection();
            } else if(typeof document.selection != "undefined") {
                selection = document.selection;
            }
            
            var range = selection.getRangeAt(0);
            if(range && !selection.isCollapsed) {
                if(selection.anchorNode.parentNode.className == "normalTxt") {
                    var span = document.createElement('span');
                    span.className = 'highlight';
                    span.id = 'high';
                    range.surroundContents(span);
                } else if(selection.anchorNode.parentNode.className == "highlight" || selection.anchorNode.parentNode.className == "unhighlight") {
                    selection.anchorNode.parentNode.className = "highlight";
                }
            }
        }
        
        function unhighlight() {
            var selection;
            if(window.getSelection) {
                selection = window.getSelection();
            } else if(typeof document.selection != "undefined") {
                selection = document.selection;
            }
            
            var range = selection.getRangeAt(0);
            if (range && !selection.isCollapsed) {
                if(selection.anchorNode.parentNode.className == "normalTxt") {
                    var span = document.createElement('span');
                    span.className = 'unhighlight';
                    span.id = 'high';
                    range.surroundContents(span);
                } else if(selection.anchorNode.parentNode.className == "highlight" || selection.anchorNode.parentNode.className == "unhighlight") {
                    selection.anchorNode.parentNode.className = "unhighlight";
                }
            }
        }
        
        const answeredQuestions = new Map();
        let numRequiredQAnswered = 0;
        var numOptionalQAnswered = 0;
        let scrollAmount = 0;

        function checkRequiredQuestions(){
            for(var question of discoveryQuestions){
                if(question.Visible && question.Required && !question.Answered){
                    return false;
                }
            }
            return true;
        }

        //keep track of required/optional questions answered
        function getNextBtn(field) {

            scrollAmount = scrollAmount + 250;
            if('{!requiredFields}'.includes(field)){
                if(undefined == answeredQuestions.get(field)){
                    numRequiredQAnswered ++;
                    answeredQuestions.set(field, field);
                } 
            } else {
                numOptionalQAnswered++;
            }

            if('{!numRequiredFields}' == numRequiredQAnswered){ 
                document.getElementById('thirdStart').removeAttribute('disabled');
                document.getElementById('thirdStart').style.opacity = "1";
                document.getElementById('errorMessage').style.display = "none";        
            }     

        }

        var beenPastReview = false;  
        
        function whatToDo() {
            console.log('whatToDo');
            // const foreQuali = document.querySelectorAll("[data-product='Foreign Qualification - LLC']");
            // var transactions = $('[data-id="transactions"]').val();

            var endNote = document.getElementById('endNote').innerHTML;
            var environment = "{!environment}";

            if(endNote == 'Review Business Discovery' && !beenPastReview) {
                console.log('reviewBusiDisc(true)');
                reviewBusiDisc(true);
            } else {
                document.getElementById('waitingScreen').style.display = "flex";
                
                var fn = (function(r,e) {
                    if(e.status) {
                        beenPastReview = true;      
                        //answerMap = new Map(Object.entries(e.result));              
                        CallApexMethod();
                        //updateBackBookkeeping();
                        //processProductData();
                        calculateTaxSavings();  
                        reviewBusiDisc(false);
                        
                        
                        //setTimeout(() => {
                            //updateBackBookkeeping();
                            document.getElementById('waitingScreen').style.display = "none";
                        //});
                        // if(billingFreqFromController){
                        //     calcFinance(billingFreqFromController, true);
                        //     document.getElementById('payTerms').value = billingFreqFromController;
                        // }
                        //currentPageIndex++;
                        
                    } else if(e.type === 'exception') {
                        alert(e.message);
                    } else {
                        alert(e.message);
                    }
                });
                console.log(bookkeepingStartDate);
                enableEditButton(false);
                //Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.saveAnswers', answers, businessId, accId, environment, fn);
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.saveAnswers', JSON.stringify(discoveryQuestions), businessId, accId, fn);
            }
        }

        function enableEditButton(enable){
            console.log('enableEditButton '+enable);
            var button = document.querySelectorAll('button#quoteEdit')[0];
            if(!button){return;}
            if(enable){
                button.removeAttribute('disabled');
                button.style.border = '1px solid #F15F22';
                button.style.setProperty('background-color','#F15F22');
            } else {
                button.style.border = '1px solid gray';
                button.style.setProperty('background-color','grey');
                button.setAttribute('disabled', 'disabled');
            }        
        }
        
        function reviewBusiDisc(flagReview) {
            //var currentProgress = getProgress();
            if(flagReview == true) {
                document.getElementById("menuOpts").options[4]?.removeAttribute('disabled'); 
                document.getElementById("menuOpts").value = "Discovery Questions";
                document.getElementById("discoveryQuestionTitle").innerHTML = "Review Business Discovery";
                //document.getElementById('engagee').style.display = "block";
                document.getElementById('busiDisc').innerHTML = "Discovery Questions";
                document.getElementById('businessDiscParts').scrollTop = 0;
                document.getElementById('endNote').innerHTML = "Proper Entity Structuring";
                document.getElementById('thirdStart').innerHTML = '<i class="fas fa-arrow-right" aria-hidden="true">&nbsp;</i>Submit Answers';
                document.getElementById("mainCategory").value = "Show All Questions";

                document.getElementById('mainCategoryDiv').style.background = "#F7F5F2";
                document.getElementById('mainCategoryDiv').style.border = "1px solid rgba(18, 23, 36, 0.2)";
                document.getElementById('mainCategoryDiv').style.borderRadius = "8px";
                document.querySelector('[data-id="mainCategory"]').style.marginTop = "20px";
                document.querySelector('[data-id="mainCategory"]').style.width = "92%";
                document.querySelector('[data-id="mainCategory"]').style.marginLeft = "20px";
                document.getElementById('showAllAnswer').style.display = "block";
                
                filterQuestions('Show All Questions');
                // var menuList = document.getElementById("menuOpts").options;
                // for (let i = 4; i < menuList.length; i++) {
                //     menuList[i].setAttribute("disabled", "disabled");
                // }
                currentProgress = Math.max(currentProgress, getProgress());


                // socket.connect();
                // content = {
                //     page: "Business Discovery Review",
                //     showProgress: true,
                //     progress: currentProgress
                // }
                // socket.emit("private message", {
                //     content
                // });
            } else {
                        
                if(isEditQuote){ //skip to Verify Info page
                    nextSection(29, 'Verify Information', 'businessDiscParts', 'verifyInformation');
                    var quoteEl = document.getElementsByClassName('quote')[0];                
                    quoteEl.style.display = "block"; 
                    var editEl = document.getElementsByClassName('editPackageButton')[0];
                    quoteEl.style.display = "flex"; 
                } else {
                    var filteredPages = getFilteredPageObjects();
                    currentPageIndex++;
                    var next = filteredPages[currentPageIndex];
                    currentProgress = Math.max(currentProgress, getProgress());

                    // while(next.entity && next.entity != entitySelected){
                    //     currentPageIndex++;
                    //     if(currentPageIndex >= filteredPages.length){ return; }
                    //     next = filteredPages[currentPageIndex];
                    // }
                    document.getElementById("menuOpts").value = "Proper Entity Structuring";
                    document.getElementById('businessDiscParts').style.display = "none";

                    if(entitySelected == 'LLC') {
                        document.getElementById('pesForLLC').style.display = "block";
                        document.getElementById('properEstityStrugleLLC').style.display = "block";

                    } else if(entitySelected == 'S Corporation') {
                        document.getElementById('pesForSCorp').style.display = "block";
                        document.getElementById('properEstityStrugleSCorp').style.display = "block";

                    }
                    
                    document.getElementById("menuOpts").options[5]?.removeAttribute('disabled');
                    
                    var quoteEl = document.getElementsByClassName('quote')[0];                
                    quoteEl.style.display = "block"; 
                    var editEl = document.getElementsByClassName('editPackageButton')[0];
                    quoteEl.style.display = "flex"; 
                    console.log(editEl); // editPackageButton
                    
                                
                    displayTablePlan('currentPlan', document.getElementById("tab2-1"), true);

                    socket.connect();

                    seenDefaults = true;

                    var menuList = document.getElementById("menuOpts").options;
                    for (let i = 1; i < menuList.length; i++) {
                        menuList[i].removeAttribute('disabled');
                    }

                    socket.connect();
                    if(entitySelected == 'LLC') {
                        content = {
                            page: "Proper Entity Structuring",
                            showProgress: true,
                            progress: currentProgress
                        }
                        socket.emit("private message", {
                            content
                        });
                    } else if(entitySelected == 'S Corporation') {
                        content = {
                            page: "Proper Entity Structuring SCorp",
                            showProgress: true,
                            progress: currentProgress
                        }
                        socket.emit("private message", {
                            content
                        });
                    }
                }
                
            }
        }

        function calculateTaxSavings() {
            //return;
            if(beenPastReview) {
                console.log('calculateTaxSavings');
                var entityType = $('[data-id="entity"]').val() || '';
                var profits = $('[data-id="profit"]').val() || '';
                var startup = $('[data-id="startup"]').val() || '';
                var mileage = $('[data-id="miles"]').val() || '';
                var office = $('[data-id="footage"]').val() || '';
                var filingStatus = $('[data-id="filingStatus"]').val() || '';
                var income = $('[data-id="household"]').val() || '';
                var industryType = $('[data-id="industry"]').val() || '';
                //var numForeignOwners = $('[data-id="foreignowners"]').val();
                //var eventId = '{!$CurrentPage.parameters.id}';
                //var recordId = '{!$CurrentPage.parameters.recordId}';
                //var tempSelectedProducts = JSON.parse('{!selectedProductsJson}');
                //var recordId = '{!$CurrentPage.parameters.recordId}';

                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.calculateSavingsGuidedSelling', accId,  function(r,e){
                    var dataResult = e.result;
                    const dataList = dataResult?.split(",");
                    //return;
                    var ece = parseFloat(dataList[0]);
                    var office = parseFloat(dataList[1]);
                    var mileage = parseFloat(dataList[2]);
                    var qbi = parseFloat(dataList[3]);
                    var startup = parseFloat(dataList[4]);
                    var final = parseFloat(dataList[5]);

                    ece = ece.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    office = office.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    mileage = mileage.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    qbi = qbi.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    startup = startup.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    final = final.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
                    
                    socket.connect();
                    content = {
                        savings: final, 
                        ece: ece, 
                        office: office, 
                        mileage: mileage, 
                        qbi: qbi, 
                        startup: startup
                    }
                    socket.emit("private message", {
                        content
                    });
                });
                document.getElementById('startUpAmount').innerHTML = '$' + startup?.replace(/\d(?=(\d{3})+\.)/g, '$&,');
            }
        }

        function debugProductLists(){
            console.log('debugProductLists()');
            console.log(tempSelectedProducts);
            console.log('{!selectedProductsJson}');
            return '{!selectedProductsJson}';
        }

        //to-do: update all of this
        function updateBookkeeping(){
            console.log('updateBookkeeping '+bookkeepingStartDate+', '+bookkeepingEndDate);
            // if(useStaticPackage){
            //     console.log('static package; ignoring bookkeeping')
            //     return;
            // }
            var months = 0;
            if(bookkeepingStartDate){
                months = monthDifference(bookkeepingStartDate, bookkeepingEndDate);
            } else {
                console.log('no start date found');
            }
            
            //var nonProfit = false; //placeholder for account value
            var hasTransactions = transactionCount != null;
            //add in the bookkeeping products
            // var transactions = $('[data-id="transactions"]').val();
            // var bookkeepingDate = $('[data-id="bookkeepingStart"]').val();
            enableProduct('Non-Profit Back Bookkeeping', false);
            enableProduct('Back Bookkeeping', false);
            console.log('months: '+months);
            if(hasTransactions && bookkeepingStartDate){ //enable and add products
                if(nonProfit){
                    addRemoveProduct(null, true, 'Non-Profit Bookkeeping');
                    if(months > 0){
                        calcQuantityChange({value: months}, 'Non-Profit Back Bookkeeping');
                        addRemoveProduct(null, true, 'Non-Profit Back Bookkeeping');
                    }
                    enableProduct('Non-Profit Bookkeeping', true); //nonprofit bookkeeping
                    enableProduct('Dedicated Bookkeeping', false);
                } else {
                    addRemoveProduct(null, true, 'Dedicated Bookkeeping');
                    if(months > 0){
                        calcQuantityChange({value: months}, 'Back Bookkeeping');
                        addRemoveProduct(null, true, 'Back Bookkeeping');
                    }
                    enableProduct('Dedicated Bookkeeping', true); //regular bookkeeping
                    enableProduct('Non-Profit Bookkeeping', false);
                }
            } else { //disable and remove products
                if(nonProfit){
                    addRemoveProduct(null, false, 'Non-Profit Bookkeeping');
                    calcQuantityChange(1, 'Non-Profit Back Bookkeeping'); //probably not necessary
                    addRemoveProduct(null, false, 'Non-Profit Back Bookkeeping');
                    enableProduct('Non-Profit Bookkeeping', false); //nonprofit bookkeeping
                    enableProduct('Dedicated Bookkeeping', false);
                } else {
                    addRemoveProduct(null, false, 'Dedicated Bookkeeping');
                    calcQuantityChange(1, 'Back Bookkeeping'); //probably not necessary
                    addRemoveProduct(null, false, 'Back Bookkeeping');
                    enableProduct('Dedicated Bookkeeping', false); //regular bookkeeping
                    enableProduct('Non-Profit Bookkeeping', false);
                }
            }
            // if(months > 0 && nonProfit){
            //     const nonProfBackBookkQTYList = document.querySelectorAll("[data-product-qty='Non-Profit Back Bookkeeping']");
            //     for (let l = 0; l < nonProfBackBookkQTYList.length; l++) {
            //         nonProfBackBookkQTYList[l].value = months;
            //         calcQuantityChange(nonProfBackBookkQTYList[l], 'Back Bookkeeping', '');
            //     }
            // } else if (months > 0 && !nonProfit) {
            //     const backBookkQTYList = document.querySelectorAll("[data-product-qty='Back Bookkeeping']");
            //     for (let l = 0; l < backBookkQTYList.length; l++) {
            //         backBookkQTYList[l].value = months;
            //         calcQuantityChange(backBookkQTYList[l], 'Back Bookkeeping', '');
            //     }
            // }
            //rerenderProducts();
        }

        function refreshProducts(){
            rerenderProducts();
        }

        function showQuestion(questionLabel, show, toggle){
            //console.log('show '+questionLabel+' '+show);
            var question = questionLabelToQuestionMap.get(questionLabel);
            if(question){
                question.Visible = show;
                if(toggle){ question.CanBeVisible = show; }
            }
            var questionRow = document.getElementById(questionLabelToQuestionMap.get(questionLabel)?.DevName+'row');
            if(questionRow){
                questionRow.style.display = (show ? 'table-row' : 'none');
            }
        }
        
        //function populateAnswer(question, answer, picklist, skipSync) {
        function populateAnswer(questionDevName, answer, questionType, skipSync, hidePage) {
            console.log('populateAnswer '+[...arguments]);
            var checked = answer.checked;
            var question = questionNameToQuestionMap.get(questionDevName);
            if(!question) {return;}
            if (question.isPicklist || questionType == 'Date') {
                answer = answer.value;
            } else if(questionType == 'Boolean'){
                answer = (answer.className == 'yesBtn' ? 'Yes' : 'No');
            }
            console.log(questionDevName+': '+answer+' '+typeof(answer));

            if(questionType == 'Multi Selection'){
                if(answer == 'None' && checked){
                    //if 'none' selected, deselect all the other options
                    for(var box of document.querySelectorAll('[data-id='+questionDevName+'question] input').values().filter(x => x.value != 'None' && x.checked)){
                        box.checked = false;
                        populateAnswer(questionDevName, box, 'Multi Selection');
                    }
                } else if (answer != 'None' && checked){
                    //if another answer is selected, deselect 'none'
                    for(var box of document.querySelectorAll('[data-id='+questionDevName+'question] input').values().filter(x => x.value == 'None' && x.checked)){
                        box.checked = false;
                        populateAnswer(questionDevName, box, 'Multi Selection');
                    }                
                }
                var childLabelString = question.ChildQuestionLabel;
                if(childLabelString){
                    var childLabelMap = new Map(childLabelString.split(';').map(x => x.split(':')));
                    if(childLabelMap.has(answer) && questionLabelToQuestionMap.has(childLabelMap.get(answer))){
                        showQuestion(childLabelMap.get(answer), checked, true);
                    }
                }

                if(question.Value?.includes(answer) && !checked){
                    answer = question.Value.replace(answer+';','').replace(answer,'');
                } else if(question.Value && checked && !question.Value?.includes(answer)){
                    answer = question.Value+';'+answer;
                }

                if(answer == '' || answer == null){
                    question.Value = null;
                    question.Answered = false;
                } else {
                    question.Value = answer;
                    question.Answered = true;
                }
                
                
            } else {
                question.Value = answer;
                question.Answered = true;
            }
            
            console.log(question.Value);
            
            var saveQuestion = false;
            var questionNumber = "";
            var childLabelString = question.ChildQuestionLabel;
            if(childLabelString){
                for(childLabel of childLabelString.split(';')){
                    var childQuestion = questionLabelToQuestionMap.get(childLabel);
                        
                    if(childQuestion && questionType == 'Boolean' && answer == 'No' && document.querySelector('[data-id= '+childQuestion.DevName+'question]')?.options.item(1)?.value == '0'){
                        document.querySelector('[data-id= '+childQuestion.DevName+'question]').value = '0';
                        populateAnswer(childQuestion.DevName, {value: '0'}, 'Single Selection');
                        showQuestion(childLabel, false, true);
                    } else if(childQuestion){
                        showQuestion(childLabel, true, true);
                    }
                }
            }
            

            //removeRequiredFieldAnswered(question);
            //setYesNoFields(question, answer);

            if(null == textToQuestion.get(question.QuestionText)){
                var saveQuestion = true;
            } else {
                questionNumber = textToQuestion.get(question.QuestionText);
            }
            
            if(checkRequiredQuestions()){
                document.getElementById('thirdStart').removeAttribute('disabled');
                document.getElementById('thirdStart').style.opacity = "1";
                document.getElementById('errorMessage').style.display = "none";
            } else {
                document.getElementById('thirdStart').setAttribute("disabled", "disabled");
                document.getElementById('thirdStart').style.opacity = "0.25";
                document.getElementById('errorMessage').style.display = "flex"; 
            }

            calculateTaxSavings();
            //linkedYesNo()? //sets value and required status of child questions
            //linkedFields()? //sets value and updates style of parent question button
            //YesDecision()/NoDecision()? //updates styling of selected yes/no button
            //var numRequiredQuestions = parseInt('{!numRequiredFields}') + parseInt(numOptionalQAnswered);
            
            
            if(skipSync == true){
            } else {
                socket.connect();
                content = {
                    page: "Business Discovery Parts",
                    question: questionNumber,
                    answer: answer,
                    save: saveQuestion,
                    questionText: question.QuestionText,
                    hidePage: hidePage
                }
                console.log(content);
                socket.emit("private message", {
                content
                });
            }       

            
            if (question.DevName == 'Bookkeeping_Transactions'){
                transactionCount = answer.toString();
            } else if(question.DevName == 'Bookkeeping_Start_Date'){
                bookkeepingStartDate = answer.toString();
                document.querySelector("[data-id='Bookkeeping_End_Datequestion']").min = answer.toString();
            } else if(question.DevName == 'Bookkeeping_End_Date'){
                bookkeepingEndDate = answer.toString();                
            } else if(question.DevName == 'Entity_Type'){
                updateEntity({value: answer});
            } else if(question.DevName == 'Additional_Employees'){
                numberOfEmployeeContractors = answer.toString();
            }

            //filling up the map with the answers 
            if(answers != null && answers != '') {
                answers = answers + '///' + question + '' + answer;
            } else {
                answers = question + '' + answer;
            }
        }

        var formationDate;
        function getDaysSinceFormation(){
            if(formationDate){
                var startDate = parseDate(formationDate).valueOf();
                var today = new Date().valueOf();
                var msDifference = today - startDate;
                return Math.floor(msDifference / (1000*60*60*24));
            } else {
                return null;
            }
        }
        function saveFormationDate(answer){
            console.log('saveFormationDate '+answer);
            if(answer == '' || !answer){
                return;
            }
            formationDate = answer?.value.toString();

            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.updateRegistrationDate', '{!opportunity.AccountId}', parseDate(formationDate).toUTCString(), (x) => console.log(x));

            //display the days since formation on relevant pages
            for(var textElement of document.getElementsByClassName('businessFormationAlert')){
                    textElement.style.display = 'inline-flex';
            }
            for(var textElement of document.getElementsByClassName('businessFormationAlertText')){
                    textElement.innerText = 'The clients business was formed '+getDaysSinceFormation()+' days ago.';
            }

          
        }

        function disableFrequency(disable, prodId){
            var product = finalProductsMap.get(prodId);

            product.frequencyEnabled = !disable;
            if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).frequencyEnabled = !disable; }

            var opacity = disable ? '0.55' : '1';
            var cursor = disable ? 'not-allowed' : '';

            var monthlyOnes = document.querySelectorAll('label[for="'+prodId+'monthly"]');
            var yearlyOnes = document.querySelectorAll('label[for="'+prodId+'yearly"]');
            for(var r = 0; r < monthlyOnes.length; r++) {
                monthlyOnes[r].style.opacity = opacity;
                monthlyOnes[r].style.cursor = cursor;
                yearlyOnes[r].style.opacity = opacity;
                yearlyOnes[r].style.cursor = cursor;
            }
        }
                
        function showSlideOne(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticalSectLine1').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currentSlide1').innerHTML = "Current Slide";
                document.getElementById('currentSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide1').style.color = "black";
                document.getElementById('currentSlide1').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticalSectLine1').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currentSlide1').innerHTML = "Show Slide";
                document.getElementById('currentSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide1').style.color = "#1776B6";
                document.getElementById('currentSlide1').style.background = "white";
            }
        }
                
        function showSlideTwo(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticalSectLine2').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currentSlide2').innerHTML = "Current Slide";
                document.getElementById('currentSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide2').style.color = "black";
                document.getElementById('currentSlide2').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticalSectLine2').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currentSlide2').innerHTML = "Show Slide";
                document.getElementById('currentSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide2').style.color = "#1776B6";
                document.getElementById('currentSlide2').style.background = "white";
            }
        }
                
        function showSlideThree(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticalSectLine3').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currentSlide3').innerHTML = "Current Slide";
                document.getElementById('currentSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide3').style.color = "black";
                document.getElementById('currentSlide3').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticalSectLine3').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currentSlide3').innerHTML = '<i class="fas fa-arrow-right">&nbsp;</i>Next Section';
                document.getElementById('currentSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currentSlide3').style.color = "#1776B6";
                document.getElementById('currentSlide3').style.background = "white";
            }
        }
                
        function getSlideOne() {
            var currentProgress = getProgress();
            socket.connect();
            if(entitySelected == 'LLC') {
                content = {
                    page: "Self-Employment Tax (FICA) LLC",
                    showProgress: true,
                    progress: currentProgress
                }
                socket.emit("private message", {
                    content
                });
            } else if(entitySelected == 'S Corporation') {
                content = {
                    page: "Self-Employment Tax (FICA) S Corp",
                    showProgress: true,
                    progress: currentProgress
                }
                socket.emit("private message", {
                    content
                });
            }
            
            document.getElementById('ficaBtns').style.display = "block";
            document.getElementById('verticalSectLine3').style.display = "none";
            document.getElementById('verticalSectLine2').style.display = "none";
            document.getElementById('FICA-Example').style.display = "none";
            document.getElementById('btn-fica').style.display = "none";

            showSlideOne(true);
            showSlideTwo(false);
            showSlideThree(false);
        }
                
        function getSlideTwo() {
            showSlideOne(false);
            showSlideTwo(true);
            showSlideThree(false);
            
            document.getElementById('verticalSectLine2').style.display = "block";
            document.getElementById('verticalSectLine3').style.display = "block";
            document.getElementById('FICA-Example').style.display = "block";
            document.getElementById('btn-fica').style.display = "none";
            document.getElementById('Tax-Savings').style.display = "none";
            document.getElementById('currentSlide3').style.border = "1px solid #F15F22";
            document.getElementById('currentSlide3').style.color = "white";
            document.getElementById('currentSlide3').style.background = "#F15F22";
                
            socket.connect();
                content = {
                page: "(FICA) IRS"
            }
            socket.emit("private message", {
                content
            });
        }
        
        function getSlideThree() {
            showSlideOne(false);
            showSlideTwo(false);
            showSlideThree(true);
            
            document.getElementById('Tax-Savings').style.display = "block";
            document.getElementById('btn-fica').style.display = "block";
            
            scrollToDiv('#additionalFirstName7', '#selfEmploymentTaxLLC', 550);

            socket.connect();
            content = {
                page: "(FICA) Savings structured efficiently"
            }
            socket.emit("private message", {
                content
            });
        }
                
        const questionToText = new Map();
        const textToQuestion = new Map();

        const questionToProduct = new Map();
        const productToQuestion = new Map();

        function hideQuestionFromClient(showBoolean, questionText, dependentFields){
            console.log('hideQuestionFromClient ' + showBoolean + ' '+questionText);
            var questionNumber;
            //If we are showing the question
            if(true == showBoolean){
                for(var i = 1; i < 31; i++) {
                    if(null == questionToText.get(i)){
                        questionNumber = i;
                        questionToText.set(i, questionText);
                        textToQuestion.set(questionText, i);
                        break;
                    }
                }

                socket.connect();
                content = {
                    page: "Business Discovery Parts",
                    hide: "false",
                    answer: "",
                    question: questionNumber,
                    questionText: questionText
                }
                socket.emit("private message", {
                    content
                });
            } else {
                var questionNumber = textToQuestion.get(questionText);
                if(!dependentFields){
                    questionToText.delete(questionNumber);
                    textToQuestion.delete(questionText);
                }
                
                socket.connect();
                content = {
                    page: "Business Discovery Parts",
                    hide: "true",
                    question: questionNumber,
                    answer: "",
                    questionText: questionText
                }
                socket.emit("private message", {
                    content
                });
            }
        }
                
        function validateButtons() {
            return;
            var isTrue = document.getElementById('understands').checked;
                
            if (isTrue == true) {
                document.getElementById('medicalbtn').style.opacity = "1";
                document.getElementById('vehiclebtn').style.opacity = "1";
                document.getElementById('officebtn').style.opacity = "1";
                document.getElementById('199Abtn').style.opacity = "1";
                document.getElementById('medicalbtn').removeAttribute('disabled');
                document.getElementById('vehiclebtn').removeAttribute('disabled');
                document.getElementById('officebtn').removeAttribute('disabled');
                document.getElementById('199Abtn').removeAttribute('disabled');
            } else {
                document.getElementById('medicalbtn').style.opacity = "0.25";
                document.getElementById('vehiclebtn').style.opacity = "0.25";
                document.getElementById('officebtn').style.opacity = "0.25";
                document.getElementById('199Abtn').style.opacity = "0.25";
                document.getElementById('medicalbtn').setAttribute('disabled', 'disabled');
                document.getElementById('vehiclebtn').setAttribute('disabled', 'disabled');
                document.getElementById('officebtn').setAttribute('disabled', 'disabled');
                document.getElementById('199Abtn').setAttribute('disabled', 'disabled');
            }
        }
                
        function showDeductBtns() {
            return;
            var isTrueMed = document.getElementById('understandsMed').checked;
            var isTrueVeh = document.getElementById('understandsVeh').checked;
            var isTrueOff = document.getElementById('understandsHome').checked;
            var isTrue199A = document.getElementById('understandsCode').checked;
            document.getElementById('vehiclebtnWhite1').style.opacity = "1";
            document.getElementById('officebtnWhite1').style.opacity = "1";
            document.getElementById('199AbtnWhite1').style.opacity = "1";
            document.getElementById('vehiclebtnWhite1').removeAttribute('disabled');
            document.getElementById('officebtnWhite1').removeAttribute('disabled');
            document.getElementById('199AbtnWhite1').removeAttribute('disabled');
            
            if(isTrueMed){
                document.getElementById('reviewDeductionNext1').style.opacity = "1";
                document.getElementById('reviewDeductionNext1').removeAttribute('disabled');
            } else {
                document.getElementById('reviewDeductionNext1').style.opacity = "0.25";
                document.getElementById('reviewDeductionNext1').setAttribute('disabled', 'disabled');
            }

            if(isTrueVeh){
                document.getElementById('reviewDeductionNext2').style.opacity = "1";
                document.getElementById('reviewDeductionNext2').removeAttribute('disabled');
            } else {
                document.getElementById('reviewDeductionNext2').style.opacity = "0.25";
                document.getElementById('reviewDeductionNext2').setAttribute('disabled', 'disabled');
            }

            if(isTrueOff){
                document.getElementById('reviewDeductionNext3').style.opacity = "1";
                document.getElementById('reviewDeductionNext3').removeAttribute('disabled');
            } else {
                document.getElementById('reviewDeductionNext3').style.opacity = "0.25";
                document.getElementById('reviewDeductionNext3').setAttribute('disabled', 'disabled');
            }

            if(isTrue199A){
                document.getElementById('reviewDeductionNext4').style.opacity = "1";
                document.getElementById('reviewDeductionNext4').removeAttribute('disabled');
            } else {
                document.getElementById('reviewDeductionNext4').style.opacity = "0.25";
                document.getElementById('reviewDeductionNext4').setAttribute('disabled', 'disabled');
            }
        }

        function smsConsent(el){
            console.log(this.value);
        }
        
        function showSli1(isVisible) {
            if(isVisible == true) {
                document.getElementById('vertSectLine1').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currtSlide1').innerHTML = "Current Slide";
                document.getElementById('currtSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide1').style.color = "black";
                document.getElementById('currtSlide1').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('vertSectLine1').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide1').innerHTML = '<i class="fas fa-arrow-right">&nbsp;</i>Next Section';
                document.getElementById('currtSlide1').style.border = "1px solid #F15F22;";
                document.getElementById('currtSlide1').style.color = "white";
                document.getElementById('currtSlide1').style.background = "#F15F22";
            } else {
                document.getElementById('vertSectLine1').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide1').innerHTML = "Show Slide";
                document.getElementById('currtSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide1').style.color = "#1776B6";
                document.getElementById('currtSlide1').style.background = "white";
            }
        }
                
        function showSli2(isVisible) {
            if(isVisible == true) {
                document.getElementById('vertSectLine2').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currtSlide2').innerHTML = "Current Slide";
                document.getElementById('currtSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide2').style.color = "black";
                document.getElementById('currtSlide2').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('vertSectLine2').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide2').innerHTML = '<i class="fas fa-arrow-right">&nbsp;</i>Next Section';
                document.getElementById('currtSlide2').style.border = "1px solid #F15F22;";
                document.getElementById('currtSlide2').style.color = "white";
                document.getElementById('currtSlide2').style.background = "#F15F22";
            } else {
                document.getElementById('vertSectLine2').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide2').innerHTML = "Show Slide";
                document.getElementById('currtSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide2').style.color = "#1776B6";
                document.getElementById('currtSlide2').style.background = "white";
            }
        }

        function showSli3(isVisible) {
            if(isVisible == true) {
                document.getElementById('vertSectLine3').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currtSlide3').innerHTML = "Current Slide";
                document.getElementById('currtSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide3').style.color = "black";
                document.getElementById('currtSlide3').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('vertSectLine3').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide3').innerHTML = '<i class="fas fa-arrow-right">&nbsp;</i>Next Section';
                document.getElementById('currtSlide3').style.border = "1px solid #F15F22;";
                document.getElementById('currtSlide3').style.color = "white";
                document.getElementById('currtSlide3').style.background = "#F15F22";
            } else {
                document.getElementById('vertSectLine3').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currtSlide3').innerHTML = "Show Slide";
                document.getElementById('currtSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currtSlide3').style.color = "#1776B6";
                document.getElementById('currtSlide3').style.background = "white";
            }
        }
        
        function getSecOne() {
            showSli1(true);
            showSli2(false);
            showSli3(false);
                    
            document.getElementById('PaperlossFormula').style.display = "none";
            document.getElementById('vertSectLine3').style.display = "none";
            document.getElementById('btn-paperloss').style.display = "none";
                    
            socket.connect();
            content = {
                page: "Paper Loss"
            }
            socket.emit("private message", {
                content
            });
        }
                
        function getSecTwo() {
            showSli1(null);
            showSli2(true);
            showSli3(false);
            
            document.getElementById('PaperlossFormula').style.display = "block";
            document.getElementById('vertSectLine3').style.display = "block";
            document.getElementById('PaperlossExample').style.display = "none";
            document.getElementById('btn-paperloss').style.display = "none";
            
            scrollToDiv('#vertSectLine3', '#paperloss', 500);

            socket.connect();
            content = {
                page: "Paper Loss Formula"
            }
            socket.emit("private message", {
                content
            });
        }
                
        function getSecThree() {
            showSli1(null);
            showSli2(null);
            showSli3(true);
            
            document.getElementById('PaperlossExample').style.display = "block";
            document.getElementById('btn-paperloss').style.display = "block";
            
            var height = window.innerHeight; 
            var menuheight = document.getElementById('menuBody').offsetHeight;
            var scrollValue = height - menuheight;
            if(height > 800) {
                scrollValue = scrollValue - 350;
            } else {
                scrollValue = scrollValue + 500;
            }
            
            scrollToDiv('#vertSectLine3', '#paperloss', scrollValue);

            socket.connect();
            content = {
                page: "Paper Loss Example"
            }
            socket.emit("private message", {
                content
            });
        }

        const allIds = [
        "firstBusiness",
        //"years",
        "entity",
        "industry",
        "domState",
        "foreignState",
        //"state",
        "startup",
        "revenue",
        "profit",
        //"investor",
        "household",
        //"foreignIncome",
        "transactions",
        "bookkeepingStart",
        "bookkeepingEnd",
        "hasRentals",
        "rental",
        //"k1s",
        "owners",
        //"foreignOwners",
        "runPayroll",
        "hasEmpContractors",
        "employees",
        //"contractors",
        "filingStatus",
        "workingHome",
        "footage",
        "drive",
        "miles",
        //"website"
        ];

        const years = [
        "firstBusiness",
        //"years"
        ];

        const entityIndustry = [
        "entity",
        "industry"
        ];

        const state = [
        "domState",
        //"foreignState",
        //"state"
        ];

        const businessIncome = [
        "startup",
        "revenue",
        "profit",
        //"investor"
        ];

        const bookkeeping = [
        "transactions",
        "bookkeepingStart",
        "bookkeepingEnd"
        ];

        const owners = [
        "owners",
        //"foreignOwners"
        ];

        const payroll = [
        "runPayroll",
        "hasEmpContractors",
        "employees",
        //"contractors"
        ];

        const filing = [
        "filingStatus"
        ];

        const personalIncome = [
        "household",
        "hasRentals",
        "rental",
        //"foreignIncome",
        //"k1s"
        ];

        const deductions = [
        "workingHome",
        "footage",
        "drive",
        "miles",
        //"website"
        ];

        const requiredFields = [];
        const requiredUnasweredFields = [];

        function setRequiredUnasweredFields() {

            if('{!requiredFields}'.includes('First Business')) {
                requiredUnasweredFields.push("firstBusiness");
            }
            if('{!requiredFields}'.includes('Years In Business')) {
                requiredUnasweredFields.push("years");
            }
            if('{!requiredFields}'.includes('Entity Type')) {
                requiredUnasweredFields.push("entity");
            }
            if('{!requiredFields}'.includes('Industry Type')) {
                requiredUnasweredFields.push("industry");
            }
            if('{!requiredFields}'.includes('State of Incorporation')) {
                requiredUnasweredFields.push("domState");
            }
            if('{!requiredFields}'.includes('Foreign State')) {
                requiredUnasweredFields.push("foreignState");
            }
            // if('{requiredFields}'.includes('State of Residence')) {
            //     requiredUnasweredFields.push("state");
            // }
            if('{!requiredFields}'.includes('Total Startup Cost')) {
                requiredUnasweredFields.push("startup");
            }
            if('{!requiredFields}'.includes('Projected 1st Year Revenue')) {
                requiredUnasweredFields.push("revenue");
            }
            if('{!requiredFields}'.includes('Projected 1st Year Profit')) {
                requiredUnasweredFields.push("profit");
            }
            // if('{requiredFields}'.includes('Investor Funding')) {
            //     requiredUnasweredFields.push("investor");
            // }
            if('{!requiredFields}'.includes('Number of Transactions')) {
                requiredUnasweredFields.push("transactions");
            }
            if('{!requiredFields}'.includes('Number of Owners')) {
                requiredUnasweredFields.push("owners");
            }
            // if('{requiredFields}'.includes('Foreign Owners')) {
            //     requiredUnasweredFields.push("foreignOwners");
            // }
            if('{!requiredFields}'.includes('Run Payroll Before')) {
                requiredUnasweredFields.push("runPayroll");
            }
            if('{!requiredFields}'.includes('Number of Employees')) {
                requiredUnasweredFields.push("hasEmpContractors");
                requiredUnasweredFields.push("employees");
            }
            // if('{requiredFields}'.includes('Number of Contractors')) {
            //     requiredUnasweredFields.push("contractors");
            // }
            if('{!requiredFields}'.includes('Filing Status')) {
                requiredUnasweredFields.push("filingStatus");
            }
            if('{!requiredFields}'.includes('Personal Income')) {
                requiredUnasweredFields.push("household");
            }
            // if('{requiredFields}'.includes('Foreign Income')) {
            //     requiredUnasweredFields.push("foreignIncome");
            // }
            if('{!requiredFields}'.includes('Number of Rental Properties')) {
                requiredUnasweredFields.push("hasRentals");
                requiredUnasweredFields.push("rental");
            }
            // if('{requiredFields}'.includes('Number of K1s')) {
            //     requiredUnasweredFields.push("k1s");
            // }
            if('{!requiredFields}'.includes('Office Square Footage')) {
                requiredUnasweredFields.push("workingHome");
                requiredUnasweredFields.push("footage");
            }
            if('{!requiredFields}'.includes('Business Miles')) {
                requiredUnasweredFields.push("drive");
                requiredUnasweredFields.push("miles");
            }
            if('{!requiredFields}'.includes('Website Selling Goods')) {
                requiredUnasweredFields.push("website");
            }
        }

        function removeRequiredFieldAnswered(question) {
            var index = 0;

            if('Is this your first business?' == question) {
                index = requiredUnasweredFields.indexOf('firstBusiness');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('How many years have you been in business?' == question) {
                index = requiredUnasweredFields.indexOf('years');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What entity type is your business?' == question) {
                index = requiredUnasweredFields.indexOf('entity');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What industry is your business in?' == question) {
                index = requiredUnasweredFields.indexOf('industry');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What is your state of incorporation?' == question) {
                index = requiredUnasweredFields.indexOf('domState');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What is your foreign state of incorporation?' == question) {
                index = requiredUnasweredFields.indexOf('foreignState');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('What is your state of residence?' == question) {
            //     index = requiredUnasweredFields.indexOf('state');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('How much have you invested so far in start-up costs?' == question) {
                index = requiredUnasweredFields.indexOf('startup');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What do you anticipate your revenue to be over the next 12 months?' == question) {
                index = requiredUnasweredFields.indexOf('revenue');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What do you project your 1st year profit to be over the next 12 months?' == question) {
                index = requiredUnasweredFields.indexOf('profit');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('What is your total investor funding?' == question) {
            //     index = requiredUnasweredFields.indexOf('investor');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('How many monthly bookkeeping transactions do you have?' == question) {
                index = requiredUnasweredFields.indexOf('transactions');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('How many owners does your business have?' == question) {
                index = requiredUnasweredFields.indexOf('owners');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('How many owners are outside the USA?' == question) {
            //     index = requiredUnasweredFields.indexOf('foreignOwners');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('How many employees do you have?' == question) {
                index = requiredUnasweredFields.indexOf('employees');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('How many contractors do you have?' == question) {
            //     index = requiredUnasweredFields.indexOf('contractors');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('What is your tax filing status?' == question) {
                index = requiredUnasweredFields.indexOf('filingStatus');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('What was your household W-2 income last year?' == question) {
                index = requiredUnasweredFields.indexOf('household');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('How many rental properties do you have?' == question) {
                index = requiredUnasweredFields.indexOf('rental');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('How many K-1s are from other investments?' == question) {
            //     index = requiredUnasweredFields.indexOf('k1s');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('What is the approximate square footage of your home office?' == question) {
                index = requiredUnasweredFields.indexOf('footage');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('How many business-related miles do you estimate youll drive per year?' == question) {
                index = requiredUnasweredFields.indexOf('miles');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('Have you run payroll before?' == question) {
                index = requiredUnasweredFields.indexOf('runPayroll');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('Do you currently have any employees?' == question) {
                index = requiredUnasweredFields.indexOf('hasEmpContractors');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('Do you have any foreign sourced income?' == question) {
            //     index = requiredUnasweredFields.indexOf('foreignIncome');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
            if('Do you currently have any rental properties?' == question) {
                index = requiredUnasweredFields.indexOf('hasRentals');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('Will you be working from home?' == question) {
                index = requiredUnasweredFields.indexOf('workingHome');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            if('Will you use your personal vehicle for business purposes?' == question) {
                index = requiredUnasweredFields.indexOf('drive');
                if (index > -1) {
                    requiredUnasweredFields.splice(index, 1);
                }
            }
            // if('Will your business have a web or e-commerce presence?' == question) {
            //     index = requiredUnasweredFields.indexOf('website');
            //     if (index > -1) {
            //         requiredUnasweredFields.splice(index, 1);
            //     }
            // }
        }

        //remove questions from required list based on other answers
        function setYesNoFields(question, answer) {

            if('Is this your first business?' == question) {
                index = requiredUnasweredFields.indexOf('firstBusiness');
                if(answer == 'Yes') {
                    if (index > -1) {
                        requiredUnasweredFields.splice(index, 1);
                    }
                } else {
                    requiredFields.push("firstBusiness");
                }
            } else if('Do you currently have any employees?' == question) {
                index = requiredUnasweredFields.indexOf('hasEmpContractors');
                if(answer == 'Yes') {
                    if (index > -1) {
                        requiredUnasweredFields.splice(index, 1);
                    }
                } else {
                    requiredFields.push("hasEmpContractors");
                }
            } else if('Do you currently have any rental properties?' == question) {
                index = requiredUnasweredFields.indexOf('hasRentals');
                if(answer == 'Yes') {
                    if (index > -1) {
                        requiredUnasweredFields.splice(index, 1);
                    }
                } else {
                    requiredFields.push("hasRentals");
                }
            } else if('Will you be working from home?' == question) {
                index = requiredUnasweredFields.indexOf('workingHome');
                if(answer == 'Yes') {
                    if (index > -1) {
                        requiredUnasweredFields.splice(index, 1);
                    }
                } else {
                    requiredFields.push("workingHome");
                }
            } else if('Will you use your personal vehicle for business purposes?' == question) {
                index = requiredUnasweredFields.indexOf('drive');
                if(answer == 'Yes') {
                    if (index > -1) {
                        requiredUnasweredFields.splice(index, 1);
                    }
                } else {
                    requiredFields.push("drive");
                }
            }
        }

        function setRequiredFields() {

            if('{!requiredFields}'.includes('First Business')) {
                requiredFields.push("firstBusiness");
            }
            if('{!requiredFields}'.includes('Years In Business')) {
                requiredFields.push("years");
            }
            if('{!requiredFields}'.includes('Entity Type')) {
                requiredFields.push("entity");
            }
            if('{!requiredFields}'.includes('Industry Type')) {
                requiredFields.push("industry");
            }
            if('{!requiredFields}'.includes('State of Incorporation')) {
                requiredFields.push("domState");
            }
            if('{!requiredFields}'.includes('Foreign State')) {
                requiredFields.push("foreignState");
            }
            // if('{requiredFields}'.includes('State of Residence')) {
            //     requiredFields.push("state");
            // }
            if('{!requiredFields}'.includes('Total Startup Cost')) {
                requiredFields.push("startup");
            }
            if('{!requiredFields}'.includes('Projected 1st Year Revenue')) {
                requiredFields.push("revenue");
            }
            if('{!requiredFields}'.includes('Projected 1st Year Profit')) {
                requiredFields.push("profit");
            }
            // if('{requiredFields}'.includes('Investor Funding')) {
            //     requiredFields.push("investor");
            // }
            if('{!requiredFields}'.includes('Number of Transactions')) {
                requiredFields.push("transactions");
            }
            if('{!requiredFields}'.includes('Number of Owners')) {
                requiredFields.push("owners");
            }
            // if('{requiredFields}'.includes('Foreign Owners')) {
            //     requiredFields.push("foreignOwners");
            // }
            if('{!requiredFields}'.includes('Run Payroll Before')) {
                requiredFields.push("runPayroll");
            }
            if('{!requiredFields}'.includes('Number of Employees')) {
                requiredFields.push("hasEmpContractors");
                requiredFields.push("employees");
            }
            // if('{requiredFields}'.includes('Number of Contractors')) {
            //     requiredFields.push("contractors");
            // }
            if('{!requiredFields}'.includes('Filing Status')) {
                requiredFields.push("filingStatus");
            }
            if('{!requiredFields}'.includes('Personal Income')) {
                requiredFields.push("household");
            }
            // if('{requiredFields}'.includes('Foreign Income')) {
            //     requiredFields.push("foreignIncome");
            // }
            if('{!requiredFields}'.includes('Number of Rental Properties')) {
                requiredFields.push("hasRentals");
                requiredFields.push("rental");
            }
            // if('{requiredFields}'.includes('Number of K1s')) {
            //     requiredFields.push("k1s");
            // }
            if('{!requiredFields}'.includes('Office Square Footage')) {
                requiredFields.push("workingHome");
                requiredFields.push("footage");
            }
            if('{!requiredFields}'.includes('Business Miles')) {
                requiredFields.push("drive");
                requiredFields.push("miles");
            }
            if('{!requiredFields}'.includes('Website Selling Goods')) {
                requiredFields.push("website");
            }

            setYesNoFields();
        }

        function filterQuestions(value) {
            console.log('filterQuestions '+value);
            
            for(var question of discoveryQuestions.filter(x => x.CanBeVisible)){
                var show = false;
                if(value == 'Show All Questions'){
                    show = true;
                } else if(value == 'Required Questions' &&  question.Required == true){
                    show = true;
                } else if(value == 'Unanswered Required Questions' &&  question.Required == true && question.Answered == false){
                    show = true;
                } else if(value != null && question.FilterTags != null && question.FilterTags.includes(value)){
                    show = true;
                }
                showQuestion(question.Label, show, false);
                //document.getElementById(question.DevName+'row').style.display = (showQuestion ? 'table-row' : 'none');
            }
            return; 
        }

        //sets value and updates style of parent question button
        function linkedFields(value){
            switch (value) {
                case 'Employees and Contractors':
                var employees = $('[data-id="employees"]').val();
                //var contractors = $('[data-id="contractors"]').val();


                if("white" != document.getElementById('yesBtn1.3').style.color){
                    if(0 != employees){
                        YesDecision(1.3);
                        populateAnswer('Do you currently have any employees?', 'Yes', false);
                    }
                }
                break;

                case 'Number of Rental Properties':
                var rental = $('[data-id="rental"]').val();

                if("white" != document.getElementById('yesBtn1.7').style.color){
                    if(0 != rental){
                        YesDecision(1.6);
                        populateAnswer('Do you currently have any rental properties?', 'Yes', false);
                    }
                }
                break;
                case 'Working from Home':
                var footage = $('[data-id="footage"]').val();

                if("white" != document.getElementById('yesBtn1.7').style.color){
                    if(0 != footage){
                        YesDecision(1.7);
                        populateAnswer('Will you be working from home?', 'Yes', false);
                    }
                }
                break;
                case 'Driving':
                var footage = $('[data-id="miles"]').val();

                if("white" != document.getElementById('yesBtn1.8').style.color){
                    if(0 != footage){
                        YesDecision(1.8);
                        populateAnswer('Will you use your personal vehicle for business purposes?', 'Yes', false);
                    }
                }
                break;
            }
        }

        //sets value and required status of child questions
        function linkedYesNo(fieldSet){
            switch (fieldSet) {
                case 'Employees and Contractors':
                //If there are not employees or contractors
                if("white" != document.getElementById('yesBtn1.3').style.color){
                    $('[data-id="employees"]').val('0');
                    $('[data-id="employees"]').parent().parent().children().find("spam").css("color", "rgba(18, 23, 36, 0.65)");
                    populateAnswer('How many employees do you have?', '0', false);
                    // $('[data-id="contractors"]').val('0');
                    // $('[data-id="contractors"]').parent().parent().children().find("spam").css("color", "rgba(18, 23, 36, 0.65)");
                    // populateAnswer('How many contractors do you have?', '0', false);
                } else {
                    $('[data-id="employees"]').parent().parent().children().find("spam").css("color", "#F15F22");
                    //$('[data-id="contractors"]').parent().parent().children().find("spam").css("color", "#F15F22");
                }
                break;
                case 'Number of Rental Properties':
                if("white" != document.getElementById('yesBtn1.6').style.color){
                    $('[data-id="rental"]').val('0');
                    $('[data-id="rental"]').parent().parent().children().find("spam").css("color", "rgba(18, 23, 36, 0.65)");
                    populateAnswer('How many rental properties do you have?', '0', false);
                } else {
                    $('[data-id="rental"]').parent().parent().children().find("spam").css("color", "#F15F22");
                }
                break;
                case 'Working from Home':
                if("white" != document.getElementById('yesBtn1.7').style.color){
                    $('[data-id="footage"]').val('0');
                    $('[data-id="footage"]').parent().parent().children().find("spam").css("color", "rgba(18, 23, 36, 0.65)");
                    populateAnswer('What is the approximate square footage of your home office?', '0', false);
                } else {
                    $('[data-id="footage"]').parent().parent().children().find("spam").css("color", "#F15F22");
                }
                break;
                case 'Driving':
                if("white" != document.getElementById('yesBtn1.8').style.color){
                    $('[data-id="miles"]').val('0');
                    $('[data-id="miles"]').parent().parent().children().find("spam").css("color", "rgba(18, 23, 36, 0.65)");
                    populateAnswer('How many business-related miles do you estimate youll drive per year?', '0', false);
                } else {
                    $('[data-id="miles"]').parent().parent().children().find("spam").css("color", "#F15F22");
                }
                break;

                //Take dependent questions off the client form
            }
        }
            
        function accordionFunct(accbtn, question) {
            accbtn.classList.toggle("active");
            var panel = accbtn.nextElementSibling;
            if (panel.style.display === "block") {
                panel.style.display = "none";
                document.getElementById("lessArrow"+question).style.display = "none";
                document.getElementById("moreArrow"+question).style.display = "block";
            } else {
                panel.style.display = "block";
                document.getElementById("lessArrow"+question).style.display = "block";
                document.getElementById("moreArrow"+question).style.display = "none";
            }
        }
                
        function activateNext() {
            var authorizes = document.getElementById("authorizes").checked;
            
            if(authorizes == true) {
                document.getElementById('nextPayment').removeAttribute('disabled');
                document.getElementById('nextPayment').style.opacity = "1";
            } else {
                document.getElementById('nextPayment').setAttribute('disabled', 'disabled');
                document.getElementById('nextPayment').style.opacity = "0.25";
            }
        }
                
        function showOne(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticaltLine1').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currSlide1').innerHTML = "Current Slide";
                document.getElementById('currSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide1').style.color = "black";
                document.getElementById('currSlide1').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticaltLine1').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currSlide1').innerHTML = "Show Slide";
                document.getElementById('currSlide1').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide1').style.color = "#1776B6";
                document.getElementById('currSlide1').style.background = "white";
            }
        }
                
        function showTwo(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticaltLine2').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currSlide2').innerHTML = "Current Slide";
                document.getElementById('currSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide2').style.color = "black";
                document.getElementById('currSlide2').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticaltLine2').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currSlide2').innerHTML = "Show Slide";
                document.getElementById('currSlide2').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide2').style.color = "#1776B6";
                document.getElementById('currSlide2').style.background = "white";
            }
        }

        function showThree(isVisible) {
            if(isVisible == true) {
                document.getElementById('verticaltLine3').style.borderLeft = "5px solid #F15F22";
                document.getElementById('currSlide3').innerHTML = "Current Slide";
                document.getElementById('currSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide3').style.color = "black";
                document.getElementById('currSlide3').style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById('verticaltLine3').style.borderLeft = "5px solid #FFFFFF";
                document.getElementById('currSlide3').innerHTML = "Show Slide";
                document.getElementById('currSlide3').style.border = "1px solid #E7EAF0";
                document.getElementById('currSlide3').style.color = "#1776B6";
                document.getElementById('currSlide3').style.background = "white";
            }
        }
        
        function getOne() {
            showOne(true);
            showTwo(false);
            showThree(false);
                    
            document.getElementById('accessAccount').style.display = "none";
            document.getElementById('verticaltLine3').style.display = "none";
            document.getElementById('btn-post').style.display = "none";
        }
                
        function getTwo() {
            showOne(false);
            showTwo(true);
            showThree(false);
            
            document.getElementById('accessAccount').style.display = "block";
            document.getElementById('verticaltLine3').style.display = "block";
            document.getElementById('expFeedback').style.display = "none";
        }
                
        function getThree() {
            showOne(false);
            showTwo(false);
            showThree(true);
            
            document.getElementById('expFeedback').style.display = "block";
            document.getElementById('btn-post').style.display = "block";
        }
        
        function cleanBtnSeleccion() {
            document.getElementById('tab2-1label').style.color = "#121724";
            document.getElementById('tab2-1label').style.background = "#FFFFFF";
            document.getElementById('tab2-2label').style.color = "#121724";
            document.getElementById('tab2-2label').style.background = "#FFFFFF";
            document.getElementById('tab2-3label').style.color = "#121724";
            document.getElementById('tab2-3label').style.background = "#FFFFFF";
            document.getElementById('tab2-4label').style.color = "#121724";
            document.getElementById('tab2-4label').style.background = "#FFFFFF";
            document.getElementById('tab2-5label').style.color = "#121724";
            document.getElementById('tab2-5label').style.background = "#FFFFFF";
            document.getElementById('tab2-6label').style.color = "#121724";
            document.getElementById('tab2-6label').style.background = "#FFFFFF";
            document.getElementById('tab2-7label').style.color = "#121724";
            document.getElementById('tab2-7label').style.background = "#FFFFFF";
            document.getElementById('tab2-8label').style.color = "#121724";
            document.getElementById('tab2-8label').style.background = "#FFFFFF";
        }        
                
        function hideTables() {
            document.getElementById("entityFormationPlan").style.display = "none";
            document.getElementById("bookkeepingPlan").style.display = "none";
            document.getElementById("payrollPlan").style.display = "none";
            document.getElementById("personalPlan").style.display = "none";
            document.getElementById("businessPlan").style.display = "none";
            document.getElementById("frequentPlan").style.display = "none";
            document.getElementById("AllPlan").style.display = "none";
            document.getElementById("currentPlan").style.display = "none";
        }
            
        function resizeTables(size) {
            document.getElementById("entityFormationPlan").style.height = size + "px";
            document.getElementById("bookkeepingPlan").style.height = size + "px";
            document.getElementById("payrollPlan").style.height = size + "px";
            document.getElementById("personalPlan").style.height = size + "px";
            document.getElementById("businessPlan").style.height = size + "px";
            document.getElementById("frequentPlan").style.height = size + "px";
            document.getElementById("AllPlan").style.height = size + "px";
            document.getElementById("currentPlan").style.height = size + "px";
        }
                
        function displayTablePlan(tableName, tabSelect, isFirst) {
            console.log('displayTablePlan '+tableName+' '+tabSelect.id+' '+tabSelect.checked+' '+isFirst);
            var tabSelected = tabSelect.checked;

            cleanBtnSeleccion(); //styling
            document.getElementById(tabSelect.id+'label').style.color = "#FFFFFF";
            document.getElementById(tabSelect.id+'label').style.background = "#75777A";
            
            document.getElementById("modalBodyTitleTable").style.display = "none"; //product search bar
            resizeTables(341); //styling
                    
            if (tabSelected == true || isFirst == true) {
                hideTables(); //styling
                document.getElementById(tableName).style.display = "block";
                if(tableName == "AllPlan") {
                    searchProds('all'); //styling
                    document.getElementById("modalBodyTitleTable").style.display = "block"; //product search bar
                    resizeTables(291); //styling
                }
            }

            var frecuencyBtnList = document.getElementsByClassName('radiobtn');
            
            for(var i = 0; i < frecuencyBtnList.length; i++) {
                
                if(frecuencyBtnList[i].value == 'true') {
                    frecuencyBtnList[i].checked = true;
                } else {
                    frecuencyBtnList[i].checked = false;
                }

                if(frecuencyBtnList[i].tagName == 'OUTPUT') {
                    var btnsList = document.getElementsByClassName(frecuencyBtnList[i].id+'label');
                    for(var j = 0; j < btnsList.length; j++) {
                        btnsList[j].style.opacity = "0.55";
                        btnsList[j].style.cursor = "not-allowed";
                        if(frecuencyBtnList[i].value == 'true') {
                            btnsList[j].style.background = "rgba(23, 118, 182, 0.16)";
                            btnsList[j].style.color = "rgba(18, 23, 36, 0.91)"
                        }
                    }
                }
            }
        }
                
        function getSecOnefeat() {
            showFeatureSlides('vertLine1features', 'currtSlide1features', true);
            showFeatureSlides('vertLine2features', 'currtSlide2features', false);
            showFeatureSlides('vertLine3features', 'currtSlide3features', false);
                    
            document.getElementById('otherCPAs').style.display = "none";
            document.getElementById('vertLine3features').style.display = "none";
            document.getElementById('btn-features').style.display = "none";
            
            socket.connect();
            content = {
                page: "1-800Accountant Introduction Part 1"
            }
            socket.emit("private message", {
                content
            });
        }
                
        function getSecTwofeat() {
            showFeatureSlides('vertLine1features', 'currtSlide1features', null);
            showFeatureSlides('vertLine2features', 'currtSlide2features', true);
            showFeatureSlides('vertLine3features', 'currtSlide3features', false);
                    
            document.getElementById('otherCPAs').style.display = "block";
            document.getElementById('vertLine3features').style.display = "block";
            document.getElementById('different').style.display = "none";
                
            scrollToDiv('#vertLine3features', '#features', 500);

            socket.connect();
            content = {
                page: "1-800Accountant Introduction Part 2"
            }
            socket.emit("private message", {
                content
            });
        }
                
        function getSecThreefeat() {
            showFeatureSlides('vertLine1features', 'currtSlide1features', null);
            showFeatureSlides('vertLine2features', 'currtSlide2features', null);
            showFeatureSlides('vertLine3features', 'currtSlide3features', true);
                    
            document.getElementById('different').style.display = "block";
            document.getElementById('btn-features').style.display = "block";
            
            scrollToDiv('#btn-features', '#features', 500);

            socket.connect();
            content = {
                page: "1-800Accountant Introduction Part 3"
            }
            socket.emit("private message", {
                content
            });
        }

        function showFeatureSlides(vertName, currentName, isVisible) {
            if(isVisible == true) {
                document.getElementById(vertName).style.borderLeft = "5px solid #F15F22";
                document.getElementById(currentName).innerHTML = "Current Slide";
                document.getElementById(currentName).style.border = "1px solid #E7EAF0";
                document.getElementById(currentName).style.color = "black";
                document.getElementById(currentName).style.background = "#E7EAF0";
                
            } else if(isVisible == false) {
                document.getElementById(vertName).style.borderLeft = "5px solid #FFFFFF";
                document.getElementById(currentName).innerHTML = '<i class="fas fa-arrow-right">&nbsp;</i>Next Section';
                document.getElementById(currentName).style.border = "1px solid #F15F22;";
                document.getElementById(currentName).style.color = "white";
                document.getElementById(currentName).style.background = "#F15F22";
            } else {
                document.getElementById(vertName).style.borderLeft = "5px solid #FFFFFF";
                document.getElementById(currentName).innerHTML = "Show Slide";
                document.getElementById(currentName).style.border = "1px solid #E7EAF0";
                document.getElementById(currentName).style.color = "#1776B6";
                document.getElementById(currentName).style.background = "white";
            }
        }
                
        function getSectionsPortal(sect) {
            showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', false);
            showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', false);
            showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', false);
            showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', false);
            showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', false);
            showFeatureSlides('vertLine6portalTour', 'currtSlide6portalTour', false);
            showFeatureSlides('vertLine7portalTour', 'currtSlide7portalTour', false);
            showFeatureSlides('vertLine8portalTour', 'currtSlide8portalTour', false);
            showFeatureSlides('vertLine9portalTour', 'currtSlide9portalTour', false);
            
            var pageToGo; 
            
            if(sect == 'Intro') {
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', true);
                document.getElementById('scheduler').style.display = "none";
                document.getElementById('vertLine3portalTour').style.display = "none";
                document.getElementById('vertLine4portalTour').style.display = "none";
                document.getElementById('vertLine5portalTour').style.display = "none";
                document.getElementById('vertLine6portalTour').style.display = "none";
                document.getElementById('vertLine7portalTour').style.display = "none";
                document.getElementById('vertLine8portalTour').style.display = "none";
                document.getElementById('vertLine9portalTour').style.display = "none";
                document.getElementById('btn-portalTour').style.display = "none";
                pageToGo = "Features - 1-800Accountant Portal";
            } 
            if(sect == 'Scheduler') {
                // document.getElementById("menuOpts").options[17].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Appointment Scheduler";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', true);
                document.getElementById('scheduler').style.display = "block";
                document.getElementById('vertLine3portalTour').style.display = "block";
                document.getElementById('messageCenter').style.display = "none";
                pageToGo = "Features - Appointment Scheduler";
                scrollToDiv('#vertLine3portalTour', '#portalTour', 500);
            } 
            if(sect == 'Message') {
                // document.getElementById("menuOpts").options[18].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Message Center";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', true);
                document.getElementById('messageCenter').style.display = "block";
                document.getElementById('vertLine4portalTour').style.display = "block";
                document.getElementById('taxPlanner').style.display = "none";
                pageToGo = "Features - Message Center";
                scrollToDiv('#vertLine4portalTour', '#portalTour', 500);
            } 
            if(sect == 'Tax') {
                // document.getElementById("menuOpts").options[19].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Tax Planner";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', true);
                document.getElementById('taxPlanner').style.display = "block";
                document.getElementById('vertLine5portalTour').style.display = "block";
                document.getElementById('featBookkeeping').style.display = "none";
                pageToGo = "Features - Tax Planner";
                scrollToDiv('#vertLine5portalTour', '#portalTour', 500);
            } 
            if(sect == 'Bookkeeping') {
                // document.getElementById("menuOpts").options[20].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Bookkeeping";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', null);
                showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', true);
                document.getElementById('featBookkeeping').style.display = "block";
                document.getElementById('vertLine6portalTour').style.display = "block";
                document.getElementById('DocumentCenter').style.display = "none";
                pageToGo = "Features - Bookkeeping";
                scrollToDiv('#vertLine6portalTour', '#portalTour', 500);
            } 
            if(sect == 'Document') {
                // document.getElementById("menuOpts").options[21].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Document Center";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', null);
                showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', null);
                showFeatureSlides('vertLine6portalTour', 'currtSlide6portalTour', true);
                document.getElementById('DocumentCenter').style.display = "block";
                document.getElementById('vertLine7portalTour').style.display = "block";
                document.getElementById('featInvoices').style.display = "none";
                pageToGo = "Features - Document Center";
                scrollToDiv('#vertLine7portalTour', '#portalTour', 900);
            } 
            if(sect == 'Invoices') {
                // document.getElementById("menuOpts").options[22].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Invoices";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', null);
                showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', null);
                showFeatureSlides('vertLine6portalTour', 'currtSlide6portalTour', null);
                showFeatureSlides('vertLine7portalTour', 'currtSlide7portalTour', true);
                document.getElementById('featInvoices').style.display = "block";
                document.getElementById('vertLine8portalTour').style.display = "block";
                document.getElementById('mobileApp').style.display = "none";
                pageToGo = "Features - Invoices";
                scrollToDiv('#vertLine8portalTour', '#portalTour', 1300);
            } 
            if(sect == 'Mobile') {
                // document.getElementById("menuOpts").options[23].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Mobile App";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', null);
                showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', null);
                showFeatureSlides('vertLine6portalTour', 'currtSlide6portalTour', null);
                showFeatureSlides('vertLine7portalTour', 'currtSlide7portalTour', null);
                showFeatureSlides('vertLine8portalTour', 'currtSlide8portalTour', true);
                document.getElementById('mobileApp').style.display = "block";
                document.getElementById('vertLine9portalTour').style.display = "block";
                document.getElementById('summary').style.display = "none";
                pageToGo = "Features - Mobile App";
                scrollToDiv('#vertLine9portalTour', '#portalTour', 1700);
            } 
            if(sect == 'Summary') {
                // document.getElementById("menuOpts").options[24].removeAttribute('disabled'); 
                // document.getElementById("menuOpts").value = "Features - Summary";
                showFeatureSlides('vertLine1portalTour', 'currtSlide1portalTour', null);
                showFeatureSlides('vertLine2portalTour', 'currtSlide2portalTour', null);
                showFeatureSlides('vertLine3portalTour', 'currtSlide3portalTour', null);
                showFeatureSlides('vertLine4portalTour', 'currtSlide4portalTour', null);
                showFeatureSlides('vertLine5portalTour', 'currtSlide5portalTour', null);
                showFeatureSlides('vertLine6portalTour', 'currtSlide6portalTour', null);
                showFeatureSlides('vertLine7portalTour', 'currtSlide7portalTour', null);
                showFeatureSlides('vertLine8portalTour', 'currtSlide8portalTour', null);
                showFeatureSlides('vertLine9portalTour', 'currtSlide9portalTour', true);
                document.getElementById('summary').style.display = "block";
                document.getElementById('btn-portalTour').style.display = "block";
                pageToGo = "Features - Summary";
                scrollToDiv('#btn-portalTour', '#portalTour', 2200);
            } 

            socket.connect();
            content = {
                page: pageToGo
            }
            socket.emit("private message", {
                content
            });
        }
                
        function checkAll(thisObj) {
            var tab = thisObj.id.substring(7);
            var productsToCheck = new Array();
            switch(tab){
                case 'currentPlan':
                    productsToCheck = tempSelectedProducts;
                    break;
                case 'AllPlan':
                    productsToCheck = finalProducts;
                    break;
                case 'frequentPlan':
                    productsToCheck = frequentProducts;
                    break;
                case 'businessPlan':
                    productsToCheck = businessProducts;
                    break;
                case 'personalPlan':
                    productsToCheck = personalProducts;
                    break;
                case 'payrollPlan':
                    productsToCheck = payrollProducts;
                    break;
                case 'bookkeepingPlan':
                    productsToCheck = bookkeepingProducts;
                    break;
                case 'entityFormationPlan':
                    productsToCheck = entityFormationProducts;
                    break;            
            }
            for(var prod of productsToCheck){
                if(prod.enabled){
                    addRemoveProduct(prod.Product.Id, thisObj.checked);
                }            
            }
            return;
            var isMaster = thisObj.hasAttribute('data-master-checkbox');
            var group = thisObj.closest('[data-checkbox-group]');
            var boxes = group.querySelectorAll('input[type=checkbox]:not([data-master-checkbox])');
            var master = isMaster ? thisObj : group.querySelector('input[type=checkbox][data-master-checkbox]');
            var allRows = thisObj.parentElement.parentElement.parentElement.childElementCount;
            var numRows = allRows - 1;

            if(isMaster) {
                // Check and Uncheck all with the parent 
                for(var i = 0; i < boxes.length; i++) {
                    if(boxes[i].id.includes("actionPlanTable") && boxes[i].parentNode.parentNode.style.display == 'table-row') {
                        boxes[i].checked = thisObj.checked;
                        boxes[i].value = thisObj.value;

                        var name = boxes[i].parentNode.parentNode.className;
                        var prodName = name.replace(/(\r\n|\n|\r)/gm, "");
                        if(prodName.includes('row')) {
                            prodName = prodName.replace('row ','');
                        }
                        var prodId = boxes[i].parentNode.parentNode.id;
                        chosenProducts.push(prodId);
                        uniquechosenProducts = [...new Set(chosenProducts)];
        
                        productSelected(boxes[i].checked, prodId, prodName);
                    }
                }
            } else {
                // Check and Uncheck the parent if the childs are all checked or unchecked
                var checkedCount = 0;
                for(var i = 0; i < boxes.length; i++) {
                    if(boxes[i].id.includes("actionPlanTable") && boxes[i].parentNode.parentNode.style.display == 'table-row') {
                        var name = boxes[i].parentNode.parentNode.className;
                        var prodName = name.replace(/(\r\n|\n|\r)/gm, "");
                        if(prodName.includes('row')) {
                            prodName = prodName.replace('row ','');
                        }
                        var prodId = boxes[i].parentNode.parentNode.id;

                        if(boxes[i].checked) { 
                            checkedCount += 1;      

                            chosenProducts.push(prodId);
                            uniquechosenProducts = [...new Set(chosenProducts)];
                        } else {             
                            var prodsList = document.getElementsByClassName(prodId);
                            for(var l = 0; l < prodsList.length; l++) {
                                prodsList[l].checked = boxes[i].checked;
                            }
                        }
                        productSelected(boxes[i].checked, prodId, prodName);
                    }
                }
                
                if(checkedCount == numRows) { 
                    master.checked = true;
                    master.value = true;
                } else {
                    master.checked = false;
                    master.value = false;
                }
            }
        }
                
        function showWaitingScreen(isShow) {
            if(isShow != false) {
                isShow = isShow.checked;
            }

            socket.connect();
            if(isShow == false) {
                content = {
                    page: "Waiting"
                }
                socket.emit("private message", {
                    content
                }); 
            } else {
                content = {
                    page: "Prepared Packages",
                    showProgress: true,
                    progress: currentProgress
                }
                socket.emit("private message", {
                    content
                });
            }
        }

        function enableProduct(productName, enabled, qtyFlag){
            console.log('enableProduct '+productName);
            var productCheckboxes = document.querySelectorAll("[data-product='"+productName+"']");
            var productQuantityInputs = document.querySelectorAll("input[data-product-qty='"+productName+"']");
            var productQuantityOutputs = document.querySelectorAll("output[data-product-qty='"+productName+"']");

            var prodId = productNameToId.get(productName);
            if(!prodId){
                return;
            }
            var selectedProd = selectedProductsMap.get(prodId);
            var finalProd = finalProductsMap.get(prodId);
            if(!finalProd){
                return;
            }

            if(selectedProd){
                selectedProd.enabled = enabled;
            }
            finalProd.enabled = enabled;
            
            if(enabled){
                for (let l = 0; l < productCheckboxes.length; l++) {
                    productCheckboxes[l].removeAttribute('disabled');
                }
                if(qtyFlag == true){
                    for (let l = 0; l < productQuantityInputs.length; l++) {
                        productQuantityInputs[l].style.display = 'flex';
                    }
                    for (let l = 0; l < productQuantityOutputs.length; l++) {
                        productQuantityOutputs[l].style.display = 'none';
                    }
                }
            } else {
                for (let l = 0; l < productCheckboxes.length; l++) {
                    productCheckboxes[l].setAttribute('disabled', 'disabled');
                }
                if(qtyFlag == true){
                    for (let l = 0; l < productQuantityInputs.length; l++) {
                        productQuantityInputs[l].style.display = 'none';
                    }
                    for (let l = 0; l < productQuantityOutputs.length; l++) {
                        productQuantityOutputs[l].style.display = 'flex';
                    }
                }
            }
        }

        //to-do: deal with autochecks that should be disabled boxes ?
        function autoChecks(name, chck) {
            console.log('autoChecks '+name);
            //return; //temporarily disabled
            const corpList = document.querySelectorAll("[data-product='Corp State Filing Fee']");
            const llcList = document.querySelectorAll("[data-product='LLC State Filing Fee']");
            const businessTaxList = document.querySelectorAll("[data-product='Business Tax Preparation']");
            const taxAdvisoryList = document.querySelectorAll("[data-product='Tax Advisory']");
            const backBookkList = document.querySelectorAll("[data-product='Back Bookkeeping']");
            const bookkList = document.querySelectorAll("[data-product='Bookkeeping Advisory']");
            const dedicBookkList = document.querySelectorAll("[data-product='Dedicated Bookkeeping']");
            const expediList = document.querySelectorAll("[data-product='Expedited Fee - Bookkeeping']");
            const threePageList = document.querySelectorAll("[data-product='3-Page Templated Website']");
            const fivePageList = document.querySelectorAll("[data-product='5-Page Templated Website']");
            const mainManaList = document.querySelectorAll("[data-product='Maintenance & Management']");
            const websiteList = document.querySelectorAll("[data-product='Website Builder']");
            const persoTaxPrepList = document.querySelectorAll("[data-product='Personal Tax Preparation']");
            const nonTaxPrepList = document.querySelectorAll("[data-product='Non-Profit Tax Preparation']");
            const nonProfBookkList = document.querySelectorAll("[data-product='Non-Profit Bookkeeping']");
            const nonProfBackBookkList = document.querySelectorAll("[data-product='Non-Profit Back Bookkeeping']");
            const nonProfBackBookkQTYList = document.querySelectorAll("[data-product-qty='Non-Profit Back Bookkeeping']");
            const backBookkQTYList = document.querySelectorAll("[data-product-qty='Back Bookkeeping']");
            const payrollList = document.querySelectorAll("[data-product='Payroll']");
            const audDefBusiList = document.querySelectorAll("[data-product='Audit Defense - Business']");
            const audDefPersList = document.querySelectorAll("[data-product='Audit Defense - Personal']");
            const twoYearList = document.querySelectorAll("[data-product='Two-Year Review']");
            const loanAgreeList = document.querySelectorAll("[data-product='Loan Agreement']");
            const prepList = document.querySelectorAll("[data-product='1099 Prep']");
            const prepQTYList = document.querySelectorAll("[data-product-qty='1099 Prep']");
            const foreQuali = document.querySelectorAll("[data-product='Foreign Qualification - LLC']");
            var transactions = $('[data-id="transactions"]').val();
            var bookkeepingDate = $('[data-id="bookkeepingStart"]').val();
            var foreignState = $('[data-id="foreignState"]').val();
            
            var newName = name;
            if(name == 'Business Return') {
                newName = 'Business Tax Preparation';
            } else if(name == 'Personal Return') {
                newName = 'Personal Tax Preparation';
            } else if(name == 'Advisory') {
                newName = 'Tax Advisory';
            }
            // var listProdPrice = document.querySelectorAll("[data-product-cost='" + newName + "']");
            // var prodPrice = listProdPrice[0].innerHTML;
            // prodPrice = prodPrice.replace('$','');
            // pricesMap.set(chck.className, prodPrice);

            if(name == 'LLC State Filing Fee') {
                for (let j = 0; j < corpList.length; j++) {
                    if(chck.checked == true) {
                        //corpList[j].checked = false;
                        autoCheckEntity(true);
                    } else {
                        autoCheckEntity(false);
                    }
                    break;
                }
            } else if(name == 'Corp State Filing Fee') {
                for (let i = 0; i < llcList.length; i++) {
                    if(chck.checked == true) {
                        //llcList[i].checked = false;
                        autoCheckEntity(true);
                    } else {
                        autoCheckEntity(false);
                    }
                    break;
                }
            } else if(name == 'Entity Formation') {
                for (let j = 0; j < corpList.length; j++) {
                    for (let i = 0; i < llcList.length; i++) {
                        if(corpList[j].checked == true || llcList[i].checked == true) {
                            autoCheckEntity(true);
                            break;
                        }
                    }
                }
            } else if(name == 'Payroll') {
                if(chck.checked == true) {
                    if(hasPayroll == 'true') {
                        autoCheckPayrollFee(false);
                    } else {
                        autoCheckPayrollFee(true);
                    }
                } else {
                    autoCheckPayrollFee(false);
                }
            } else if(name == 'Payroll Setup Fee') {
                for (let l = 0; l < payrollList.length; l++) {
                    if(payrollList[l].checked == true) {
                        autoCheckPayrollFee(true);
                    }
                }
            } else if(name == 'Business Tax Preparation' || name == 'Business Return') {
                var taxAdvisory = false;
                
                for (let j = 0; j < taxAdvisoryList.length; j++) {
                    if(taxAdvisoryList[j].checked == true) {
                        taxAdvisory = true;
                    }
                }


                if(taxAdvisory == true && chck.checked == true) {
                    autoCheck1800Acc(true);
                } 
            } else if(name == 'Tax Advisory' || name == 'Advisory') {
                var persoTaxPrepFlag = false;
                var audDefBusiFlag = false;
                var audDefPersFlag = false;
                var loanAgreeFlag = false;
                var twoYearFlag = false;
                var taxAdvisoryFlag = false;
                var businessTax = false;
                var persoTaxPrep = false;
                var nonTaxPrep = false;

                for (let j = 0; j < businessTaxList.length; j++) {
                    if(businessTaxList[j].checked == true) {
                        businessTax = true; 
                    }
                } 

                // for (let f = 0; f < persoTaxPrepList.length; f++) {
                //     if(persoTaxPrepList[f].checked == true) {
                //         persoTaxPrep = true;  
                //     }
                // }

                
                if(chck.checked == true && businessTax == true) {
                    autoCheck1800Acc(true);
                }

                // if(persoTaxPrep == true && chck.checked == true) {
                //     persoTaxPrepFlag = true;
                //     taxAdvisoryFlag = true;
                //     autoCheckLoanAgree(true);
                // } else if(persoTaxPrep == false && chck.checked == false) {
                //     autoCheckLoanAgree(false);
                // }
            } else if(name == '1-800Accountant Access') {
                var businessTax = false;
                var taxAdvisory = false;
                for (let l = 0; l < businessTaxList.length; l++) {
                    if(businessTaxList[l].checked == true) {
                        businessTax = true;
                    }
                }
                for (let j = 0; j < taxAdvisoryList.length; j++) {
                    const taxAdvisoryText = taxAdvisoryList[j].className;
                    if(taxAdvisoryList[j].checked == true) {
                        taxAdvisory = true;
                    }
                } 
                if(businessTax == true && taxAdvisory == true) {
                    autoCheck1800Acc(true);
                }
            } else if(name == '3-Page Templated Website') {
                for (let j = 0; j < fivePageList.length; j++) {
                    if(chck.checked == true) {
                        if(fivePageList[j].checked == true) {
                            autoCheckMainMana(true);
                            autoCheckWebsite(true);
                            break;
                        }
                    } 
                }
            } else if(name == '5-Page Templated Website') {
                for (let j = 0; j < threePageList.length; j++) {
                    if(chck.checked == true) {
                        if(threePageList[j].checked == true) {
                            autoCheckMainMana(true);
                            autoCheckWebsite(true);
                            break;
                        }
                    } 
                }
            } else if(name == 'Maintenance & Management') {
                if(chck.checked == true) {
                    for (let d = 0; d < fivePageList.length; d++) {
                        for (let j = 0; j < threePageList.length; j++) {
                            for (let f = 0; f < websiteList.length; f++) {
                                if(fivePageList[d].checked == false && 
                                threePageList[j].checked == false && 
                                websiteList[f].checked == false) {
                                    autoCheckWebsite(true);
                                    break;
                                }
                            }
                        }
                    }
                }
            // } else if(name == 'Expedited Fee - Bookkeeping') {
            //     if(chck.checked == true) {
            //         var backBookk = false;
            //         for (let l = 0; l < backBookkList.length; l++) {
            //             if(backBookkList[l].checked == false) {
            //                 autoCheckBackBookk(true); //why are we calling a function for this? We're already iterating through the list. -mc
            //                 backBookk = true;
            //                 break;
            //             } 
            //         }
            //         for (let j = 0; j < bookkList.length; j++) {
            //             if(bookkList[j].checked == false && backBookk == false) {
            //                 autoCheckBookk(true);
            //                 break;
            //             }
            //         }
            //     }
            } else if(name == 'Back Bookkeeping') {
                if(chck.checked == false) {
                    for (let l = 0; l < expediList.length; l++) {
                        if(expediList[l].checked == true) {
                            autoCheckExpedited(false);
                            break;
                        } 
                    }
                }
            } 
            
            if(getBundleStatus() == 'removed'){
                autoCheckBundleAddons(false);
            } else {
                autoCheckBundleAddons(true);
            }

            // if(!advisoryWasRemoved && newName == 'Tax Advisory' && chck.checked == false){
            //     advisoryWasRemoved = true;
            //     addRemoveAdvisoryAddons();
            // }
            if(newName == 'Tax Advisory'){
                addRemoveAdvisoryAddons(chck.checked);
            }
            
            

            if(foreignState == null || foreignState == ''){
                for (let l = 0; l < foreQuali.length; l++) {
                    foreQuali[l].setAttribute('disabled', 'disabled');
                }
            } else {
                for (let l = 0; l < foreQuali.length; l++) {
                    foreQuali[l].removeAttribute('disabled');
                }
            }

            // checkAll(chck);
        }

        function parseDate(stringVal){
            return new Date(Date.parse(stringVal+'T00:00:00+00:00'));
        }

        function monthDifference(startVal, endVal){
            if(!startVal){
                return null;
            }
            var startDate = parseDate(startVal);
            var today = new Date();
            var endDate;
            if(!endVal || parseDate(endVal) > today){
                endDate = today;
            } else {
                endDate = parseDate(endVal);
            }
            // get months
            var months;
            months = (endDate.getFullYear() - startDate.getFullYear()) * 12; //start with the year difference
            months -= startDate.getMonth(); //exclude the extra months before the startDate
            months += endDate.getMonth(); //include the extra months before today's date
            months = months <= 0 ? 0 : months;
            return months;
        }

        function autoCheckEntity(val) {
            var prodId = productNameToId.get('Entity Formation');
            addRemoveProduct(prodId, val);
        }

        function autoCheckPayrollFee(val) {
            var prodId = productNameToId.get('Payroll Setup Fee');
            addRemoveProduct(prodId, val);
        }

        function autoCheck1800Acc(val) {
            var prodId = productNameToId.get('1-800Accountant Access');
            addRemoveProduct(prodId, val);
        }

        function autoCheckExpedited(val) {
            var prodId = productNameToId.get('Expedited Fee - Bookkeeping');
            addRemoveProduct(prodId, val);
        }

        function autoCheckBackBookk(val) {
            var prodId = productNameToId.get('Back Bookkeeping');
            addRemoveProduct(prodId, val);
        }

        function autoCheckBookk(val) {
            var prodId = productNameToId.get('Bookkeeping Advisory');
            addRemoveProduct(prodId, val);
        }

        function autoCheckMainMana(val) {
            var prodId = productNameToId.get('Maintenance & Management');
            addRemoveProduct(prodId, val);
        }

        function autoCheckWebsite(val) {
            var prodId = productNameToId.get('Website Builder');
            addRemoveProduct(prodId, val);
        }

        //var advisoryAddons = ['Personal Financial Planning', '1-800Accountant Access', 'Loan Agreement', 'Beneficial Owner Information Report'];
        var bundleNameToBundleProductName = new Map([
            ['Core Accounting Package', 'Core Accounting Package'],
            ['Core Accounting Package (Partner BTP)', 'Core Accounting Package (Partner BTP)'],
            ['Core Accounting Package (Partner BTP/BOI)', 'Core Accounting Package (Partner BTP/BOI)'],
            ['Core Accounting Package (Partner BTP/PTP/BOI)', 'Core Accounting Package (Partner BTP/PTP/BOI)'],
            ['Core Accounting Package (Partner BTPNS/BOI)', 'Core Accounting Package (Partner BTPNS/BOI)']
        ]);
        function autoCheckBundleAddons(val) {
            var prodId = productNameToId.get(eligibleBundle);
            addRemoveProduct(prodId, val);

            if(!val){
                for(var prod of advisoryAddons){
                    prodId = productNameToId.get(prod);
                    //addRemoveProduct(prodId, val);
                    enableProduct(prod, true, true);
                }
            }
        }

        function addRemoveAdvisoryAddons(add){
            for(var prod of advisoryAddons){
                var prodId = productNameToId.get(prod);
                addRemoveProduct(prodId, add);
            }
            if(add){
                //hide loan agreement
                document.getElementById(productNameToId.get('Loan Agreement')).style.display = 'none';
            } else {
                //show loan agreement
                document.getElementById(productNameToId.get('Loan Agreement')).style.display = 'table-row';
            }
        }

        function autoCheckLoanAgree(val) {
            return;
            const loanAgreeList = document.querySelectorAll("[data-amount='Loan Agreement']");
            var id = '';
            var productPrice = 0;

            for (let l = 0; l < loanAgreeList.length; l++) {
                id = loanAgreeList[l].parentNode.parentNode.id;
                if(val == true) {
                    loanAgreeList[l].innerHTML = '$0.00';
                    productPrice = 0.00;
                } else {
                    productPrice = oridinalPricesMap.get(id);
                    productPrice = parseFloat(productPrice).toFixed(2);
                    loanAgreeList[l].innerHTML = formatMoney(productPrice);
                }
            }
            pricesMap.set(id, productPrice);
        }

        //update unit price of 1800Accountant access based on other items
        //Should be triggered when de/selecting any items in productsRelatedToAccess
        function autoAmount1800Acc(prodId) {
            console.log('autoAmount1800Acc');
            return;
            const accList = document.querySelectorAll("[data-amount='1-800Accountant Access']");
            if(accList.length == 0){
                console.log('1800 Access node not found');
                return;
            }
            //var id = '';
            var productPrice = 0;
            if(!prodId){ prodId = accList[0].parentNode.parentNode.id; }
            var useDiscount = accessDiscounted();
            if(useDiscount){
                productPrice = 329.89; //29.99;
                } else {
                    productPrice = originalPriceMap.get(prodId);
                    productPrice = parseFloat(productPrice).toFixed(2);
                    }
            // for (let l = 0; l < accList.length; l++) {
            //     //id = accList[l].parentNode.parentNode.id;
            //     accList[l].innerHTML = formatMoney(productPrice);
            // }
            updateProductPrice(prodId, productPrice);

        }

        const productsRelatedToAccess = ['Audit Defense - Business','Audit Defense - Personal','Business Tax Preparation',
        'Two-Year Review','Loan Agreement','Tax Advisory','Personal Tax Preparation','Non-Profit Tax Preparation'];
        const productsRelatedToLoanAgreement = ['Tax Advisory','Personal Tax Preparation'];
        
        function accessDiscounted(){
            var persoTaxPrepFlag = false;
            var audDefBusiFlag = false;
            var audDefPersFlag = false;
            var loanAgreeFlag = false;
            var twoYearFlag = false;
            var taxAdvisoryFlag = false;
            var businessTaxFlag = false;
            var nonprofitTaxFlag = false;
            const audDefBusiList = document.querySelectorAll("[data-product='Audit Defense - Business']");
            const audDefPersList = document.querySelectorAll("[data-product='Audit Defense - Personal']");
            const twoYearList = document.querySelectorAll("[data-product='Two-Year Review']");
            const loanAgreeList = document.querySelectorAll("[data-product='Loan Agreement']");
            const taxAdvisoryList = document.querySelectorAll("[data-product='Tax Advisory']");
            const persoTaxPrepList = document.querySelectorAll("[data-product='Personal Tax Preparation']");
            const nonTaxPrepList = document.querySelectorAll("[data-product='Non-Profit Tax Preparation']");
            const businessTaxList = document.querySelectorAll("[data-product='Business Tax Preparation']");

            for (let l = 0; l < businessTaxList.length; l++) {
                if(businessTaxList[l].checked == true) {
                    businessTaxFlag = true;
                    break;
                }
            }
            for (let f = 0; f < nonTaxPrepList.length; f++) {
                if(nonTaxPrepList[f].checked == true) {
                    nonprofitTaxFlag = true;
                    break;
                }
            }
            for (let j = 0; j < audDefBusiList.length; j++) {
                if(audDefBusiList[j].checked == true) {
                    audDefBusiFlag = true;
                    break;
                }
            }
            for (let j = 0; j < persoTaxPrepList.length; j++) {
                if(persoTaxPrepList[j].checked == true) {
                    persoTaxPrepFlag = true;
                    break;
                }
            }
            for (let j = 0; j < audDefPersList.length; j++) {
                if(audDefPersList[j].checked == true) {
                    audDefPersFlag = true;
                    break;
                }
            }
            for (let j = 0; j < loanAgreeList.length; j++) {
                if(loanAgreeList[j].checked == true) {
                    loanAgreeFlag = true;
                    break;
                }
        }
            for (let j = 0; j < twoYearList.length; j++) {
                if(twoYearList[j].checked == true) {
                    twoYearFlag = true;
                    break;
                }
            }
            for (let j = 0; j < taxAdvisoryList.length; j++) {
                if(taxAdvisoryList[j].checked == true) {
                    taxAdvisoryFlag = true;
                    break;
                }
            }

            if(businessTaxFlag && persoTaxPrepFlag && taxAdvisoryFlag){
                return true;
            }
            if(persoTaxPrepFlag && taxAdvisoryFlag && audDefBusiFlag && audDefPersFlag && loanAgreeFlag && twoYearFlag) {
                return true;
            }
            if(persoTaxPrepFlag && taxAdvisoryFlag && nonprofitTaxFlag){
                return true;
            }
            return false;
        }

        function updateProductPrice(prodId, newPrice){
            //try{
                //console.log('updateProductPrice '+prodId+' '+newPrice);
                newPrice = Math.ceil(newPrice);
                var prodName = productIdToName.get(prodId);
                var amountList = document.querySelectorAll("[data-amount='"+prodName+"']");
                var formattedPrice = formatMoney(newPrice);

                for (let l = 0; l < amountList.length; l++) {
                    amountList[l].innerHTML = formatMoney(newPrice);
                }

                if(finalProductsMap.has(prodId)) { finalProductsMap.get(prodId).adjustedPrice = newPrice; }
                if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).adjustedPrice = newPrice; }
                updateProductSubtotal(prodId); 
            // } catch (ex){
            //     console.error('~~~'+ex);
            // }
            
        }

        function getBundleDiscount(){
            if(Number.isNaN(Number.parseFloat('{!bundleDiscount}'))){
                return 0.191;
            } else {
                return Number.parseFloat('{!bundleDiscount}') / 100;
            }
        }

        var bundleNameToFreeItems = new Map([
            ['Core Accounting Package', ['Personal Financial Planning', 'Loan Agreement', 'Beneficial Owner Information Report']],
            ['Core Accounting Package (Partner BTP)', ['Two-Year Review', 'Beneficial Owner Information Report']],
            ['Core Accounting Package (Partner BTP/BOI)', ['Two-Year Review']],
            ['Core Accounting Package (Partner BTP/PTP/BOI)', []],
            ['Core Accounting Package (Partner BTPNS/BOI)', ['Two-Year Review', 'Loan Agreement']]
        ]);
        var eligibleBundle;
        function autoAmountBundleItems(){
            console.log('autoAmountBundleItems');
            //var bundleItems = finalProducts.filter((x) => x.bundlePricing);
            var useBundlePrice = (getBundleStatus() != 'removed');
            var bundleType = eligibleBundle;
            var advisorySelected = selectedProductsMap.has(productNameToId.get('Tax Advisory'));
            for (var item of finalProducts){
                if(useBundlePrice && !item.Product.Setup_Fee__c){
                    if(bundleNameToFreeItems.get(bundleType)?.includes(item.Product.Name)){
                        updateProductPrice(item.Id, 0.0);
                    } else if(item.Product.Name == 'Tax Advisory'){
                        //autoAmountAdvisory();                        
                    } else {
                        updateProductPrice(item.Id, originalPriceMap.get(item.Id)*(1.0-getBundleDiscount()));
                    }
                } else {                    
                    if(item.Product.Name == 'Loan Agreement'){
                        autoAmountLoan(item.Id, item.Product.Setup_Fee__c);
                    } else if(!useBundlePrice && !item.Product.Setup_Fee__c && bundleNameToFreeItems.get('Core Accounting Package')?.includes(item.Product.Name)){
                        updateProductPrice(item.Id, 0.0);
                    } else {
                        updateProductPrice(item.Id, originalPriceMap.get(item.Id));
                    }
                }
            }
            autoAmountAdvisory();        
        }

        function autoAmountFinancingItems(){
            var financingIncrease;
            if(Number.isNaN(Number.parseFloat('{!financingIncrease}'))){
                financingIncrease = 0.10;
            } else {
                financingIncrease = Number.parseFloat('{!financingIncrease}') / 100;
            }
            console.log(financingIncrease);
        }

        //update 1099 unit price based on the qty of the same product
        //theoretically only needs to be triggered when 1099 qty changes
        //not currently in use?
        function autoAmount1099(qtyPrep, prodId) {
            console.log('autoAmount1099');
            const prepList = document.querySelectorAll("[data-amount='1099 Prep']");
            var id = '';
            var productPrice = 0;
            var newPrice = 0;
            if(prepList.length == 0){
                console.log('1099 node not found');
                return;
            }
            if(!prodId){ prodId = prepList[0].parentNode.parentNode.id; }
            if(!qtyPrep){ finalProductsMap.get(prodId)?.currentQuantity; }
            productPrice = originalPricesMap.get(prodId);
            newPrice = finalProductsMap.get(prodId)?.adjustedPrice;
                
            if(qtyPrep > 1) {
                newPrice = (productPrice + ((qtyPrep - 1) * 20)) / qtyPrep;
                newPrice = parseFloat(newPrice).toFixed(2);
            } else {
                newPrice = 50;
            }
            
            // for (let l = 0; l < prepList.length; l++) {
            //     prepList[l].innerHTML = formatMoney(newPrice);
            // }
            //pricesMap.set(id, newPrice);
            updateProductPrice(prodId, newPrice);
            return newPrice;
        }

        //update tax advisory unit price based on whether business prep and personal prep
        //are both included in the current package. Theoretically only needs to be triggered
        //when business or personal prep are de/selected (or if their unit price changes, which shouldn't happen currently)
        function autoAmountAdvisory(prodId) {
            console.log('autoAmountAdvisory');
            var useCustomPricing = isCustomAdvisoryPricing();
            const advList = document.querySelectorAll("[data-amount='Tax Advisory']");
            if(advList.length == 0){
                console.log('advisory node not found');
                return;
            }
            //if(!prodId){ prodId = advList[0].parentNode.parentNode.id; }
            if(!prodId){ prodId =  productNameToId.get('Tax Advisory'); }
            //var id = '';
            var productPrice = 0;
            var addonTotal = 0;
            for (let l = 0; l < advisoryAddons.length; l++) {
                if(!finalProducts.map(x => x.Product.Name).includes(advisoryAddons[l])){continue;}
                var addonId = productNameToId.get(advisoryAddons[l]);
                var addonPrice = finalProductsMap.get(addonId).adjustedPrice;
                addonTotal += addonPrice;
                console.log(advisoryAddons[l]+': $'+addonPrice);
            }
            console.log('addonTotal: '+addonTotal);

            var setupFee = finalProductsMap.get(prodId)?.Product.Setup_Fee__c;
            if(useCustomPricing){
                // var perPrice = document.querySelector("[data-amount='Personal Tax Preparation']").innerHTML;
                // var busiPrice = document.querySelector("[data-amount='Business Tax Preparation']").innerHTML;
                // console.log('ptp: '+perPrice);
                // console.log('btp: '+busiPrice);
                // perPrice = perPrice.replace('$','');
                // busiPrice = busiPrice.replace('$','');
                var personalPrep = finalProductsMap.get(productNameToId.get('Personal Tax Preparation'));
                var businessPrep = finalProductsMap.get(productNameToId.get('Business Tax Preparation'));
                productPrice = (personalPrep.adjustedPrice + businessPrep.adjustedPrice) / (originalPriceMap.get(personalPrep.Id) + originalPriceMap.get(businessPrep.Id));
                productPrice *= originalPriceMap.get(prodId);
                console.log('advisory bundled base price: $'+productPrice);
                //productPrice = Math.max(productPrice, (originalPriceMap.get(prodId)))*(1-getBundleDiscount());//.toFixed(2);
                //productPrice *= (1-getBundleDiscount());
                productPrice += addonTotal;
            } else {
                var useBundlePrice = (getBundleStatus() != 'removed');
                console.log('advisory original base price: $'+originalPriceMap.get(prodId));
                productPrice = originalPriceMap.get(prodId) * ((useBundlePrice && !setupFee) ? (1-getBundleDiscount()) : 1);
                productPrice += addonTotal;
            }


            // for (let l = 0; l < advList.length; l++) {
            //     advList[l].innerHTML = formatMoney(productPrice);
            // }
            //pricesMap.set(id, productPrice);
            updateProductPrice(prodId, productPrice);
        }

        
        function isCustomAdvisoryPricing(){
            const businessTaxList = document.querySelectorAll("[data-product='Business Tax Preparation']");
            const persoTaxPrepList = document.querySelectorAll("[data-product='Personal Tax Preparation']");
            var persoTaxPrepFlag = false;
            var businessTaxFlag = false;
            for (let l = 0; l < businessTaxList.length; l++) {
                if(businessTaxList[l].checked == true) {
                    businessTaxFlag = true;
                    break;
                }
            }
            for (let j = 0; j < persoTaxPrepList.length; j++) {
                if(persoTaxPrepList[j].checked == true) {
                    persoTaxPrepFlag = true;
                    break;
                }
            }
            return businessTaxFlag && persoTaxPrepFlag;
        }

        function autoAmountLoan(prodId, hasSetupFee){
            console.log('autoAmountLoan');
            var useCustomPricing = isFreeLoan(hasSetupFee);
            const advList = document.querySelectorAll("[data-amount='Loan Agreement']");
            if(advList.length == 0){
                console.log('Loan Agreement node not found');
                return;
            }
            if(!prodId){ prodId = advList[0].parentNode.parentNode.id; }
            //var id = '';
            var productPrice = 0;

            if(useCustomPricing){
                productPrice = 0;
            } else {
                productPrice = originalPriceMap.get(prodId);
            }

            // for (let l = 0; l < advList.length; l++) {
            //     advList[l].innerHTML = formatMoney(productPrice);
            // }
            //pricesMap.set(id, productPrice);
            updateProductPrice(prodId, productPrice);
        }

        function isFreeLoan(hasSetupFee){
            const taxAdvisoryList = document.querySelectorAll("[data-product='Tax Advisory']");
            const persoTaxPrepList = document.querySelectorAll("[data-product='Personal Tax Preparation']");
            var persoTaxPrepFlag = false;
            var taxAdvisoryFlag = false;
            for (let l = 0; l < taxAdvisoryList.length; l++) {
                if(taxAdvisoryList[l].checked == true) {
                    taxAdvisoryFlag = true;
                        break;
                    }
                }
            for (let j = 0; j < persoTaxPrepList.length; j++) {
                if(persoTaxPrepList[j].checked == true) {
                    persoTaxPrepFlag = true;
                    break;
                }
            }
            return (taxAdvisoryFlag && persoTaxPrepFlag) || (taxAdvisoryFlag && !hasSetupFee && bundleNameToFreeItems.get('Core Accounting Package')?.includes('Loan Agreement'));
        }


        //the primary purpose of this function is to (re)calculate the quote totals
        //runs in calcQuantityChange(), checkAll(), calculateTaxSavings(),and calcFrequencyChange
        function productSelected(checked, value, name) {
            return;        
        }

        //update the line item's total, and then sync across tabs
        function calcQuantityChange(quantity, prodName, prodId, prodPrice) {
            if(!prodId || prodId == ''){
                prodId = productNameToId.get(prodName);
            }
            var qty = quantity.value;
            if(!qty || !Number.isInteger(Number.parseFloat(qty)) || qty < 1){
                console.log('invalid quantity for '+prodName+': '+qty);
                return;
            }
            var qtyNum = Number.parseInt(qty);

            var newPrice = prodPrice;
            //use custom logic for 1099 prep, since unit price depends on qty
            if(prodName == '1099 Prep') {
                newPrice = autoAmount1099(qty, prodId);
            }

            // if(prodName == 'Tax Advisory'){
            //     for (let l = 0; l < advisoryAddons.length; l++){
            //         if(productNameToId.get(advisoryAddons[l])){calcQuantityChange(quantity, advisoryAddons[l]);}                    
            //     }
            // }
            //sync product quantity across  tabs
            const qtyBtnList = document.querySelectorAll("[data-product-qty='" + prodName + "']");
            for(var i = 0; i < qtyBtnList.length; i++) {
                qtyBtnList[i].value = qty;
            }

            //calculate line totals and sync across tabs
            // const subBtnList = document.querySelectorAll("[data-product-subtotal='" + prodName + "']");
            // // var listProdPrice = document.querySelectorAll("[data-product-cost='" + prodName + "']");
            // // var prodPrice = listProdPrice[0].innerHTML;
            // // prodPrice = prodPrice.replace('$','');
            // var subtotalValue = (qtyNum * parseFloat(newPrice)).toFixed(2);
                    // //subtotalValue = parseFloat(subtotalValue).toFixed(2);
                    
            // for(var i = 0; i < subBtnList.length; i++) {            
            //     subBtnList[i].innerHTML = '$' + subtotalValue.toString();
                // }
            
            if(finalProductsMap.has(prodId)) { finalProductsMap.get(prodId).currentQuantity = qtyNum; }
            if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).currentQuantity = qtyNum; }
            
            updateProductSubtotal(prodId);
            updateQuoteTotals();
            syncProdsToClient();
            //syncProdToClient(finalProductsMap.get(prodId));
            // var checkRow = quantity.parentNode.parentNode.parentNode.childNodes[0].childNodes[0].checked;
            // var classNameRow = quantity.parentNode.parentNode.parentNode.id;
            // var nameRow = quantity.parentNode.parentNode.parentNode.className;
            // nameRow = nameRow.replace('row ','');
    
            // productSelected(checkRow, classNameRow, nameRow);
        }

        //18A access yearly click: {"0":{},"1":"01tf1000003JjrwAAC","2":"1-800Accountant Access","3":"Monthly","4":"true"}
        function calcFrecuencyChange(frecuencyBtn, prodId, override) { 
            var product = finalProductsMap.get(prodId);
            var prodName = product.Product.Name;
            var thisChecked = frecuencyBtn.checked;
            var thisId = frecuencyBtn.id;
            var isNowYearly = thisId.includes("yearly");
            var isNowMonthly = thisId.includes("monthly");
            
            
            var frecuencyBtnList = document.getElementsByClassName(frecuencyBtn.className);

            var monthlyOnes = document.getElementsByClassName(prodId + 'monthly');
            var yearlyOnes = document.getElementsByClassName(prodId + 'yearly');

            if(!thisChecked && !override){
                console.log('unchecked');
                for(var r = 0; r < monthlyOnes.length; r++) {
                    monthlyOnes[r].checked = product.currentBillingFrequency == 'Monthly';
                    monthlyOnes[r].value = product.currentBillingFrequency == 'Monthly';
                    yearlyOnes[r].checked = product.currentBillingFrequency == 'Annual';
                    yearlyOnes[r].value = product.currentBillingFrequency == 'Annual';
                }
                return;
            }
            if(!product.frequencyEnabled && !override){
                console.log('product frequency disabled');
                for(var r = 0; r < monthlyOnes.length; r++) {
                    monthlyOnes[r].checked = product.currentBillingFrequency == 'Monthly';
                    monthlyOnes[r].value = product.currentBillingFrequency == 'Monthly';
                    yearlyOnes[r].checked = product.currentBillingFrequency == 'Annual';
                    yearlyOnes[r].value = product.currentBillingFrequency == 'Annual';
                }
                return;
            }

            for(var r = 0; r < monthlyOnes.length; r++) {
                monthlyOnes[r].checked = isNowMonthly;
                monthlyOnes[r].value = isNowMonthly;
                yearlyOnes[r].checked = isNowYearly;
                yearlyOnes[r].value = isNowYearly;
            }

            
            if(isNowMonthly && product){
                product.currentBillingFrequency = 'Monthly';
                if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).currentBillingFrequency = 'Monthly'; }
            }
            if(isNowYearly && product){
                product.currentBillingFrequency = 'Annual';
                if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).currentBillingFrequency = 'Annual'; }
            }
            
            updateProductSubtotal(prodId);
            updateQuoteTotals();
            syncProdsToClient();
            //syncProdToClient(product);
        }

        function justRemoveProduct(pId) {
            addRemoveProduct(pId, false, null);
        }
        var lastSubtotal;
        function updateProductSubtotal(prodId){
            var product = finalProductsMap.get(prodId);
            //console.log('updateProductSubtotal '+product.Product.Name);
            var subtotal = product.adjustedPrice * product.currentQuantity;
            // if(product.Product.Guided_Selling_Identifier__c == '1-800Accountant Access' && product.currentBillingFrequency == 'Monthly'){
            //     subtotal = subtotal / 11;
            // } else 
            if(product.currentBillingFrequency == 'Annual' && product.Product.Billing_Frequency__c != 'Annual'){
                subtotal = subtotal * 11;
            } else if (product.currentBillingFrequency == 'Monthly' && product.Product.Billing_Frequency__c != 'Monthly'){
                subtotal = (subtotal / 12) * 1.2;
            }
            subtotal = Number.parseFloat(subtotal.toFixed(2));
            lastSubtotal = subtotal; //debug
            product.subtotal = subtotal;
            if(selectedProductsMap.has(prodId)) { selectedProductsMap.get(prodId).subtotal = subtotal; }
            var subtotalList = document.getElementsByClassName(prodId+'subtotal');
                        
            for(var k = 0; k < subtotalList.length; k++) {
                subtotalList[k].innerHTML = formatMoney(subtotal);
            }
            // if(!skipFullUpdate){
            //     updateQuoteTotals(); 
            // }        
            //syncProdToClient(product);
        }
        var advisoryWasRemoved = false;
        const productsRelatedToAdvisory = ['Personal Tax Preparation', 'Business Tax Preparation'];
        //function called when un/checking a product in the modal
        //function addRemoveProduct(pChecked, pId, pName, pPrice, pAnnualMonthly, pBillingFreq, pQtyAllow) {
        function addRemoveProduct(prodId, overrideValue, productName) {
            if(productName && !prodId){
                prodId = productNameToId.get(productName);
            }
            var product = finalProductsMap.get(prodId);
            if(!product){
                console.log('product not available; skipping '+prodId);
                return;
            }
            
            //remove product if already selected
            // if(selectedProductsMap.has(prodId)){
            //     selectedProductsMap.get(prodId).selected = false;
            //     selectedProductsMap.delete(prodId);
            //     tempSelectedProducts = Array.from(selectedProductsMap.values());
            // } else { //add product
            //     product.selected = true;
            //     selectedProductsMap.set(prodId, product);
            //     tempSelectedProducts.push(product);
            // }

            var tBody = document.getElementById("selectedPlan");
            var pAnnualOne;
            var pMonthly;
            //don't toggle the selection if the current "value" matches overrideValue
            var skipAddRemove = (selectedProductsMap.has(prodId) == overrideValue);
            if(skipAddRemove){
                return;
            }
            //to-do: I'd eventually like to get rid of this html code in favor of a better solution, but it 
            //isn't worth the time sink at the moment
            if(!selectedProductsMap.has(prodId)) { //add product
                product.selected = true;
                selectedProductsMap.set(prodId, product);
                tempSelectedProducts.push(product);

                var checkboxList = document.querySelectorAll("[data-product='"+product.Product.Name+"']");
                for(var i=0; i<checkboxList.length; i++){
                    checkboxList[i].checked = true;
                    checkboxList[i].value = true;
                }

                var none = '';
                var flex = '';
                var rowDisplay = '';

                if(product.currentBillingFrequency == 'Annual' || product.currentBillingFrequency == 'One-Time') {
                    pAnnualOne = true;
                } else {
                    pAnnualOne = false;
                }
                if(product.currentBillingFrequency == 'Monthly') {
                    pMonthly = true;
                } else {
                    pMonthly = false;
                }
                
                if(product.Product.Disable_QTY_on_Calc__c == true || product.Product.Disable_QTY_on_Calc__c == 'true'
                || !product.quantityEnabled) {
                    none = 'flex';
                    flex = 'none';               
                    
                } else {
                    none = 'none';
                    flex = 'flex';
                }

                if(product.visible){
                    rowDisplay = 'table-row';
                } else {
                    rowDisplay = 'none';
                }

                if(product.Product.AnnualMonthlyOption__c == true || product.Product.AnnualMonthlyOption__c == 'true') {
                    var rowData = '<div id="' + product.Product.Id + '" class="row ' + product.Product.Name + '" style="display: '+rowDisplay+';border-bottom: 1px solid rgba(18, 23, 36, 0.2);">'
                    + '<div class="col" style="text-align: center;vertical-align: middle;padding-left: 17px;">' 
                    + '<input type="checkbox" html-data-id="' + product.Product.Id + '" data-product="' + product.Product.Name + '" style="Height: 13px;margin-left: 12px;" id="actionPlanTable" class="' + product.Product.Id + '" onchange="addRemoveProduct(&apos;' + product.Product.Id + '&apos;);" checked="checked" value="true"'+(product.enabled ? '' : 'disabled= "disabled"')+'/>'
                    + '</div>'
                    + '<div class="col" style="padding-left: 0px;">'
                    + '<p class="planPackageTableProd">' + product.Product.Name + '</p>'
                    + '</div>'
                    + '<div class="col" style="padding-left: 195px;">'
                    + '<p class="planPackageTableCost" data-product-cost="' + product.Product.Name + '" data-amount="' + product.Product.Name + '">' + formatMoney(product.adjustedPrice) + '</p>'
                    + '</div>'
                    + '<div class="col" style="width: 160px;">'
                    + '<div class="radio-group">'
                    + '<input type="checkbox" class="radiobtn ' + product.Product.Id + 'yearly" id="' + product.Product.Id + 'yearly" name="selector" value="' + pAnnualOne + '" value=' + pAnnualOne + ' onchange="calcFrecuencyChange(this, &apos;' + product.Product.Id + '&apos;, &apos;' + product.Product.Name + '&apos;, &apos;' + product.currentBillingFrequency + '&apos;, &apos;' + pAnnualOne + '&apos;);"/>'
                    + '<label for="' + product.Product.Id + 'yearly" class="radioLabel"' + (product.frequencyEnabled ? '' : 'style="opacity: 0.55; cursor: not-allowed;"') + '>Yearly</label>'
                    + '<input type="checkbox" class="radiobtn ' + product.Product.Id + 'monthly" id="' + product.Product.Id + 'monthly" name="selector" value="' + pMonthly + '" value=' + pMonthly + ' onchange="calcFrecuencyChange(this, &apos;' + product.Product.Id + '&apos;, &apos;' + product.Product.Name + '&apos;, &apos;' + product.currentBillingFrequency + '&apos;, &apos;' + pMonthly + '&apos;);"/>'
                    + '<label for="' + product.Product.Id + 'monthly" class="radioLabel"' + (product.frequencyEnabled ? '' : 'style="opacity: 0.55; cursor: not-allowed;"') + '>Monthly</label>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col" style="width: 110px;">'
                    + '<div class="form-floating">'
                    + '<input type="tel" data-product-qty="' + product.Product.Name + '" class="form-control ' + product.Product.Id + 'qty" id="planPackageTableQuantity" style="display: ' + flex + '" value="' + product.currentQuantity + '" oninput="calcQuantityChange(this, &apos;' + product.Product.Name + '&apos;);"/>'
                    + '<output type="tel" data-product-qty="' + product.Product.Name + '" class="form-control" id="planPackageTableQuantityOutput" style="display: ' + none + '; background: rgba(18, 23, 36, 0.2);opacity: 0.75;">' + product.currentQuantity + '</output>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col" style="40px">'
                    + '<p class="planPackageTableSubtotal ' + product.Product.Id + 'subtotal" data-product-subtotal="' + product.Product.Name + '" data-amount="' + product.Product.Name + '">' + formatMoney(product.subtotal) + '</p>'
                    + '</div>'
                    + '</div>';
                } else {
                    var rowData = '<div id="' + product.Product.Id + '" class="row ' + product.Product.Name + '" style="display: '+rowDisplay+';border-bottom: 1px solid rgba(18, 23, 36, 0.2);">'
                    + '<div class="col" style="text-align: center;vertical-align: middle;padding-left: 17px;">'
                    + '<input type="checkbox" html-data-id="' + product.Product.Id + '" data-product="' + product.Product.Name + '" style="Height: 13px;margin-left: 12px;" id="actionPlanTable" class="' + product.Product.Id + '" onchange="addRemoveProduct(&apos;' + product.Product.Id + '&apos;);" checked="checked" value="true"'+(product.enabled ? '' : 'disabled= "disabled"')+'/>'
                    + '</div>'
                    + '<div class="col" style="padding-left: 0px;">'
                    + '<p class="planPackageTableProd">' + product.Product.Name + '</p>'
                    + '</div>'
                    + '<div class="col" style="padding-left: 195px;">'
                    + '<p class="planPackageTableCost" data-product-cost="' + product.Product.Name + '" data-amount="' + product.Product.Name + '">' + formatMoney(product.adjustedPrice) + '</p>'
                    + '</div>'
                    + '<div class="col" style="width: 160px;">'                
                    + '<div class="radio-group">'
                    + '<output type="checkbox" class="radiobtn" id="' + product.Product.Id + 'yearly" name="selector" disabled="disabled">' + pAnnualOne + '</output>'
                    + '<label for="' + product.Product.Id + 'yearly" class="radioLabel ' + product.Product.Id + 'yearlylabel" id="' + product.Product.Id + 'yearlylabel">Yearly</label>'
                    + '<output type="checkbox" class="radiobtn" id="' + product.Product.Id + 'monthly" name="selector" disabled="disabled">' + pMonthly + '</output>'
                    + '<label for="' + product.Product.Id + 'monthly" class="radioLabel ' + product.Product.Id + 'monthlylabel" id="' + product.Product.Id + 'monthlylabel">Monthly</label>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col" style="width: 110px;">'
                    + '<div class="form-floating">'
                    + '<input type="tel" data-product-qty="' + product.Product.Name + '" class="form-control ' + product.Product.Id + 'qty" id="planPackageTableQuantity" style="display: ' + flex + '" value="' + product.currentQuantity + '" oninput="calcQuantityChange(this, &apos;' + product.Product.Name + '&apos;);"/>'
                    + '<output type="tel" data-product-qty="' + product.Product.Name + '" class="form-control" id="planPackageTableQuantityOutput" style="display: ' + none + '; background: rgba(18, 23, 36, 0.2);opacity: 0.75;">' + product.currentQuantity + '</output>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col" style="40px">'
                    + '<p class="planPackageTableSubtotal ' + product.Product.Id + 'subtotal" data-product-subtotal="' + product.Product.Name + '" data-amount="' + product.Product.Name + '">' + formatMoney(product.subtotal) + '</p>'
                    + '</div>'
                    + '</div>';
                }
                
                tBody.innerHTML = tBody.innerHTML + rowData;
                var qtyList = document.querySelectorAll("[data-product-qty]");
                for(var i=0; i < 20; i+=2){
                    qtyList[i].value = qtyList[i+1].value;
                }
                document.getElementById(product.Product.Id + 'yearly').checked = pAnnualOne;
                document.getElementById(product.Product.Id + 'monthly').checked = pMonthly;
                autoChecks(product.Product.Name, {checked: true});
            } else {
                var checkboxList = document.querySelectorAll("[data-product='"+product.Product.Name+"']");
                for(var i=0; i<checkboxList.length; i++){
                    checkboxList[i].checked = false;
                    checkboxList[i].value = false;
                }
                selectedProductsMap.get(prodId).selected = false;
                selectedProductsMap.delete(prodId);
                finalProductsMap.get(prodId).selected = false;
                tempSelectedProducts = Array.from(selectedProductsMap.values());

                //document.getElementById(prodId).childNodes[0].childNodes[0].value = false;
                //document.getElementById(prodId).childNodes[0].childNodes[0].checked = false;
                var rowToDelete = document.getElementById(prodId);
                rowToDelete.remove();

                //deletedProducts.push(pId);
                autoChecks(product.Product.Name, {checked: false});
            }

            // if(productsRelatedToAccess.includes(product.Product.Name)){
            //     autoAmount1800Acc();
            // }
            // if(productsRelatedToAdvisory.includes(product.Product.Name)){
            //     autoAmountAdvisory();
            // }
            // if(productsRelatedToLoanAgreement.includes(product.Product.Name)){
            //     autoAmountLoan();
            // }
            autoAmountBundleItems();
            updateQuoteTotals();
            //syncProdToClient(product);
            syncProdsToClient();     
        }

        function syncProdToClient(product){
            //this only uses the qty at time of adding the product; to-do to fix this?
            socket.connect();
                content = {
                    page: "Prepared Packages",
                    showProgress: false, //determines whether to change to the packages page
                    checked: product.selected, //determines whether to add or remove line item
                    productName: product.Product.Name, //used to determine which products to display
                    productCant: product.currentQuantity, //included in the line item displayed if >1
                    question: null, //not currently in use
                    quoteTotal: formatMoney(getTotalAmountDue())  //used to display the real amount and calculate the fake amount
                }
                socket.emit("private message", {
                    content
                }); 
        }

        function syncProdsToClient(){
            console.log('syncProdsToClient()');
            //this only uses the qty at time of adding the product; to-do to fix this?
            socket.connect();
                content = {
                    page: "Prepared Packages",
                    showProgress: false, //determines whether to change to the packages page
                    checked: true, //determines whether to add or remove line item
                    productListString: JSON.stringify(tempSelectedProducts),
                    quoteTotal: formatMoney(getTotalAmountDue()),
                    status: getBundleStatus()
                }
                socket.emit("private message", {
                    content
                }); 
        }
        function getTotalsDebug(){
            console.log('{!quoteTotalMonthly}');
            console.log('{!quoteTotalAnnual}');
            console.log('{!quoteTotal}');
            console.log(tempSelectedProducts);
        }
        
        function formatMoney(amount){
            if(amount == null){
                return '';
            } else if(amount == 0){
                return '$0.00';
            }
            return '$'+parseFloat(amount).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }
        function updateQuoteTotals(){
            console.log('updateQuoteTotals');
            var splittableTotal = 0;
            var nonsplittableTotal = 0;
            var annualAndOneTimeTotal = 0;
            var monthlyTotal = 0;
            var meteredTotal = 0;

            for(var prod of tempSelectedProducts){
                if(!prod.visible) {
                    if(prod.currentBillingFrequency == 'Monthly' || (prod.Product.Billing_Frequency__c == 'One-Time' && prod.Product.No_Split_Allowed__c)){
                        if(prod.currentBillingFrequency == 'Monthly' && prod.Product.Billing_Frequency__c != 'Monthly'){
                            prod.numOfPayments = 12;
                            finalProductsMap.get(prod.Id).numOfPayments = 12;
                        } else {
                            prod.numOfPayments = 1;
                            finalProductsMap.get(prod.Id).numOfPayments = 1;
                        }
                    } else {
                        prod.numOfPayments = numberOfPayments;
                        finalProductsMap.get(prod.Id).numOfPayments = numberOfPayments;
                    }  
                    continue;
                }
                if(prod.currentBillingFrequency == 'Monthly' || (prod.Product.Billing_Frequency__c == 'One-Time' && prod.Product.No_Split_Allowed__c)){
                    nonsplittableTotal += prod.subtotal;
                    if(prod.currentBillingFrequency == 'Monthly' && prod.Product.Billing_Frequency__c != 'Monthly'){
                        prod.numOfPayments = 12;
                        finalProductsMap.get(prod.Id).numOfPayments = 12;
                    } else {
                        prod.numOfPayments = 1;
                        finalProductsMap.get(prod.Id).numOfPayments = 1;
                    }
                } else {
                    splittableTotal += prod.subtotal;
                    prod.numOfPayments = numberOfPayments;
                    finalProductsMap.get(prod.Id).numOfPayments = numberOfPayments;
                }  
                
                if(prod.currentBillingFrequency == 'Monthly') {
                    monthlyTotal += prod.subtotal;
                } else {
                    annualAndOneTimeTotal += prod.subtotal;
                }
            }
            splittableProductsTotal = splittableTotal;
            nonsplittableProductsTotal = nonsplittableTotal;
            monthlyProductsTotal = monthlyTotal;
            nonmonthlyProductsTotal = annualAndOneTimeTotal;

            
            var minPayments = getMinimumNumberOfPayments();
            if(minPayments > numberOfPayments && payTerms != 'mon'){
                //set financing to the new minimum
                var newTerms;
                if(minPayments > 6){
                    newTerms = payTermsNumToLabel.get(12);
                } else if (minPayments >= 5) {
                    newTerms = payTermsNumToLabel.get(6);
                } else {
                    newTerms = payTermsNumToLabel.get(minPayments);
                }
                calcFinance(newTerms, true, false);
                return;
            }

            //create strings for: Annual+OneTime, Monthly, Total Due, Due Today, and Installment Amount(?)
            var dueTodayString = formatMoney(getDueToday());
            var totalDueString = formatMoney(getTotalAmountDue());
            var annualAndOneTimeString = formatMoney(annualAndOneTimeTotal);
            var monthlyString = formatMoney(monthlyTotal);
            var installString = formatMoney(getInstallmentAmount());
            var quoteTotalSeparatedString = annualAndOneTimeString + ' + ' + monthlyString + '/Mo';
            
            if(!document.getElementById('quoteTotal')){return;}
            document.getElementById('quoteTotal').innerHTML = quoteTotalSeparatedString;
            document.getElementById('quoteText').innerHTML = quoteTotalSeparatedString;
            document.getElementById('totalAnualCost').innerHTML = annualAndOneTimeString;
            document.getElementById('payAmountDue').innerHTML = totalDueString;
            document.getElementById('payAmountToday').innerHTML = dueTodayString;
            document.getElementById('paymentAmount').innerHTML = installString; //financing?

            document.getElementById('finalAmount').innerHTML = dueTodayString;
            document.getElementById('finalAmou').innerHTML = dueTodayString;

            if(monthlyTotal > 0) {
                document.getElementById('monthAmountText').style.display = 'block'; 
                document.getElementById('finalMonthAmount').innerHTML = monthlyString; 
            } else {
                document.getElementById('finalMonthAmount').innerHTML = ''; 
                document.getElementById('monthAmountText').style.display = 'none'; 
            }

            const date = new Date();
            let day = date.getDate();
            document.getElementById('numDay').innerHTML = day;

            socket.connect();
            content = {
                showProgress:false,
                page: "Payment Details",
                name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                total: totalDueString, //sets element with id=balanceSectionAmount
                due: dueTodayString, //sets element with id=balanceSectionTitle
                installAmount: installString, //sets element with id=monthlyDue
                payTerms: payTerms
            }
            socket.emit("private message", {
                content
            });

            
            //Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.updateQuoteTotals', quoteTotalMonthly, quoteTotalAnnual, function (a,b){console.log(a);console.log(b);});
        }

        var lastTempTerms = payTerms;
        //to-do: factor in no split allowed field?
        function calcFinance(payte, syncToClient, showClient) {
            //lastProductData = JSON.parse(JSON.stringify(finalProducts));
            console.log('calcFinance '+showClient+','+payte);
            //lastPayTerms = payTerms;
            //var payTe = document.getElementById('payTerms').value;
            payTerms = payTermsLabelToValue.get(payte);
            switch (payte) {
                case 'No Financing':
                    //payTerms = 'yrl';
                    numberOfPayments = 1;
                    document.getElementById('financingScript').style.display = "none";                
                    document.getElementById('noFinancingScript').style.display = "block";
                break;
                case '2 Pay':
                    //payTerms = '2pay';
                    numberOfPayments = 2;
                    document.getElementById('financingScript').style.display = "block";                
                    document.getElementById('noFinancingScript').style.display = "none";
                    document.getElementById('planLength').innerHTML = '1';
                break;
                case '3 Pay':
                    //payTerms = '3pay';
                    numberOfPayments = 3;
                    document.getElementById('financingScript').style.display = "block";                
                    document.getElementById('noFinancingScript').style.display = "none";
                    document.getElementById('planLength').innerHTML = '2';
                break;
                case '4 Pay':
                    //payTerms = '4pay';
                    numberOfPayments = 4;
                    document.getElementById('financingScript').style.display = "block";                
                    document.getElementById('noFinancingScript').style.display = "none";
                    document.getElementById('planLength').innerHTML = '3';
                break;
                case '6 Pay':
                    //payTerms = '6pay';
                    numberOfPayments = 6;
                    document.getElementById('financingScript').style.display = "block";                
                    document.getElementById('noFinancingScript').style.display = "none";
                    document.getElementById('planLength').innerHTML = '5';
                break;
                case 'Apply for Monthly Installments':
                    //payTerms = 'mon';
                    numberOfPayments = 12;
                    document.getElementById('financingScript').style.display = "block";                
                    document.getElementById('noFinancingScript').style.display = "none";
                    document.getElementById('planLength').innerHTML = '11';
                break;
            }
            if(payTerms == 'mon'){
                for(var prod of finalProducts){
                    if(prod.Product.Billing_Frequency__c != 'One-Time'){
                        // prod.currentBillingFrequency = 'Monthly';
                        // var monthlyOnes = document.getElementsByClassName(oldProd.Product.Id + 'monthly');
                        // var yearlyOnes = document.getElementsByClassName(oldProd.Product.Id + 'yearly');
                        // for(var r = 0; r < monthlyOnes.length; r++) {
                        //     monthlyOnes[r].checked = true;
                        //     monthlyOnes[r].value = true;
                        //     yearlyOnes[r].checked = false;
                        //     yearlyOnes[r].value = false;
                        // }
                        // updateProductSubtotal(prod.Product.Id);
                        calcFrecuencyChange({checked: true, id: 'monthly'}, prod.Product.Id, true);
                    }
                }
                //autoAmountBundleItems();                 
            } else if (lastPayTerms == 'mon' || lastTempTerms == 'mon'){
                for(var prod of finalProducts){
                    if(prod.Product.Billing_Frequency__c == 'Annual' || prod.Product.Billing_Frequency__c == 'Monthly'){
                        var defaultFrequency = (prod.Product.Billing_Frequency__c == 'Annual' ? 'yearly' : 'monthly');
                        calcFrecuencyChange({checked: true, id: defaultFrequency}, prod.Product.Id, true);
                    }
                }
            }
            document.getElementById('planTerms').innerHTML = payte;
            document.getElementById('payTerms').value = payte;
            
            lastTempTerms = payTerms;
            updateQuoteTotals();
            syncProdsToClient(); 
            if(syncToClient == true) {
                socket.connect();
                content = {
                    showProgress: (showClient == false)  ? false : true,
                    page: "Payment Details",
                    name: "{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}",
                    total: formatMoney(getTotalAmountDue()), //sets element with id=balanceSectionAmount
                    due: formatMoney(getDueToday()), //sets element with id=balanceSectionTitle
                    installAmount: formatMoney(getInstallmentAmount()) //sets element with id=monthlyDue
                }
                socket.emit("private message", {
                    content
                });
            }
            return;
        }

        function saveBusinessName() {
            document.getElementById('waitingScreen').style.display = "flex";
            var name = document.getElementById('businessName').value;
            var type = $('[data-id="entityIntro"]').val();
            
            if(name != '' && name != null) {
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.saveBusinessData', name, businessId, type, accId, function(r,e) {
                    if(e.status) {
                        nextSection(1, '1-800Accountant Blast', 'formBody', 'blastBody');
                        goToBlast();
                        //CallApexMethod();

                        $('[data-id="entity"]').val(type);
                        entitySelected = type;
                        document.getElementById('waitingScreen').style.display = "none";
                        document.getElementById("menuOpts").value = '1-800Accountant Blast';
                        //currentPageIndex++;
                    } else if(e.type === 'exception') {
                        alert(e.message);
                    } else {
                        alert(e.message);
                    }
                });
            }
        }

        function saveClientInfo(infoType) {
            var businessOwnerId = "{!businessOwner.Id}";
            var email = '';
            var phone = '';
            var address = '';
            var city = '';
            var state = '';
            var zip = '';
            var country = '';

            if(infoType == 'personal') {
                email = document.getElementById('emailModalEditClientInfo').value;
                phone = document.getElementById('phoneModalEditClientInfo').value;
                address = '';
                city = '';
                state = '';
                zip = '';
                country = '';
            } 

            if(infoType == 'billing') {
                email = '';
                phone = '';
                address = document.getElementById('streetAddress').value;
                city = document.getElementById('cityAddress').value;
                state = $('[data-id="stateAddress"]').val();
                zip = document.getElementById('zipAddress').value;
                country = $('[data-id="countryAddress"]').val();
            }

            if(businessOwnerId != '' && businessOwnerId != null) {
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.saveClientInfo', infoType, businessId, businessOwnerId, accId, email, phone, address, city, state, zip, country, function(r,e) {
                    if(e.status) {
                        if(infoType == 'personal') {
                            document.getElementById('busOwnerPhone').innerHTML = phone;
                            document.getElementById('busOwnerEmail').innerHTML = email;
                            closeModalEditClientInfo();
                        } 
                        if(infoType == 'billing') {
                            document.getElementById('busOwnerAddress').innerHTML = address;
                            document.getElementById('busOwnerCity').innerHTML = city + ',';
                            document.getElementById('busOwnerState').innerHTML = state;
                            document.getElementById('busOwnerZip').innerHTML = zip;
                            document.getElementById('busOwnerCountry').innerHTML = country;
                            closeModalEditBillingAdd();
                        }
                    } else if(e.type === 'exception') {
                        if(infoType == 'personal') {
                            document.getElementById("modalEditClientInfoErrors").innerHTML = e.message + "<br/>\n<pre>" + e.where + "</pre>";
                        } 
                        if(infoType == 'billing') {
                            document.getElementById("modalEditBillingAddErrors").innerHTML = e.message + "<br/>\n<pre>" + e.where + "</pre>";
                        }
                    } else {
                        if(infoType == 'personal') {
                            document.getElementById("modalEditClientInfoErrors").innerHTML = e.message + "<br/>\n<pre>" + e.where + "</pre>";
                        } 
                        if(infoType == 'billing') {
                            document.getElementById("modalEditBillingAddErrors").innerHTML = e.message + "<br/>\n<pre>" + e.where + "</pre>";
                        }
                    }
                });
            }
        }
        
        function savePayTerms() {
            //lastPayTerms = document.getElementById("payTerms").value;
            closeModalEditPayTerms(false);
            //calcFinance(true);
        }

        function skipToSale() {
            hideAll();
            closeModalOptions();
            document.getElementById('features').style.display = "block";
            nextSection(14, '1-800Accountant Introduction', 'postPurchase', 'features');
        }

        function skipDoNotSave() {
            hideAll();
            closeModalOptions();
            confimCloseModalEditPackage();
            document.getElementById('features').style.display = "block";
            nextSection(14, '1-800Accountant Introduction', 'postPurchase', 'features');
        }

        function updateStates() {
            var stateResi = $('[data-id="state"]').val();
            stateBilli = "{!businessOwner.State__c}";

            if (stateBilli == '' || stateBilli == null) { 
                stateBilli = stateResi;
            }
            document.getElementById("busOwnerState").innerHTML = stateBilli;
            $('[data-id="stateAddress"]').val(stateBilli);
        }

        function updateEntity(entityInput) {
            if(entityInput.value != entitySelected){
                var menuOpts = document.getElementById('menuOpts');
                var ind = 0;
                var pageNames = getPageNames();
                var originalLength = menuOpts.options.length;
                for (let i = 0; i < originalLength; i++) {
                    menuOpts.options.remove(0); //clear the list
                }
                for(var page of pageNames){ //populate with the appropriate pages
                    menuOpts[ind++] = new Option(page, page);
                }
                for (let i = 1; i < menuOpts.options.length; i++) {
                    menuOpts.options[i].setAttribute("disabled", "disabled"); //disable all dropdown options except the first
                }
            }
            entitySelected = entityInput.value;
            document.getElementById('noDefaultEntityText').style.display = 'none';
            document.getElementById('selectedEntityText').style.display = 'block';
            document.getElementById('selectedEntityText').innerHTML = 'And your business is an '+entitySelected+', right?';
            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
            document.querySelector('[data-id=Entity_Typequestion]').value = entitySelected;
            document.querySelector('[data-id=entityIntro]').value = entitySelected;
            
        }

        function updateBusinessName(nameInput) {
            document.getElementById('businessNameQuestion').innerHTML = 'Just to verify, "'+nameInput.value+'" is your business name, right?';
            if(getIntroQuestionsAnswered()){
                document.getElementById('start').removeAttribute('disabled'); 
                document.getElementById('start').style.opacity = "1";
            } else {
                document.getElementById('start').setAttribute("disabled", "disabled");
                document.getElementById('start').style.opacity = "0.25";
            }
        }

        function searchProds(name) {
            console.log('searchProds '+name);
            const rowList = document.getElementById("AllPlan").childNodes[0].childNodes;
            for (let i = 1; i < rowList.length; i++) {
                var className = rowList[i].className;
                if(!className){
                    continue;
                }
                className = className.replace('row ','');
                if(name != 'all' && name.value != '' && name.value != null) {
                    if(className != null && className != '' && className != undefined) { 
                        className = className.toLowerCase();
                        if(!className.includes(name.value)) {
                            rowList[i].style.display = 'none';
                        }
                    }
                } else {
                    if(className != null && className != '' && className != undefined) { 
                        if(entity != 'Personal Only' && className == 'Personal Tax Advisory') {
                            rowList[i].style.display = 'none';
                        } else if(!advisoryAddons.includes(className) && !bundleNameToBundleProductName.keys().toArray().includes(className)){
                            rowList[i].style.display = 'table-row';
                        }
                    }
                }
            }
        }

        var oppId = "{!opportunity.Id}";
        function doSubmit() {
            var environment = "{!environment}";
            //var oppId = "{!opportunity.Id}"; //generateQuoteButton
            document.getElementById('generateQuoteButton').textContent = "Next Section";
            var selectedProducts = '{!tempSelectedProducts}';
            var bundleName = getBundleStatus() == 'removed' ? '' : eligibleBundle;

            if(flagDoSubmit == false) {
                document.getElementById('waitingScreen').style.display = "flex";
                console.log('doSubmit');
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.doSubmit', environment, JSON.stringify(tempSelectedProducts), oppId, accId, payTerms, bookkeepingStartDate, bookkeepingEndDate, getTotalAmountDue(), bundleName, function(r,e) {
                    if(e.status) {
                        var data = e.result;
                        const dataList = data.split(",");
                        if(dataList[1] == 'VIP') {
                            schedulerURL = dataList[0] + '?TID=DiscoveryVIP' + '&WID=' + dataList[2] + '&EmailCampaignID=' + dataList[3];
                        } else {
                            schedulerURL = dataList[0] + '?TID=' + dataList[1] + '&WID=' + dataList[2] + '&EmailCampaignID=' + dataList[3];
                        }
                        
                        document.getElementById('waitingScreen').style.display = "none";
                        flagDoSubmit = true;
                    } else {
                        console.log('e.exception: ' + e.type);
                    }
                });  
            }  
        }

        function getChargeOverURL() {

            var oppId = "{!opportunity.Id}";

            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.getChargeOverURL', oppId, function(r,e) {
                if(e.status) {
                    //var coURL = e.result + '?utm_source=Sales&utm_term=Sales&utm_medium=Pricing+Calculator';
                    var coURL = e.result + '?utm_source=Sales&utm_term=Sales&utm_medium=Guided+Selling';
                    document.getElementById('Changeover').src = coURL;

                    secondaryDisp = 'Sale';  
                    whenDisposition = 'beforePayment';

                } else {
                    console.log('e.exception: ' + e.type);
                }
            });    

        }

        function endPresentation() {
            whenDisposition = 'sale';
            saveNoteEditor();
            dispositionCall();
        }

        function optionEnd(reason) {
            document.getElementById('stopPres').style.opacity = 1;
            document.getElementById('stopPres').removeAttribute('disabled'); 

            if(reason.value == 'notLLC') {
                notEntityType = 'noLLC';
            } else if(reason.value == 'incomplete') {
                secondaryDisp = 'Cancelled';
            } else if(reason.value == 'notInterested') {
                secondaryDisp = 'Not Interested'; 
            }        
        }

        function closePresentation() {
            saveNoteEditor();
            dispositionCall();
        }

        function dispositionCall() {

            socket.connect();
            var id = '{!$CurrentPage.parameters.rId}';
            var siteToShow = '';
            console.log('Id of the record to open the event: ' + id);

            if(whenDisposition == 'early' || whenDisposition == 'beforePayment') {
                siteToShow = 'notSale';
            } else if(whenDisposition == 'afterPayment' || whenDisposition == 'sale') {
                siteToShow = 'sale';
            }  

            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.dispositionEvent', id, secondaryDisp, primaryDisp, accId, function(r,e) {
                if(e.status) {
                    content = {
                        page: siteToShow, 
                    }
                    socket.emit("private message", {
                        content
                    });

                    //window.open('https://1800accountant--staging.sandbox.lightning.force.com/' + id + '');
                    window.open('{!sfBaseUrl}'+'/' + id + '');
                    window.close();
                } else {
                    console.log('e.exception: ' + e.type);
                }
            });
        }

        function showFicaExample() {
            document.getElementById('ficaBtns').style.display = "none";
            scrollToDiv('#verticalSectLine3', '#selfEmploymentTaxLLC', 1100);
            getSlideTwo();
        }

        function scrollToDiv(divToScroll, mainDiv, num) {
            var container = $(mainDiv);
            var scrollTo = $(divToScroll);
            var position = scrollTo.offset().top - (container.offset().top + container.scrollTop()) + num;
            container.animate({
                scrollTop: position
            });
        }

        function changePaperlossSalaryAmount(selection) {
            var selectedValue = selection.value;
            document.getElementById("amountforExample").innerHTML = selectedValue;
            var selectValue = selectedValue.replace(',','');

            var optOne = '';
            var optTwo = '';
            var optThree = '';
            var optFour = '';

            if(selectedValue == '30,000') {
                optOne = '5,000';
                optTwo = '10,000';
                optThree = '15,000';
                optFour = '20,000';
            } else if(selectedValue == '50,000') {
                optOne = '5,000';
                optTwo = '10,000';
                optThree = '20,000';
                optFour = '30,000';
            } else if(selectedValue == '75,000') {
                optOne = '10,000';
                optTwo = '20,000';
                optThree = '35,000';
                optFour = '50,000';
            } else if(selectedValue == '100,000') {
                optOne = '10,000';
                optTwo = '25,000';
                optThree = '50,000';
                optFour = '75,000';
            }

            var options = document.getElementById("businessLossAmount").options;
            options[1].innerHTML = optOne;
            options[2].innerHTML = optTwo;
            options[3].innerHTML = optThree;
            options[4].innerHTML = optFour;

            var res = '';
            var loss = '';
            var businessLossAmount = document.getElementById("businessLossAmount").value;
            if(null != businessLossAmount && '' != businessLossAmount && undefined != businessLossAmount && 'Select an Amount' != businessLossAmount) {
                loss = businessLossAmount;
                businessLossAmount = businessLossAmount.replace(',','');
                res = parseInt(selectValue) - parseInt(businessLossAmount);
                res = res.toLocaleString('en-US');
                document.getElementById("incomeforExample").innerHTML = res;
            }

            socket.connect();
            content = {
                salaryAmount: selectedValue,
                businessLossAmount: loss, 
                agi: res
            }
            socket.emit("private message", {
                content
            });
        }

        function changePaperlossbusinessLossAmount(selection) {
            var selectedValue = selection.value;
            var selectValue = selectedValue.replace(',','');
            var incomeValue = document.getElementById("amountforExample").innerHTML;
            incomeValue = incomeValue.replace(',','');
            var res = parseInt(incomeValue) - parseInt(selectValue);

            res = res.toLocaleString('en-US');

            document.getElementById("incomeforExample").innerHTML = res;

            socket.connect();
            content = {
                businessLossAmount: selectedValue, 
                agi: res
            }
            socket.emit("private message", {
                content
            });
        }

        function showAllAnswers(show) {
            for(var question of discoveryQuestions){
                var showQuestion = show && question.Answered && question.QuestionType != 'Text Only';
                hideQuestionFromClient(showQuestion, question.QuestionText);
                document.querySelector('[data-id='+question.DevName+'checkbox]').checked = showQuestion;
            }
            return;

            if(requiredFields.includes("firstBusiness") && !document.getElementById('firstBusiness').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Is this your first business?');
            }
            if(requiredFields.includes("years") && !document.getElementById('years').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many years have you been in business?');
            }
            if(requiredFields.includes("entity") && !document.getElementById('entity').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What entity type is your business?');
            }
            if(requiredFields.includes("industry") && !document.getElementById('industry').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What industry is your business in?');
            }
            if(requiredFields.includes("domState") && !document.getElementById('domState').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What is your state of incorporation?');
            }
            // if(requiredFields.includes("state") && !document.getElementById('state').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'What is your state of residence?');
            // }
            if(requiredFields.includes("foreignState") && !document.getElementById('foreignState').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What is your foreign state of incorporation?');
            }
            if(requiredFields.includes("startup") && !document.getElementById('startup').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How much have you invested so far in start-up costs?');
            }
            if(requiredFields.includes("revenue") && !document.getElementById('revenue').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What do you anticipate your revenue to be over the next 12 months?');
            }
            if(requiredFields.includes("profit") && !document.getElementById('profit').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What do you project your 1st year profit to be over the next 12 months?');
            }
            // if(requiredFields.includes("investor") && !document.getElementById('investor').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'What is your total investor funding?');
            // }
            if(requiredFields.includes("transactions") && !document.getElementById('transactions').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many monthly bookkeeping transactions do you have?');
            }
            if(requiredFields.includes("owners") && !document.getElementById('owners').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many owners does your business have?');
            }
            // if(requiredFields.includes("foreignOwners") && !document.getElementById('foreignOwners').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'How many owners are outside the USA?');
            // }
            if(requiredFields.includes("runPayroll") && !document.getElementById('runPayroll').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Have you run payroll before?');
            }
            if(requiredFields.includes("hasEmpContractors") && !document.getElementById('hasEmpContractors').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Do you currently have any employees?');
            }
            if(requiredFields.includes("employees") && !document.getElementById('employees').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many employees do you have?');
            }
            // if(requiredFields.includes("contractors") && !document.getElementById('contractors').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'How many contractors do you have?');
            // }
            if(requiredFields.includes("filingStatus") && !document.getElementById('filingStatus').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What is your tax filing status?');
            }
            if(requiredFields.includes("household") && !document.getElementById('household').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What was your household W-2 income last year?');
            }
            // if(requiredFields.includes("foreignIncome") && !document.getElementById('foreignIncome').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'Do you have any foreign sourced income?');
            // }
            if(requiredFields.includes("hasRentals") && !document.getElementById('hasRentals').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Do you currently have any rental properties?');
            }
            if(requiredFields.includes("rental") && !document.getElementById('rental').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many rental properties do you have?');
            }
            // if(requiredFields.includes("k1s") && !document.getElementById('k1s').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'How many K-1s are from other investments?');
            // }
            if(requiredFields.includes("workingHome") && !document.getElementById('workingHome').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Will you be working from home?');
            }
            if(requiredFields.includes("footage") && !document.getElementById('footage').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'What is the approximate square footage of your home office?');
            }
            if(requiredFields.includes("drive") && !document.getElementById('drive').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'Will you use your personal vehicle for business purposes?');
            }
            if(requiredFields.includes("miles") && !document.getElementById('miles').childNodes[1].childNodes[3].childNodes[0].checked) {
                hideQuestionFromClient(show, 'How many business-related miles do you estimate youll drive per year?');
            }
            // if(requiredFields.includes("website") && !document.getElementById('website').childNodes[1].childNodes[3].childNodes[0].checked) {
            //     hideQuestionFromClient(show, 'Will your business have a web or e-commerce presence?');
            // }
        }

        function sendQuoteByEmail() {
            var oppId = "{!opportunity.Id}";

            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.sentEmail', oppId, function(r,e) {
                if(e.status) {
                    document.getElementById('emailSent').style.display = "flex";
                } else {
                    console.log('e.exception: ' + e.type);
                }
            });    
        }

        function followUpCall() {
            var conId = "{!opportunity.Account.Primary_Contact__c}";
            var userName = "{!opportunity.Account.Owner.Name}";
            var userId = "{!opportunity.Account.Owner.Id}";
            //window.open('https://1800accountant.com/sfapi/schedule/index_stage.php?WID=' + conId + '&Setter=' + userName + '&SetterID=' + userId + '');
            window.open('{!schedulerBaseUrl}'+'?WID=' + conId + '&Setter=' + userName + '&SetterID=' + userId + '');

            isfinalScreen = true;
            secondaryDisp = 'Follow-Up';  
            whenDisposition = 'beforePayment';
        }

        function openNoteEditor() {
            document.getElementById('addNoteBtn').style.display = "none";
            document.getElementById('modalNotes').style.display = "block";
        }

        function closeNoteEditor() {
            document.getElementById('addNoteBtn').style.display = "block";
            document.getElementById('modalNotes').style.display = "none";
        }

        function saveNoteEditor() {
            var title = document.getElementById("noteTitle").value; 
            var body = document.getElementById("noteBody").value;
            var accId = '{!opportunity.Account.Primary_Contact__c}';

            if(title != '' && body != '') {
                Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.saveNote', accId, title, body, function(r,e) {
                    if(e.status) {
                        // document.getElementById("noteTitle").value = ''; 
                        // document.getElementById("noteBody").value = '';
                    } else {
                        console.log('e.exception: ' + e.type);
                    }
                });
            }
        }

        function isOpportunityPaid() {
            var oppId = "{!opportunity.Id}";
            Visualforce.remoting.Manager.invokeAction('GuidedSellingControllerExtension.isOpportunityPaid', oppId, function(r,e) {
                if(e.status) {
                    if(e.result == 'Closed Won') {
                        nextSection(31, 'Post Purchase', 'paymentDetails', 'postPurchase');
                    } else {
                        document.getElementById("PostPurchaseError").innerHTML = 'Please finish the payment in order to continue with the follow up.';
                    }
                } else {
                    console.log('e.exception: ' + e.type);
                }
            });          
        }

    </script>
</apex:outputPanel>
<body class="body" id="body" onload="loadingPage()">
    <div class="se-pre-con"></div>
    <p id="onTime" style="display: none;"></p>
    <p id="originalValue" style="display: none;"></p>
    <div id="waitingScreen">
        <div id="whiteWaiting">
            <div id="loading" style="margin-left: 46%; margin-top: 17%;">
                <img id="waiting" src="{!$Resource.waiting}" />
            </div>
        </div>
    </div>
    <div class="slds-scope">
        <div class="myapp">
            <div class="slds-grid slds-wrap">
                <div class="slds-grid_vertical">
                    <!-- Section 1 Screen divided: Client details / What client sees -->
                    <div class="slds-col slds-size--1-of-1 slds-small-size--2-of-2 slds-medium-size--4-of-4">
                        <!-- Client details -->
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="formClientDet">
                            <div class="quote" id="quoteEdit">
                                <table id="quoteTable">
                                    <tr>
                                        <td>
                                            <p class="quoteTitle">Current Quote</p>
                                        </td>
                                        <td>
                                            <!-- <p class="quoteText" id="quoteText" >${!quoteTotalAnnual} + ${!quoteTotalMonthly}/Mo</p> -->
                                            <p class="quoteText" id="quoteText">$0 + $0/Mo</p>
                                        </td>
                                        <td>
                                            <button class="start" style="color: white;" id="quoteEdit" onclick="showModalEditPackage();">Edit</button>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Client Details
                                </p>
                            </div>
                            <div class="accInfo">
                                <p class="AccName">
                                    {!opportunity.Account.Name}
                                </p>
                                <p class="leadSource">
                                    Lead from {!opportunity.Account.Lead_Source__c}
                                </p>
                            </div>
                            <div class="accContacts">
                                <table id="contTable">
                                    <thead></thead>
                                    <tbody id="tableBody">
                                        <tr>
                                            <td>
                                                <spam class="contIni">
                                                    <apex:outputText value="{!LEFT(businessOwner.First_Name__c,1)}"></apex:outputText>
                                                </spam>
                                            </td>
                                            <td>
                                                <div class="contInfo">
                                                    <p class="contName">{!businessOwner.First_Name__c} {!businessOwner.Last_Name__c}</p>
                                                    <p class="contRole">Primary Contact</p>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="contContaInfo">
                                                    <p class="contPhone" id="contphone">{!businessOwner.Phone__c}</p>
                                                    <p class="contEmail">{!businessOwner.Email__c}</p>
                                                    <p class="contContactId" style="display: none;">{!businessOwner.Id}</p>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="contMore">
                                                    <span class="material-icons" onClick="prinrowMenu0();" id="btnSubMenu">more_vert</span>
                                                    <div id="prinmenu0" class="dropdown-content">
                                                        <a onclick="editPrimary(this);"><span class="material-icons" id="icon">edit</span>&nbsp;Edit Partner</a>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- What client sees -->
                        <div class="slds-box slds-box_x-small slds-text-align_center slds-m-around--x-small" id="formClientView">
                            <button class="openClientView" onclick="showModalClientScreen();"><span class="material-icons" style="vertical-align: middle; color: rgba(18, 23, 36, 0.65);">open_in_full</span></button>
                            <iframe
                                id="inlineFrameExample"
                                title="Inline Frame Example"
                                height="100%"
                                width="100%"
                                class="dims"
                                scrolling="yes"
                                src="{!siteBaseUrl}/Client?rId={!$CurrentPage.parameters.rId}&session={!$CurrentPage.parameters.sessionId}&token={!$CurrentPage.parameters.pToken}"
                            >
                            </iframe>
                            <p class="noteClientView">What <span id="additionalName0">{!opportunity.Account.Primary_Contact__r.FirstName} {!opportunity.Account.Primary_Contact__r.LastName}</span> is seeing</p>
                        </div>
                    </div>
                </div>
                <!-- Section 2 Introduccion/Script -->
                <div class="slds-col slds-size--1-of-1 slds-small-size--1-of-2 slds-medium-size--2-of-4">
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="menuBody">
                        <table class="menu">
                            <tr>
                                <td>
                                    <div class="form-floating">
                                        <select class="form-select" id="menuOpts" onchange="goToPage()" style="padding-top: 10px">
                                           
                                        </select>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-btn">
                                        <button class="btnStop" onclick="showModalCancel();"><i class="fas fa-times">&nbsp;&nbsp;</i>End Presentation</button>
                                    </div>
                                </td>
                            </tr>
                        </table>
                        <hr />
                        <div class="modal" id="modalClientScreenn">
                            <div id="modalClientScreen">
                                <div id="modalHeader" style="padding-top: 1%; position: relative; background: white;">
                                    <p class="modalHeaderTitle" style="display: inline-flex; padding: 0px 0px 13px 55px;">
                                        Example of what &nbsp;<span id="additionalName0">{!opportunity.Account.Primary_Contact__r.FirstName} {!opportunity.Account.Primary_Contact__r.LastName}</span>&nbsp; should be seeing
                                    </p>
                                    <button class="modalHeaderClose" style="margin-top: 0%; padding: 0px 55px 15px 0px; color: rgba(18, 23, 36, 0.91);" onclick="closeModalClientScreen();"></button>
                                </div>
                                <div class="clientContent">
                                    <div id="modalBody">
                                        <iframe
                                            id="inlineFrameExampleClient"
                                            title="Inline Frame Example"
                                            height="100%"
                                            width="100%"
                                            class="dimss"
                                            scrolling="yes"
                                            src="{!siteBaseUrl}/Client?rId={!$CurrentPage.parameters.rId}&session={!$CurrentPage.parameters.sessionId}&token={!$CurrentPage.parameters.pToken}"
                                        >
                                        </iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalSkip">
                            <div class="content">
                                <div id="modalBody">
                                    <p class="modalTitle">
                                        Do you want to skip the rest of the presentation and go to the available packages?
                                    </p>
                                    <br />
                                    <p class="modalDesc">
                                        Youll still be able to adjust the packages.
                                    </p>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalSkip();">Cancel</button>
                                    <button class="start" style="color: white;" id="skiptoSalee" onclick=""><i class="fas fa-forward">&nbsp;&nbsp;</i>Skip to Quote</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalCancel">
                            <div class="content">
                                <div id="modalBody">
                                    <p class="modalTitle">
                                        Why are you ending the presentation?
                                    </p>
                                    <br />
                                    <p class="modalOption">
                                        Select an option (Required)
                                    </p>
                                    <input type="radio" id="notLLC" name="reasonEnding" value="notLLC" onchange="optionEnd(this);" />
                                    <label for="notLLC" style="font-weight: 400; font-size: 16px; line-height: 24px; letter-spacing: 0.01em; color: rgba(18, 23, 36, 0.91);">The clients business entity is not an LLC</label>
                                    <br />
                                    <input type="radio" id="incomplete" name="reasonEnding" value="incomplete" onchange="optionEnd(this);" />
                                    <label for="incomplete" style="font-weight: 400; font-size: 16px; line-height: 24px; letter-spacing: 0.01em; color: rgba(18, 23, 36, 0.91);">The consultation is incomplete</label>
                                    <br />
                                    <input type="radio" id="notInterested" name="reasonEnding" value="notInterested" onchange="optionEnd(this);" />
                                    <label for="notInterested" style="font-weight: 400; font-size: 16px; line-height: 24px; letter-spacing: 0.01em; color: rgba(18, 23, 36, 0.91);">The client is not interested</label>
                                    <div id="errorMess" style="display: inline-flex;">
                                        <span class="material-icons" id="errorMessageIcon" style="padding-left: 2%; padding-top: 3%;">warning_amber</span>
                                        <p id="errorMessageText">
                                            Ending the presentation will not hang up your phone call. You will need to return to your phone application to disconnect the call with the client.
                                        </p>
                                    </div>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalCancel();">Cancel</button>
                                    <button class="start" style="color: white;" disabled="disabled" id="stopPres" onclick="closePresentation();"><i class="fas fa-times">&nbsp;&nbsp;</i>Stop Presentation</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modal">
                            <div class="content">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Add a Partner</p>
                                            </td>
                                            <td>
                                                <button class="modalHeaderClose" onclick="closeModal();"></button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBody">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="firstName" name="firstName" placeholder="Partners First Name (Required)" required="required" onkeyup="disableButton();" />
                                        <label for="firstName">Partners First Name (Required)</label>
                                    </div>
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Partners Last Name (Required)" required="required" onkeyup="disableButton();" />
                                        <label for="lastName">Partners Last Name (Required)</label>
                                    </div>
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="role" placeholder="Role (Optional)" onkeyup="disableButton();" />
                                        <label for="role">Role (Optional)</label>
                                    </div>
                                    <div class="form-floating">
                                        <input type="email" class="form-control" id="email" name="email" placeholder="Email (Required)" required="required" onkeyup="disableButton();" style="width: 360px;" />
                                        <label for="email">Email (Required)</label>
                                        <p id="emailFormatError" style="color: red;"></p>
                                    </div>
                                    <div class="form-floating">
                                        <input type="tel" class="form-control" id="phone" name="phone" placeholder="Phone (Required)" required="required" onkeyup="disableButton();" style="width: 240px;" />
                                        <label for="phone">Phone (Required)</label>
                                    </div>
                                    <p id="contactId" style="display: none;"></p>
                                    <p id="partnerResponseErrors" style="color: red;"></p>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModal();">Cancel</button>
                                    <button class="btnAddRow" id="btnAddRow" onclick="addRow(this); return false;">Add Partner</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="confirmQuoteModal">
                            <div class="content" style="padding-top: 2%; width: 500px; transform: translateY(100%);">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Do you want to generate the quote?</p>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBody" style="padding-top: 7px; padding-bottom: 50px;">
                                    <div class="form-floating">
                                        <label style="padding: 0;">After generating the quote you will only be able to make edits (such as payment terms and adding/removing products) by going to the Opportunity in Salesforce.</label>
                                    </div>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalConfirmQuote();" style="padding: 10px 16px;">Keep Editing</button>
                                    <button
                                        type="button"
                                        class="start"
                                        id="generateQuoteButtonModal"
                                        style="color: white; opacity: 1;"
                                        onclick="closeModalConfirmQuote();doSubmit();nextSection(30, 'Payment Details', 'verifyInformation', 'paymentDetails');getChargeOverURL();"
                                    >
                                        Generate the Quote
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalEditPackage">
                            <div class="content" style="width: 980px; padding-bottom: 10px; height: 570px; transform: translateY(15%);">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Edit Package</p>
                                            </td>
                                            <td>
                                                <button class="modalHeaderClose" id="closeOptions" onclick="closeModalEditPackage();"></button>
                                                <button class="btnmodal" id="skiptoSale" style="float: right; margin-right: 4%;" onclick="showOptionsToClose();"><i class="fas fa-forward">&nbsp;&nbsp;</i>Skip to Quote</button>
                                                <button class="start" style="color: white; opacity: 1; float: right; margin-right: 4%;" id="discardEditing" onclick="confimCloseModalEditPackage();">
                                                    <i class="fas fa-times">&nbsp;&nbsp;</i>Discard Changes
                                                </button>
                                                <button class="start" style="float: right; margin-right: 4%;" id="keepEditing" onclick="backToEditing();">
                                                    <span class="material-icons" style="vertical-align: middle;">keyboard_return&nbsp;&nbsp;</span>Keep Editing
                                                </button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBodyPackage">
                                    <div class="tabs">
                                        <div class="tab-2">
                                            <label for="tab2-1" id="tab2-1label">Current Plan</label>
                                            <input id="tab2-1" name="tabs-two" type="radio" checked="checked" onclick="displayTablePlan('currentPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-2" id="tab2-2label">All</label>
                                            <input id="tab2-2" name="tabs-two" type="radio" onclick="displayTablePlan('AllPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-3" id="tab2-3label">Frequent</label>
                                            <input id="tab2-3" name="tabs-two" type="radio" onclick="displayTablePlan('frequentPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-4" id="tab2-4label">Business</label>
                                            <input id="tab2-4" name="tabs-two" type="radio" onclick="displayTablePlan('businessPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-5" id="tab2-5label">Personal</label>
                                            <input id="tab2-5" name="tabs-two" type="radio" onclick="displayTablePlan('personalPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-6" id="tab2-6label">Payroll</label>
                                            <input id="tab2-6" name="tabs-two" type="radio" onclick="displayTablePlan('payrollPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-7" id="tab2-7label">Bookkeeping</label>
                                            <input id="tab2-7" name="tabs-two" type="radio" onclick="displayTablePlan('bookkeepingPlan', this, false);" />
                                            <div></div>
                                        </div>
                                        <div class="tab-2">
                                            <label for="tab2-8" id="tab2-8label">Entity Formation</label>
                                            <input id="tab2-8" name="tabs-two" type="radio" onclick="displayTablePlan('entityFormationPlan', this, false);" />
                                            <div></div>
                                        </div>
                                    </div>
                                    <table id="modalBodyTitleTable">
                                        <tr>
                                            <td>
                                                <div class="form-floating" style="margin-bottom: 2%; width: 55%;">
                                                    <input
                                                        type="text"
                                                        placeholder="Search products"
                                                        class="form-control"
                                                        id="searchProd"
                                                        style="margin-bottom: 5%; padding-left: 40px; padding-top: 9px; width: 300%;"
                                                        onkeyup="searchProds(this)"
                                                    />
                                                    <label for="searchProd" id="searchProd">
                                                        <span class="material-icons" style="color: rgba(18, 23, 36, 0.65);">
                                                            <span class="material-icons">search</span>
                                                        </span>
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                    <apex:outputpanel id="dProds">
                                        <div data-checkbox-group="data-checkbox-group" id="currentPlan">
                                            <div class="planPackageTable" id="selectedPlan">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input
                                                            data-master-checkbox="data-master-checkbox"
                                                            type="checkbox"
                                                            id="master-currentPlan"
                                                            name="master-currentPlan"
                                                            class="master"
                                                            checked="checked"
                                                            value="true"
                                                            onchange="checkAll(this);"
                                                        />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <!-- <apex:repeat value="{!defaultProducts}" var="prod"> -->
                                                <apex:repeat value="{!tempSelectedProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="dProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="fProds">
                                        <div data-checkbox-group="data-checkbox-group" id="AllPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-AllPlan" name="master-AllPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!finalProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="fProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="frProds">
                                        <div data-checkbox-group="data-checkbox-group" id="frequentPlan">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-frequentPlan" name="master-frequentPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!frequentProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="frProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="bProds">
                                        <div data-checkbox-group="data-checkbox-group" id="businessPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-businessPlan" name="master-businessPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!businessProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="bProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="pProds">
                                        <div data-checkbox-group="data-checkbox-group" id="personalPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-personalPlan" name="master-personalPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!personalProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="pProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="payProds">
                                        <div data-checkbox-group="data-checkbox-group" id="payrollPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-payrollPlan" name="master-payrollPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!payrollProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="payProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="bkkProds">
                                        <div data-checkbox-group="data-checkbox-group" id="bookkeepingPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-bookkeepingPlan" name="master-bookkeepingPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!bookkeepingProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="bkkProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                    <apex:outputpanel id="eProds">
                                        <div data-checkbox-group="data-checkbox-group" id="entityFormationPlan" style="display: none;">
                                            <div class="planPackageTable">
                                                <div class="row" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                                    <div class="col" style="text-align: center; vertical-align: middle; padding-left: 24px;">
                                                        <input data-master-checkbox="data-master-checkbox" type="checkbox" id="master-entityFormationPlan" name="master-entityFormationPlan" class="master" onchange="checkAll(this);" />
                                                    </div>
                                                    <div class="col" style="padding-left: 30px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Product</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 315px;">
                                                        <p class="planPackageTableTitle" style="text-align: left;">Cost</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 62px;">
                                                        <p class="planPackageTableTitle" style="width: 160px; text-align: left;">Frequency</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 0px;">
                                                        <p class="planPackageTableTitle" style="text-align: left; width: 110px;">Quantity</p>
                                                    </div>
                                                    <div class="col" style="padding-left: 16px;">
                                                        <p class="planPackageTableTitle" style="text-align: right;">Subtotal</p>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{!entityFormationProducts}" var="prod">
                                                    <c:GuidedSellingProductLine p="{!prod}" tab="eProds" />
                                                </apex:repeat>
                                            </div>
                                        </div>
                                    </apex:outputpanel>
                                </div>
                                <div id="modalFooter" style="padding-top: 10px; padding-bottom: 10px; border-top: 1px solid rgba(18, 23, 36, 0.2); bottom: 0; position: fixed; width: 100%; display: inline;">
                                    <button class="btnSaveEditPackage btnmodal" id="saveEditPackage" onclick="closeAndSave();" style="float: left;">Save Changes</button>
                                    <span id="switchText">Show the draft to the client</span>
                                    <label class="switch" id="showPackagelabel" style="float: left;">
                                        <apex:inputCheckbox html-data-id="showPackage" id="showPackage" onchange="showWaitingScreen(this);" />
                                        <span class="slider round" id="showPackageBtn"></span>
                                    </label>
                                    <p class="modalNote">Current Quote</p>
                                    <p class="modalAmount" id="quoteTotal">$0 + $0/Mo</p>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalOptionCloseEditing">
                            <div class="content">
                                <div id="modalHeader">
                                    <button type="button" class="backBtn" id="optionBack" onclick="backToEdit();">
                                        <span class="material-icons" style="vertical-align: middle; color: rgba(18, 23, 36, 0.65);">arrow_back</span>&nbsp;&nbsp;Skip to Quote
                                    </button>
                                </div>
                                <div id="modalBody">
                                    <p class="modalTitle">
                                        This package has unsaved changes.
                                    </p>
                                    <button type="button" class="start" id="optionSkipSave" style="color: #ffffff; opacity: 1; margin-top: 2%; padding: 8px 16px;" onclick="skipToSale();">
                                        <span class="material-icons" style="vertical-align: middle;">fast_forward</span>&nbsp;&nbsp;Save and Skip to the Sale
                                    </button>
                                    <button
                                        type="button"
                                        class="start"
                                        id="optionSkipNotSave"
                                        style="color: rgba(18, 23, 36, 0.91); opacity: 1; margin-top: 2%; background-color: #ffffff; border: 1px solid rgba(18, 23, 36, 0.2); padding: 8px 16px;"
                                        onclick="skipDoNotSave();"
                                    >
                                        <span class="material-icons" style="vertical-align: middle;">fast_forward</span>&nbsp;&nbsp;Skip to the Sale Without Saving
                                    </button>
                                    <button
                                        type="button"
                                        class="start"
                                        id="optionBackk"
                                        style="color: #1776b6; opacity: 1; margin-top: 2%; background-color: #ffffff; border: 1px solid rgba(18, 23, 36, 0.2); padding: 8px 16px;"
                                        onclick="backToEdit();"
                                    >
                                        <span class="material-icons" style="vertical-align: middle;">keyboard_return</span>&nbsp;&nbsp;Keep Editing the Package
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="contextMenu" class="context-menu" style="display: none;">
                            <ul>
                                <li onmouseover="highlight();"><a>Highlight</a></li>
                                <li onmouseover="unhighlight();" id="edit"><a>Un-Highlight</a></li>
                            </ul>
                        </div>
                        <button type="button" class="" id="addNoteBtn" onclick="openNoteEditor();">Appointment Notes&nbsp;&nbsp;<span class="material-icons" style="vertical-align: middle;">keyboard_arrow_up</span></button>
                        <div id="modalNotes">
                            <div id="modalNotesHeader">
                                <p>
                                    Appointment Notes
                                </p>
                                <button type="button" class="" id="modalNotesHeaderBtn" onclick="closeNoteEditor();saveNoteEditor()"><span class="material-icons" style="vertical-align: middle;">keyboard_arrow_down</span></button>
                            </div>
                            <div id="modalNotesContent">
                                <p id="modalNoteNote"><span class="material-icons" style="vertical-align: middle; color: #3b7a80;">task_alt</span>&nbsp;This note is saved to the contact.</p>
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="noteTitle" name="noteTitle" placeholder="Note Title" />
                                    <label for="noteTitle" style="color: rgba(18, 23, 36, 0.65);">Note Title</label>
                                </div>
                                <div class="form-floating">
                                    <textarea class="form-control" id="noteBody" placeholder="Enter a note" name="noteBody" rows="4" cols="50"></textarea>
                                    <label for="noteBody" style="color: rgba(18, 23, 36, 0.65);">Enter a note</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="formBody">
                        <div class="title">
                            <p class="titleTxt">
                                Introduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt" id="script">
                                Hello, may I speak with <span id="additionalFirstName0">{!opportunity.Account.Primary_Contact__r.FirstName}</span>?
                                <br /><br />
                                This is {!opportunity.Account.Owner.FirstName} with 1-800Accountant. We have your Tax Savings Analysis scheduled 
                                <span style="display: {!IF(opportunity.Account.Lead_Source__c == '1-800Accountant', 'none', 'inline')}">that is included with your {!opportunity.Account.Lead_Source__c} business registration.</span>
                                <span style="display: {!IF(opportunity.Account.Lead_Source__c == '1-800Accountant', 'inline', 'none')}">for this time.</span>
                            </p>
                            
                            <!--<div Id="proceed">
      <p Id="proceedTxt">
          Only proceed with the Guided Selling experience if the entity type is an LLC.
      </p>
      </div>-->
                            <br />
                            <p class="normalTxt" id="script">
                                Before I dive in, I need to find out if you have any business partners or spouse that you file your taxes jointly with.
                            </p>
                            <!-- trigger both "get on phone" and add partners -->
                            <div id="buttons" style="margin-top: 20px">
                                <spam id="txtRequiredOrange">(Required) </spam>
                                <p class="normalTxt" id="script">Business Partners</p>
                                <button type="button" class="yesBtn" id="yesBtn1" style="color: black;" onclick="getJoinCall();">Yes</button>
                                <div class="divider"></div>
                                <button type="button" class="noBtn" html-data-id="noBtn1" id="noBtn1" style="color: black;" onclick="NoBusiPart();">No</button>
                            </div>
                        </div>
                        <!-- only show on yes; remove required logic -->
                        <div id="numberOfPartners" style="display: none; margin-top: 20px">
                            <p class="normalTxt" id="script" style="width: 70%">
                                <spam id="txtRequiredOrange">(Required) </spam>
                                <br />
                                How many business partners do you have?
                            </p>
                            <div class="form-floating">
                                <input type="text" class="form-control" id="businessPartners" placeholder="# of partners" required="required" onchange="console.log(this); savePartnerNumber(this);" style="width: 40%" />
                            </div>
                        </div>
                        <div class="formTxt" style="margin-top: 20px">
                            
                            <!-- don't save data -->
                            <div id="buttons"> 
                                <!-- add just get on phone -->
                                <p class="normalTxt" id="script">
                                    <spam id="txtRequiredOrange">(Required) </spam>
                                    <br />
                                    Spouse
                                </p>
                                <button type="button" class="yesBtn" id="yesBtn1.4" style="color: black;" onclick="console.log(this); yesSpouse();">Yes</button>
                                <div class="divider"></div>
                                <button type="button" class="noBtn" id="noBtn1.4" style="color: black;" onclick="console.log(this); noSpouse();">No</button>
                            </div>
                        </div>
                        
                        
                        <div id="joinCall">
                            <div id="proceed" class="getOnPhone" style="display:none;">
                                <p id="proceedTxt">
                                     Get them on the phone.
                                </p>
                            </div>
                            <div class="formTxt" id="partnersTable">
                                <table id="headerTable">
                                    <tr>
                                        <td>
                                            <p class="subTitleTxt">Clients Partners</p>
                                        </td>
                                        <td>
                                            <div id="btnAdd">
                                                <a class="addPartnerstwo" onclick="broadcastChannel();"><i class="fas fa-plus"></i>&nbsp;Add a Partner</a>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <div class="partTable">
                                    <table id="addPartTable1">
                                        <tr>
                                            <td>
                                                <center>
                                                    <p class="blast">No partners added yet</p>
                                                </center>
                                            </td>
                                        </tr>
                                    </table>
                                    <table id="addPartTable2">
                                        <thead></thead>
                                        <tbody id="tBody"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="formTxt">
                            <p id="script" class="normalTxt dynamicIntroText">
                                <br /><br />
                            </p>
                        </div>

                        <p class="normalTxt" id="script">
                            <spam id="txtRequiredOrange">(Required) </spam>
                            <br />
                            <span id="businessNameQuestion">Just to verify, "{!opportunity.Account.Name}" is your business name, right?</span>
                            
                        </p>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="businessName" placeholder="Business Name" required="required" value="{!opportunity.Account.Name}" onchange="updateBusinessName(this)"/>
                            <label for="businessName">Business Name</label>
                        </div>
                        <br />
                        <p class="normalTxt" id="script">
                            <spam id="txtRequiredOrange">(Required) </spam>
                            <br />
                            <span id="noDefaultEntityText" style="display: {!IF(defaultEntity == 'Select an Entity Type', 'inline', 'none')}">And was your business registered as an LLC?</span>
                            <span id="selectedEntityText" style="display: {!IF(defaultEntity == 'Select an Entity Type', 'none', 'inline')}">And your business is a(n) {!defaultEntity}, right?</span>

                        </p>
                        <div class="form-floating">
                            <apex:selectList styleClass="form-select"
                                style="padding-top: 14px; width: 40%; height: 52px; margin-top: 2%;"
                                id="entityIntro"
                                html-data-id="entityIntro"
                                value="{!defaultEntity}"
                                onchange="populateAnswer('Entity_Type', this, 'Single Selection', false, true);"
                                size="1"
                            >
                                <apex:selectOptions value="{!entityType}"></apex:selectOptions>
                            </apex:selectList>
                        </div>

                        <!-- dq: what should be the logic for the new variations? -->
                        <div class="formTxt">
                            <div id="buttons">
                                <button type="button" class="start" id="start" style="color: white;" onclick="saveBusinessName();"><i class="fas fa-arrow-right">&nbsp;</i>Next Section</button>
                                <div class="divider"></div>
                                <p class="blast">1-800Accountant Blast</p>
                                <!-- <button class="btnmodal" id="btnDissolution" style="display: block;margin-top: 7%;" onclick="">Start Business Dissolution</button> -->
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="blastBody">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Introduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                1-800Accountant Blast
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt" id="script">
                                <span id="additionalFirstName2">{!opportunity.Account.Primary_Contact__r.FirstName}</span>,  a quick background on 1-800Accountant before we get started. We are a nationwide accounting firm specializing in start-up businesses. We realize accounting and taxes can cause a certain amount of anxiety for a new business owner, but these anxieties can be overcome with the help of education, advice, and technology.
                                <br /><br />
                                That said, our next steps are to educate you and thats going to help you move forward with confidence.
                                <br /><br />
                                Lets get started.
                                <br /><br />
                            </p>
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Start Business Discovery</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="businessDisc">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">1-800Accountant Blast</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Business Discovery Intro
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt" id="script">
                                First, <span id="additionalFirstName3">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, what were going to do is ask some questions just to find out exactly where you and the business are today.
                                <br /><br />
                                The answers to all these questions will give us a baseline on where to begin educating you on potential deductions that are available to you now, as well as, what deductions may be available to you in the future.
                                <br /><br />
                                We will also discuss some tax strategies that you can pursue that may dramatically reduce your taxes.
                                <br /><br />
                                The main goal here is to ensure you are going down a path that gives you and your business the best chance for success. If throughout this consultation we discover you have any needs, Id be happy to provide a solution to help at the end of the call. 
                                <br /><br />
                                Sound fair?
                                <br /><br />
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     Wait for an answer
                                </p>
                            </div>
                            <p class="normalTxt" id="script">
                                Let's dive right in!
                            </p>
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Discovery Questions</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="businessDiscParts">
                        <div class="backMenu">
                            <button type="button" class="backBtn discoveryBackButton" onclick="backThirdSection();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc" id="busiDisc">Business Discovery Intro</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt" id="discoveryQuestionTitle">
                                Business Discovery
                            </p>
                        </div>
                        <div id="engage">
                            <p id="engageTxt">
                                 Review all answers with the client before proceeding.
                            </p>
                        </div>
                        <div class="formTxt">
                            <div id="mainCategoryDivAnchor"></div>
                            <div class="form-floating" id="mainCategoryDiv">
                                <select class="form-select" id="mainCategory" data-id="mainCategory" onchange="filterQuestions(this.value)">
                                    <option class="placeHold" selected="selected" disabled="disabled" hidden="hidden" style="color: #ce0b74;">Show All Questions</option>
                                    <option>Show All Questions</option>
                                    <option>Required Questions</option>
                                    <option>Unanswered Required Questions</option>
                                    <option>Years</option>
                                    <option>Entity &amp; Industry</option>
                                    <option>State</option>
                                    <option>Business Income</option>
                                    <option>Bookkeeping</option>
                                    <option>Owners</option>
                                    <option>Payroll</option>
                                    <option>Filing</option>
                                    <option>Personal Income</option>
                                    <option>Deductions</option>

                                </select>
                                <!-- <apex:selectList styleClass="form-select"
                                    
                                    multiselect="false"
                                    html-data-id="mainCategory"
                                    value="{defaultFilterValue}"
                                    onchange="filterQuestions(this.value)"
                                    size="1">
                                    <apex:selectOptions value="{filterOptionList}"></apex:selectOptions>
                                </apex:selectList> -->
                                
                                <div id="showAllAnswer" style="margin: 10px 0px 10px 20px;">
                                    <label class="switch">
                                        <apex:inputCheckbox html-data-id="showAllAnswers" onchange="showAllAnswers(this.checked);" />
                                        <span class="slider round"></span>
                                    </label>
                                    <spam id="showtxt" style="display: inline-flex; vertical-align: super; color: #000000;">Show all answered questions to the client</spam>
                                </div>
                            </div>
                            <table id="quetionsTable">
                                <!-- <tr id="firstBusiness">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxEmployees" onchange="hideQuestionFromClient(this.checked, 'Is this your first business?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'First Business')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'First Business')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Is this your first business?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button type="button" class="yesBtn" id="yesBtn1.1" style="color: black;" onclick="YesDecision(1.1);getNextBtn('First Business');populateAnswer('Is this your first business?', 'Yes', false);">
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button type="button" class="noBtn" id="noBtn1.1" style="color: black;" onclick="NoDecision(1.1);getNextBtn('First Business');populateAnswer('Is this your first business?', 'No', false);">
                                                No
                                            </button>
                                        </div>
                                        <div id="engage">
                                            <p id="engageTxt">
                                                 Let the client respond and engage with a congratulatory response.
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="entity">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxEntity" onchange="hideQuestionFromClient(this.checked, 'What entity type is your business?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Entity Type')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Entity Type')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What entity type is your business?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                html-data-id="entity"
                                                value="{!defaultEntity}"
                                                onchange="getNextBtn('Entity Type');populateAnswer('What entity type is your business?', this, true);updateEntity(this)"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!entityType}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="industry">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxIndustry" onchange="hideQuestionFromClient(this.checked, 'What industry is your business in?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Industry Type')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Industry Type')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What industry is your business in?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="industry"
                                                html-data-id="industry"
                                                value="{!defaultIndustry}"
                                                onchange="getNextBtn('Industry Type');populateAnswer('What industry is your business in?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!industryType}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="domState">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxDomState" onchange="hideQuestionFromClient(this.checked, 'What is your state of incorporation?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'State of Incorporation')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'State of Incorporation')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What is your state of incorporation?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="domState"
                                                html-data-id="domState"
                                                value="{!defaultDomesticState}"
                                                onchange="getNextBtn('State of Incorporation');populateAnswer('What is your state of incorporation?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!stateOfIncorporation}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr id="foreignState">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxForeignState" onchange="hideQuestionFromClient(this.checked, 'What is your foreign state of incorporation?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Foreign State')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Foreign State')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What is your foreign state of incorporation?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="foreignState"
                                                html-data-id="foreignState"
                                                value="{!defaultForeignState}"
                                                onchange="getNextBtn('Foreign State');populateAnswer('What is your foreign state of incorporation?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!stateOfIncorporation}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="startup">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxStartup" onchange="hideQuestionFromClient(this.checked, 'How much have you invested so far in start-up costs?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Total Startup Cost')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Total Startup Cost')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            How much have you invested so far in start-up costs?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="startup"
                                                html-data-id="startup"
                                                value="{!defaultStartupCosts}"
                                                onchange="getNextBtn('Total Startup Cost');populateAnswer('How much have you invested so far in start-up costs?', this, true);calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!moneyAmount}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="revenue">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxRevenue" onchange="hideQuestionFromClient(this.checked, 'What do you anticipate your revenue to be over the next 12 months?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Projected 1st Year Revenue')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Projected 1st Year Revenue')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What do you anticipate your revenue to be over the next 12 months?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="revenue"
                                                html-data-id="revenue"
                                                value="{!defaultRevenue}"
                                                onchange="getNextBtn('Projected 1st Year Revenue');populateAnswer('What do you anticipate your revenue to be over the next 12 months?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!moneyAmount}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="profit">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxProfit" onchange="hideQuestionFromClient(this.checked, 'What do you project your 1st year profit to be over the next 12 months?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Projected 1st Year Profit')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Projected 1st Year Profit')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What do you project your 1st year profit to be over the next 12 months?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="profit"
                                                html-data-id="profit"
                                                value="{!defaultFirstYearProfit}"
                                                onchange="getNextBtn('Projected 1st Year Profit');populateAnswer('What do you project your 1st year profit to be over the next 12 months?', this, true);calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!moneyAmount}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr id="transactions">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxTransactions" onchange="hideQuestionFromClient(this.checked, 'How many monthly bookkeeping transactions do you have?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Number of Transactions')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Number of Transactions')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            How many monthly bookkeeping transactions do you have?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="transactions"
                                                html-data-id="transactions"
                                                value="{!defaultNumTransactions}"
                                                onchange="getNextBtn('Number of Transactions');populateAnswer('How many monthly bookkeeping transactions do you have?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!numberOfTransactions}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>

                                <tr id="bookkeepingStart">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxBookkeepingStart" onchange="hideQuestionFromClient(this.checked, 'What transaction date should your bookkeeper start on?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Bookkeeping Start Date')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Bookkeeping Start Date')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What transaction date should your bookkeeper start on?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:input type="date"
                                                value="{!bookkeepingStartDate}"
                                                styleClass="date-select start-date"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="bookkeepingStart"
                                                html-data-id="bookkeepingStart"
                                                onchange="getNextBtn('Bookkeeping Start Date');populateAnswer('What transaction date should your bookkeeper start on?', this, true);"
                                                size="1"
                                            ></apex:input>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="bookkeepingEnd">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxBookkeepingEnd" onchange="hideQuestionFromClient(this.checked, 'What transaction date should your bookkeeper end on?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Bookkeeping End Date')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Bookkeeping End Date')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What transaction date should your bookkeeper end on?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:input type="date"
                                                value="{!bookkeepingEndDate}"
                                                styleClass="date-select end-date"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="bookkeepingEnd"
                                                html-data-id="bookkeepingEnd"
                                                onchange="getNextBtn('Bookkeeping End Date');populateAnswer('What transaction date should your bookkeeper end on?', this, true);"
                                                size="1"
                                            ></apex:input>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="owners">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxOwners" onchange="hideQuestionFromClient(this.checked, 'How many owners does your business have?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Number of Owners')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Number of Owners')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            How many owners does your business have?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="owners"
                                                html-data-id="owners"
                                                value="{!defaultNumOwners}"
                                                onchange="getNextBtn('Number of Owners');populateAnswer('How many owners does your business have?', this, true);"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!numberOf}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="runPayroll">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxRunPayroll" onchange="hideQuestionFromClient(this.checked, 'Have you run payroll before?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Run Payroll Before')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Run Payroll Before')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Have you run payroll before?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button type="button" class="yesBtn" id="yesBtn1.2" style="color: black;" onclick="YesDecision(1.2);getNextBtn('Run Payroll Before');populateAnswer('Have you run payroll before?', 'Yes', false);">
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button type="button" class="noBtn" id="noBtn1.2" style="color: black;" onclick="NoDecision(1.2);getNextBtn('Run Payroll Before');populateAnswer('Have you run payroll before?', 'No', false);">
                                                No
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="hasEmpContractors">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxHasEmpContractors" onchange="hideQuestionFromClient(this.checked, 'Do you currently have any employees?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!OR(CONTAINS(requiredFields, 'Number of Employees'), CONTAINS(requiredFields, 'Number of Contractors'))}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!OR(CONTAINS(requiredFields, 'Number of Employees'), CONTAINS(requiredFields, 'Number of Contractors'))}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Excluding yourself, do you currently have any additional employees or contractors?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button
                                                type="button"
                                                class="yesBtn"
                                                id="yesBtn1.3"
                                                style="color: black;"
                                                onclick="YesDecision(1.3);populateAnswer('Do you currently have any employees?', 'Yes', false);linkedYesNo('Employees and Contractors');"
                                            >
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button
                                                type="button"
                                                class="noBtn"
                                                id="noBtn1.3"
                                                style="color: black;"
                                                onclick="NoDecision(1.3);getNextBtn('Number of Employees');getNextBtn('Number of Contractors');populateAnswer('Do you currently have any employees?', 'No', false);linkedYesNo('Employees and Contractors');"
                                            >
                                                No
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="employees">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxEmployees" onchange="hideQuestionFromClient(this.checked, 'How many employees do you have?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Number of Employees')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Number of Employees')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            How many additional employees do you have?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="employees"
                                                html-data-id="employees"
                                                value="{!defaultNumEmployees}"
                                                onchange="getNextBtn('Number of Employees');populateAnswer('How many employees do you have?', this, true);linkedFields('Employees and Contractors');"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!numberOfEmployeeContractors}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="filingStatus">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxFilingStatus" onchange="hideQuestionFromClient(this.checked, 'What is your tax filing status?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Filing Status')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Filing Status')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What is your tax filing status?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="filingStatus"
                                                html-data-id="filingStatus"
                                                value="{!defaultFilingStatus}"
                                                onchange="getNextBtn('Filing Status');populateAnswer('What is your tax filing status?', this, true);calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!filingStatus}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="household">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxHousehold" onchange="hideQuestionFromClient(this.checked, 'What was your household W-2 income last year?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Personal Income')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Personal Income')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What was your household W-2 income last year?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="household"
                                                html-data-id="household"
                                                value="{!defaultPersonalIncome}"
                                                onchange="getNextBtn('Personal Income');populateAnswer('What was your household W-2 income last year?', this, true);calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!moneyAmount}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="hasRentals">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxHasRentals" onchange="hideQuestionFromClient(this.checked, 'Do you currently have any rental properties?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Number of Rental Properties')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Number of Rental Properties')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Do you currently have any rental properties?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button
                                                type="button"
                                                class="yesBtn"
                                                id="yesBtn1.6"
                                                style="color: black;"
                                                onclick="YesDecision(1.6);populateAnswer('Do you currently have any rental properties?', 'Yes', false);linkedYesNo('Number of Rental Properties');"
                                            >
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button
                                                type="button"
                                                class="noBtn"
                                                id="noBtn1.6"
                                                style="color: black;"
                                                onclick="NoDecision(1.6);getNextBtn('Number of Rental Properties');populateAnswer('Do you currently have any rental properties?', 'No', false);linkedYesNo('Number of Rental Properties');"
                                            >
                                                No
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="rental">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxRental" onchange="hideQuestionFromClient(this.checked, 'How many rental properties do you have?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Number of Rental Properties')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Number of Rental Properties')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            How many rental properties do you have?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="rental"
                                                html-data-id="rental"
                                                value="{!defaultNumberOfRentalProperties}"
                                                onchange="getNextBtn('Number of Rental Properties');populateAnswer('How many rental properties do you have?', this, true);linkedFields('Number of Rental Properties');"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!numberOfRentalProperties}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="workingHome">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxWorkingHome" onchange="hideQuestionFromClient(this.checked, 'Will you be working from home?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Office Square Footage')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Office Square Footage')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Will you be working from home?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button
                                                type="button"
                                                class="yesBtn"
                                                id="yesBtn1.7"
                                                style="color: black;"
                                                onclick="YesDecision(1.7);populateAnswer('Will you be working from home?', 'Yes', false);linkedYesNo('Working from Home');"
                                            >
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button
                                                type="button"
                                                class="noBtn"
                                                id="noBtn1.7"
                                                style="color: black;"
                                                onclick="NoDecision(1.7);getNextBtn('Office Square Footage');populateAnswer('Will you be working from home?', 'No', false);linkedYesNo('Working from Home');"
                                            >
                                                No
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="footage">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxFootage" onchange="hideQuestionFromClient(this.checked, 'What is the approximate square footage of your home office?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Office Square Footage')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Office Square Footage')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            What is the approximate square footage of your home office?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="footage"
                                                html-data-id="footage"
                                                value="{!defaultOffice}"
                                                onchange="getNextBtn('Office Square Footage');populateAnswer('What is the approximate square footage of your home office?', this, true);linkedFields('Working from Home');calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!office}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="drive">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxDrive" onchange="hideQuestionFromClient(this.checked, 'Will you use your personal vehicle for business purposes?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Business Miles')}">
                                                <spam id="txtRequiredOrange">(Required) </spam>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Business Miles')}">
                                                <spam id="txtRequired">(Optional)</spam>
                                            </apex:outputPanel>
                                            <br />
                                            Will you use your personal vehicle for business purposes?
                                        </p>
                                        <div id="buttonsDisc">
                                            <button
                                                type="button"
                                                class="yesBtn"
                                                id="yesBtn1.8"
                                                style="color: black;"
                                                onclick="YesDecision(1.8);populateAnswer('Will you use your personal vehicle for business purposes?', 'Yes', false);linkedYesNo('Driving');"
                                            >
                                                Yes
                                            </button>
                                            <div class="divider"></div>
                                            <button
                                                type="button"
                                                class="noBtn"
                                                id="noBtn1.8"
                                                style="color: black;"
                                                onclick="NoDecision(1.8);getNextBtn('Business Miles');populateAnswer('Will you use your personal vehicle for business purposes?', 'No', false);linkedYesNo('Driving');"
                                            >
                                                No
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="miles">
                                    <td class="actionRow">
                                        <spam id="showtxt">Show</spam>
                                        <label class="switch">
                                            <apex:inputCheckbox html-data-id="checkboxMiles" onchange="hideQuestionFromClient(this.checked, 'How many business-related miles do you estimate youll drive per year?');" />
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="questionRow">
                                        <p class="normalTxt" id="script">
                                            <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Business Miles')}"> <spam id="txtRequiredOrange">(Required) </spam></apex:outputPanel>
                                            <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Business Miles')}"> <spam id="txtRequired">(Optional)</spam> </apex:outputPanel>
                                            <br />
                                            How many business-related miles do you estimate youll drive per year?
                                        </p>
                                        <div class="form-floating" id="buttonsDisc">
                                            <apex:selectList styleClass="form-select"
                                                style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                                id="miles"
                                                html-data-id="miles"
                                                value="{!defaultMileage}"
                                                onchange="getNextBtn('Business Miles');populateAnswer('How many business-related miles do you estimate youll drive per year?', this, true);linkedFields('Driving');calculateTaxSavings();"
                                                size="1"
                                            >
                                                <apex:selectOptions value="{!mileage}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </td>
                                </tr> -->

                                <apex:repeat value="{!discoveryQuestions}" var="question">
                                    <c:GuidedSellingDiscoveryQuestion q="{!question}"/>
                                </apex:repeat>                                    
                                
                                
                                
                                
                                <!-- <tr id="website">
         <td class="actionRow">
             <spam id="showtxt">Show</spam>
             <label class="switch">
                 <apex:inputCheckbox html-data-id="checkboxWebsite" onchange="hideQuestionFromClient(this.checked, 'Will your business have a web or e-commerce presence?');"/>
                 <span class="slider round"></span>
             </label>
         </td>
         <td class="questionRow">
             <p class="normalTxt" id="script">
                 <apex:outputPanel rendered="{!CONTAINS(requiredFields, 'Website Selling Goods')}">  <spam id="txtRequiredOrange">(Required) </spam></apex:outputPanel> 
                 <apex:outputPanel rendered="{!!CONTAINS(requiredFields, 'Website Selling Goods')}"> <spam id="txtRequired">(Optional)</spam> </apex:outputPanel>
                 <br/>
                 Will your business have a web or e-commerce presence?
             </p>
             <div id="buttonsDisc">
                 <button type="button" class="yesBtn" id="yesBtn1.9" style="color: black;" onclick="YesDecision(1.9);populateAnswer('Will your business have a web or e-commerce presence?', 'Yes', false);">Yes</button>
                 <div class="divider"/>
                 <button type="button" class="noBtn" id="noBtn1.9" style="color: black;" onclick="NoDecision(1.9);getNextBtn('Website Selling Goods');populateAnswer('Will your business have a web or e-commerce presence?', 'No', false);">No</button>
             </div>
         </td>
         </tr> -->
                            </table>
                        </div>
                        <div id="errorMessage" style="display: inline-flex;">
                            <p id="errorMessageText"><span class="material-icons" id="errorMessageIcon">warning_amber</span>&nbsp;Not all required questions have been answered.</p>
                            <button type="button" class="" id="errorMessageBtn" style="color: black;" onclick="filterQuestions('Unanswered Required Questions')">Show Unanswered Required Questions</button>
                        </div>
                        <div class="formTxt">
                            <div id="buttons">
                                <button type="button" class="start" id="thirdStart" style="color: white;" onclick="whatToDo();"><i class="fas fa-arrow-right">&nbsp;</i>Review Answers</button>
                                <apex:actionFunction name="CallApexMethod"
                                    action="{!getProductData}"
                                    oncomplete="processProductData();"
                                    reRender="functionPanel, dProds, fProds, frProds, bProds, pProds, payProds, bkkProds, eProds"
                                >
                                    <!-- <apex:param assignTo="{!quoteId}" name="getProductParam" value=""/>     -->
                                </apex:actionFunction>
                                <apex:actionFunction name="RerenderSelectedProducts" reRender="dProds" />
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Review Business Discovery</p>
                            </div>
                        </div>
                    </div>
                    <div id="pesForLLC">
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="properEstityStrugleLLC">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Review Discovery Questions</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Proper Entity Structuring Introduction
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Great, now that we know where you are today, lets start arming you with knowledge and education you can use to manage and grow your business. 
                                    <br /><br />
                                    Sound good?
                                    <br /><br />
                                    Im going to start with four terms you need to be familiar with in the immediate future.                                    
                                    <br /><br />
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Flow Through Entity</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="flowThroughEntityLLC">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage()">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Proper Entity Structuring Intro</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Flow Through Entity
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    First, lets talk about Flow Through Entity.
                                    <br /><br />
                                    Are you familiar with that term?
                                    <br /><br />
                                    Simply put, the profits or losses of this business flow through to your personal tax return. If a person is getting W-2 wages and they own a flow through entity and that entity had a loss due to start up or organizational costs; that loss can be subtracted from your households W-2 income. That may dramatically reduce both your taxable income or your individual tax rate. 
                                    <br /><br />
                                    We will get into more specifics on this later, but for now, lets move on to the next important term.
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Entity Classification Election (ECE)</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="entityClassificationElec">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Flow Through Entity</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Entity Classification Election (ECE)
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Entity Classification Election or ECE is a process through which you elect and notify the IRS how you wish to have your business taxed.                                    
                                    <br /><br />
                                    The IRS recommends that this be done within 75 days of the date the business is formed. If you do not elect how you wish your business to be taxed, then the IRS will choose for you. We cannot allow the IRS to determine your filing status, so it is essential to the success of your business that we choose one that is in your best interest. 
                                    <br /><br />
                                    If the IRS chooses your Entitys filing status, do you think they will choose one that is in your best interest 
                                    <span id="additionalFirstName5">{!opportunity.Account.Primary_Contact__r.FirstName}</span>?
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Exactly, lets move to term number three, Self-Employment Tax.
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Self-Employment Tax (FICA)</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="selfEmploymentTaxLLC">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc" id="busiDisc">Entity Classification Election (ECE)</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Self-Employment Tax (FICA)
                                </p>
                            </div>
                            <!-- Introduction -->
                            <div class="formTxt" id="verticalSectLine1">
                                <p class="normalTxt discoTitle2" id="script">
                                    <button type="button" id="currentSlide1" onclick="getSlideOne();">Current Slide</button>
                                    <spam id="part1">Introduction</spam>
                                </p>
                                <div class="formTxt">
                                    <p class="normalTxt formTxtbottom" id="script">
                                        Letting the IRS choose your entity classification for you may result in a 15.3% Self-Employment Tax'' aka FICA. FICA covers your Social Security and Medicare and this tax is ON TOP of any other Federal, State, and Local taxes you are already paying. By making sure you elect your entity classification properly, you will have the opportunity to reduce your self-employment tax by up to 50%. 
                                        <br /><br />
                                        <span id="additionalFirstName6">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, if we could reduce your self-employment tax by up to 50%, how do you think that could benefit your business
                                        specifically?
                                    </p>
                                    <div id="engage">
                                        <p id="engageTxt">
                                             Engage with a congratulatory response
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <!-- Extra btns -->
                            <div id="ficaBtns">
                                <button type="button" id="showficaexample" onclick="showFicaExample();">Give FICA Example</button>
                                <button type="button" id="skipficaexample" style="opacity: 1;" onclick="nextPage();">
                                    <span style="vertical-align: middle;" class="material-icons">skip_next</span>&nbsp;Skip FICA Example &amp; Tax Savings
                                </button>
                                <!-- <button type="button" id="skipficaexample" style="opacity: 1;" onclick="nextSection(null, null, 'selfEmploymentTaxLLC', 'properEntityStrugReviewLLC');"><span style="vertical-align: middle;" class="material-icons">skip_next</span>&nbsp;Skip FICA Example &amp; Tax Savings</button> -->
                            </div>
                            <!-- FICA Example -->
                            <div class="formTxt" id="verticalSectLine2">
                                <p class="normalTxt discoTitle2" id="script">
                                    <button type="button" id="currentSlide2" onclick="getSlideTwo();">Current Slide</button>
                                    <spam id="part2">FICA Example</spam>
                                </p>
                                <div class="formTxt" id="FICA-Example">
                                    <p class="normalTxt formTxtbottom" id="script">
                                        I find it's easiest to understand how this works if we look at an example.
                                        <br /><br />
                                        For the sake of simple math, let's say you earn $100,000 over the next year through your business. If you fail to elect how your business is taxed, you will pay 15.3% or $15,300 just in self-employment taxes alone.
                                    </p>
                                </div>
                            </div>
                            <!-- Tax Savings -->
                            <div class="formTxt" id="verticalSectLine3">
                                <p class="normalTxt discoTitle2" id="script">
                                    <button type="button" id="currentSlide3" onclick="getSlideThree();"><i class="fas fa-arrow-right">&nbsp;</i>Next Section</button>
                                    <spam id="part3">Tax Savings</spam>
                                </p>
                                <div class="formTxt" id="Tax-Savings">
                                    <p class="normalTxt formTxtbottom" id="script">
                                        On the other hand, if you file your entity classification and you take the necessary steps to ensure your business is structured in the most tax efficient way possible, you will save around 50%, or approximately $7,500 dollars in just that first year.
                                        <br /><br />
                                        Hold onto that thought for a second. That isnt a tax deduction, it is a $7,500 dollar ANNUAL tax savings that you can reinvest into your business instead of sending it to the IRS.
                                        <br /><br />
                                        <span id="additionalFirstName7">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, which would you rather do, fund the IRS or grow your business?
                                    </p>
                                    <div id="engage">
                                        <p id="engageTxt">
                                             Wait for an answer
                                        </p>
                                    </div>
                                    <p class="normalTxt formTxtbottom" id="script">
                                        I couldnt agree more.
                                    </p>
                                </div>
                            </div>
                            <div class="formTxt" id="btn-fica">
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast" id="endNote">Beneficial Ownership Information (BOI)</p>
                                </div>
                            </div>
                        </div>

                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="boiIntroLLC">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Self-Employment Tax (FICA)</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Beneficial Ownership Information (BOI)
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    The final term is "Beneficial Ownership Information" or BOI. This impacts business owners differently depending on when your business was formed.
                                </p>
                                <div class="questionRow">
                                    <p class="normalTxt" id="script">
                                        <apex:outputPanel >
                                            <spam id="txtRequiredOrange">(Required) </spam>
                                        </apex:outputPanel>
                                        <br />
                                        When did you form your business?
                                    </p>
                                    <div class="form-floating" id="buttonsDisc" style="margin-bottom: 5px;">
                                        <apex:input type="date"
                                            value="{!formationDate}"
                                            styleClass="date-select start-date"
                                            style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                            id="formationDateLLC"
                                            html-data-id="formationDate"
                                            onchange="saveFormationDate(this);"
                                            size="1"
                                        ></apex:input>
                                    </div>
                                    <p class="backTitle" style="margin-bottom: 50px;">This can be a general guess</p>
                                </div>
                                <div
                                    class="businessFormationAlert"
                                    style="
                                        width: fit-content;
                                        height: fit-content;
                                        padding-left: 16px;
                                        padding-right: 16px;
                                        padding-top: 5px;
                                        padding-bottom: 5px;
                                        background: rgba(23, 118, 182, 0.12);
                                        border-radius: 4px;
                                        justify-content: flex-start;
                                        align-items: center;
                                        gap: 12px;
                                        display: none;
                                        margin-bottom: 30px;
                                    "
                                >
                                    <div style="padding-top: 8px; padding-bottom: 8px; border-radius: 4px; flex-direction: row; justify-content: flex-start; align-items: center; gap: 4px; display: inline-flex;">
                                        <svg aria-hidden="true" class="slds-icon" style="fill: rgb(23, 118, 182, 1); width: 1.7rem; height: 1.7rem;">
                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info_alt')}"></use>
                                        </svg>
                                        <div
                                            class="businessFormationAlertText"
                                            style="color: rgba(17.7, 22.61, 36.12, 0.91); font-size: 17px; font-family: Poppins; font-weight: 400; line-height: 20px; letter-spacing: 0.14px; word-wrap: break-word;"
                                        >
                                            The clients business was formed {{x}} days ago.
                                        </div>
                                    </div>
                                </div>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Acknowledge the client's answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    As a result of the Corporate Transparency Act, the Financial Crimes Enforcement Network is asking companies like yours to submit the Beneficial Ownership Information (BOI) forms within 90 days to the US Government about who ultimately owns and controls your company in an effort to combat financial crimes. 
                                    <br /><br />
                                    Filing this properly is a significant concern because providing false information or failing to report or update beneficial ownership information may result in significant penalties.
                                    <br /><br />
                                    The civil penalty for failure to file by the deadline is $500 per day up to $10,000. 
                                    <br /><br />
                                    Were you already aware of this?
                                </p>
                                <p class="normalTxt formTxtbottom boiIntro2024Text" style="display: none;" id="script">
                                    As a result of the Corporate Transparency Act, the Financial Crimes Enforcement Network is requiring 97% of companies to submit the Beneficial Ownership Information (BOI) forms within 90 days to the US Government about who ultimately owns and controls your company in an effort to combat financial crimes. 
                                    <br /><br />
                                    Filing this properly is a significant concern because providing false information or failing to report or update beneficial ownership information may result in significant penalties. 
                                    <br /><br />
                                    The civil penalty for failure to file by the deadline is $500 per day up to $10,000.
                                    <br /><br />
                                    Were you already aware of this?
                                </p>
                                <p class="normalTxt formTxtbottom boiIntro2023Text" style="display: none;" id="script">
                                    As a result of the Corporate Transparency Act, the Financial Crimes Enforcement Network is requiring 97% of existing companies to submit the Beneficial Ownership Information (BOI) form to the US Government about who ultimately owns and controls your company in an effort to combat financial crimes. 
                                    <br /><br />
                                    Filing this properly is a significant concern because providing false information or failing to report or update beneficial ownership information may result in significant penalties. The civil penalty for failure to file is $500 per day up to $10,000. 
                                    <br /><br />
                                    When it comes to a filing this important, would you agree its better to file sooner and be done with it or later and run the risk of forgetting?
                                </p>
                                <div id="engage" class="boiIntroEngageText" style="display: none;">
                                    <p id="engageTxt">
                                         Get an answer
                                    </p>
                                </div>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Review Proper Entity Structuring</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="properEntityStrugReviewLLC">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Beneficial Ownership Information (BOI)</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Review Proper Entity Structuring
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Passing this type of knowledge to you through this consultation is what we pride ourselves on here at 1-800ACCOUNTANT. 
                                    <br /><br />
                                    So, how am I doing so far {!opportunity.Account.Primary_Contact__r.FirstName}?
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Deductions Introduction</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="pesForSCorp">
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="properEstityStrugleSCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Review Discover Questions</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Proper Entity Structuring Introduction
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Great, now that we know where you are today, lets start arming you with knowledge and education you can use to manage and grow your business.
                                    <br /><br />
                                    Im going to start with three terms you need to be familiar with in the immediate future.
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Flow Through Entity</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="flowThroughEntitySCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage()">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Proper Entity Structuring Intro</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Flow Through Entity
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    First, lets talk about Flow Through Entity.
                                    <br /><br />
                                    Are you familiar with that term?
                                    <br /><br />
                                    Simply put, the profits or losses of this business flow through to your personal tax return. If a person is getting W-2 wages and they own a flow through entity and that entity had a loss due to start up
                                    or organizational costs; that loss can be subtracted from you and your spouses W-2 income. That may dramatically reduce both your taxable income or your individual tax rate.
                                    <br /><br />
                                    We will get into specifics on deductions later, but for now lets move on to the next important term.
                                </p>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage()">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Self-Employment Tax (FICA)</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="selfEmploymentTaxSCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Flow Through Entity</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Self-Employment Tax (FICA)
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Lets move to term number two, Self-Employment Tax. Self-Employment Tax is the social security and medicare tax that you may have seen come out of your paychecks as a W-2 employee. As an employee, the
                                    company you work(ed) for is/was matching 100% of your contributions to this tax. That said, now that you own a corporation, you are responsible for the full 15.3% in self-employment tax which will be
                                    taken away from your business income which is ON TOP of any other income, payroll, or sales and use taxes you are already paying.
                                    <br /><br />
                                    Now, there is a possibility we could reduce your self-employment tax by up to 50% if it is determined that you would need to pay yourself a Reasonable Salary.
                                    <span id="additionalFirstName8">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, if we could reduce your self-employment tax by up to 50%, how do you think that could benefit your business
                                    specifically?
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Reasonable Salary</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="reasonableSalarySCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc" id="busiDisc">Self-Employment Tax (FICA)</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Reasonable Salary
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    <span>{!opportunity.Account.Primary_Contact__r.FirstName}</span>, in regards to a Reasonable Salary and what the IRS views as reasonable there are three criteria that need to be taken into
                                    consideration for determining what the shareholder/you did for the corporation by looking at the source of the gross receipts of the corporation.
                                    <br /><br />
                                    The three major sources outlined by the IRS are:
                                    <br /><br />
                                    &nbsp;1. Services of shareholders
                                    <br />
                                    &nbsp;2. Services of non-shareholder employees
                                    <br />
                                    &nbsp;3. Capital and equipment
                                    <br /><br />
                                    This can be incredibly confusing as every business is different and every business owner plays a unique role in the business. Finding the solution to a reasonable salary in the eyes of the IRS is going to
                                    be a very important part of your tax strategy and will definitely be crucial to your long term success.
                                    <br /><br />
                                    While you are in the early stages of your business, this may not seem like a major factor, but as you begin to meet your goals and the business grows, this should be on your radar and should always be
                                    included in a Tax Strategy year over year.
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                            </div>
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Beneficial Ownership Information (BOI)</p>
                            </div>
                        </div>
                        
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="boiIntroSCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Reasonable Salary</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Beneficial Ownership Information (BOI)
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    The final term is "Beneficial Ownership Information" or BOI. This impacts business owners differently depending on when your business was formed.
                                </p>
                                <div class="questionRow">
                                    <p class="normalTxt" id="script">
                                        <apex:outputPanel >
                                            <spam id="txtRequiredOrange">(Required) </spam>
                                        </apex:outputPanel>
                                        <br />
                                        When did you form your business?
                                    </p>
                                    <div class="form-floating" id="buttonsDisc" style="margin-bottom: 5px;">
                                        <apex:input type="date"
                                            value="{!formationDate}"
                                            styleClass="date-select start-date"
                                            style="height: auto; padding-top: 5%; padding-bottom: 5%;"
                                            id="formationDateSCorp"
                                            html-data-id="formationDate"
                                            onchange="saveFormationDate(this);"
                                            size="1"
                                        ></apex:input>
                                    </div>
                                    <p class="backTitle" style="margin-bottom: 50px;">This can be a general guess</p>
                                </div>
                                <div
                                    class="businessFormationAlert"
                                    style="
                                        width: fit-content;
                                        height: fit-content;
                                        padding-left: 16px;
                                        padding-right: 16px;
                                        padding-top: 5px;
                                        padding-bottom: 5px;
                                        background: rgba(23, 118, 182, 0.12);
                                        border-radius: 4px;
                                        justify-content: flex-start;
                                        align-items: center;
                                        gap: 12px;
                                        display: none;
                                        margin-bottom: 30px;
                                    "
                                >
                                    <div style="padding-top: 8px; padding-bottom: 8px; border-radius: 4px; flex-direction: row; justify-content: flex-start; align-items: center; gap: 4px; display: inline-flex;">
                                        <svg aria-hidden="true" class="slds-icon" style="fill: rgb(23, 118, 182, 1); width: 1.7rem; height: 1.7rem;">
                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info_alt')}"></use>
                                        </svg>
                                        <div
                                            class="businessFormationAlertText"
                                            style="color: rgba(17.7, 22.61, 36.12, 0.91); font-size: 17px; font-family: Poppins; font-weight: 400; line-height: 20px; letter-spacing: 0.14px; word-wrap: break-word;"
                                        >
                                            The clients business was formed {{x}} days ago.
                                        </div>
                                    </div>
                                </div>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Acknowledge the client's answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom boiIntro2024Text" style="display: none;" id="script">
                                    As a result of the Corporate Transparency Act, the Financial Crimes Enforcement Network is requiring 97% of companies to submit the Beneficial Ownership Information (BOI) forms within 90 days to the US
                                    Government about who ultimately owns and controls your company in an effort to combat financial crimes.
                                    <br /><br />
                                    Filing this properly is a significant concern because providing false information or failing to report or update beneficial ownership information may result in significant penalties.
                                    <br /><br />
                                    The civil penalty for failure to file by the deadline is $500 per day up to $10,000.
                                    <br /><br />
                                    Were you already aware of this?
                                </p>
                                <p class="normalTxt formTxtbottom boiIntro2023Text" style="display: none;" id="script">
                                    As a result of the Corporate Transparency Act, the Financial Crimes Enforcement Network is requiring 97% of existing companies to submit the Beneficial Ownership Information (BOI) form to the US
                                    Government about who ultimately owns and controls your company in an effort to combat financial crimes.
                                    <br /><br />
                                    Filing this properly is a significant concern because providing false information or failing to report or update beneficial ownership information may result in significant penalties. The civil penalty for
                                    failure to file is $500 per day up to $10,000.
                                    <br /><br />
                                    When it comes to a filing this important, would you agree its better to file sooner and be done with it or later and run the risk of forgetting?
                                </p>
                                <div id="engage" class="boiIntroEngageText" style="display: none;">
                                    <p id="engageTxt">
                                         Get an answer
                                    </p>
                                </div>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Review Proper Entity Structuring</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="properEntityStrugReviewSCorp">
                            <div class="backMenu">
                                <button type="button" class="backBtn" onclick="previousPage();">
                                    <table id="backTable">
                                        <tr>
                                            <td>
                                                <span class="material-icons" id="backArrow">arrow_back</span>
                                            </td>
                                            <td>
                                                <p class="backTitle">Previous section</p>
                                                <p class="backDesc">Beneficial Ownership Information (BOI)</p>
                                            </td>
                                        </tr>
                                    </table>
                                </button>
                            </div>
                            <div class="title">
                                <p class="titleTxt">
                                    Review Proper Entity Structuring
                                </p>
                            </div>
                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Passing this type of knowledge to you through this consultation is what we pride ourselves on here at 1-800ACCOUNTANT.
                                    <br /><br />
                                    So, how am I doing so far <span id="additionalFirstName8">{!opportunity.Account.Primary_Contact__r.FirstName}</span>?
                                    <br /><br />
                                    Do you feel like you have a good grasp on Flow Through Entity, Self-Employment Tax, Reasonable Salary, and Beneficial Ownership Information?
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Let me pause and make sure we are in sync on the four main topics related to proper entity structuring, since our goal is to maximize your deductions and setup your business in the most tax-efficient way
                                    possible:
                                    <br /><br />
                                    1. <b>Flow-Through Entity: </b> do you understand that your profit or loss will flow through to your personal income?
                                    <br /><br />
                                    2. <b>Self-Employment Tax: </b> do you understand by creating a proper tax strategy you could reduce your Self-Employment Tax liability by up to 50%?
                                    <br /><br />
                                    3. <b>Reasonable Salary: </b> do you understand that paying you or your shareholders a reasonable salary may be crucial to your long term success? 
                                    <br /><br />
                                    4. <b>Beneficial Ownership Information: </b> do you understand that reporting who owns and controls your company is necessary and should be done as soon as possible?
                                    <br /><br />
                                    We good here? Great!
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Acknowledge the client understands these points
                                    </p>
                                </div>
                                <div id="buttons">
                                    <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                        <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                    </button>
                                    <div class="divider"></div>
                                    <p class="blast">Deductions Introduction</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="deductionsIntro">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Proper Entity Structuring Review</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Deductions Introduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Now lets move on to Deductions and the ability to write off expenses youve made or will make into your business. While there are potentially hundreds of available deductions your business may qualify for over the years, I want to focus on the ones that are relevant to you now and potentially in the immediate future.
                            </p>
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Go to Start-up Costs</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="placeholder">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Placeholder back</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Placeholder title
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                               Placeholder text
                            </p>
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Placeholder next</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="startUpCosts">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Deductions Introduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Start-up Costs
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Lets begin with Start-up Costs, <span id="additionalFirstName9">{!opportunity.Account.Primary_Contact__r.FirstName}</span>.
                                <br /><br />
                                In our discovery session earlier, you stated that you have invested approximately <span id="startUpAmount"></span> into your business so far. The good news is that with recent changes to the tax code, you are allowed to
                                deduct up to $5,000 dollars in start-up costs.
                                <br /><br />
                                Start-up costs can be expenses like website development, storefront build out, marketing, equipment, supplies, educational seminars, continuing education, accounting services etc.
                                <br /><br />
                                The IRS also allows you to deduct up to $5,000 in Organizational Expenses. These can be legal and accounting services related to entity formation and the state and federal fees associated with setting up your
                                business.
                                <br /><br />
                                Do you have a good grasp on start-up costs and organizational expenses?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     In order to proceed you must verify that the client understands startup costs.
                                </p>
                                <!-- <input type="checkbox" id="understands" name="understands" onchange="validateButtons()" />
                                <label class="normalTxt formTxtbottom" for="understands">&nbsp;Client understands start-up costs (Required).</label> -->
                            </div>
                            <br />
                            <p class="normalTxt formTxtbottom" id="script">
                                Alright, great.
                            </p>
                            <br /><br />
                            <p class="normalTxt formTxtbottom" id="script"><b>You must review at least one of the following deductions:</b></p>
                            <button type="button" class="start medicalbtn" id="medicalbtn" style="color: white; display: block; margin-bottom: 3%;opacity: 1;" onclick="nextPage('Medical Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Medical Deduction
                            </button>
                            <button type="button" class="start vehiclebtn" id="vehiclebtn" style="color: white; display: block; margin-bottom: 3%;opacity: 1;" onclick="nextPage('Vehicle Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Vehicle Deduction
                            </button>
                            <button type="button" class="start officebtn" id="officebtn" style="color: white; display: block; margin-bottom: 3%;opacity: 1;" onclick="nextPage('Home Office Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Home Office Deduction
                            </button>
                            <button type="button" class="start 199Abtn" id="199Abtn" style="color: white; display: block; margin-bottom: 3%;opacity: 1;" onclick="nextPage('Code Section 199A Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Code Section 199A Deduction
                            </button>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="medicalDeduction">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Start-Up Costs</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Medical Deduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Next, lets talk about Medical deductions.                                
                                <br /><br />
                                When it comes to Medical, you need to understand that as a small-business owner, you now have the same opportunities for deductions as any major Fortune 500 corporation. Meaning,
                                <span id="additionalFirstName11">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, if your new company is paying your premiums, then those premiums may become up to 100% tax deductible. With the
                                average premium paid for individual coverage coming in at over $400/month, that can mean thousands of dollars back in your pocket in the form of a tax deduction every single year.
                                <br /><br />
                                Make sense?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     In order to proceed you must verify that the client understands Medical Deduction
                                </p>
                                <!-- <input type="checkbox" id="understandsMed" name="understandsMed" onchange="showDeductBtns();" />
                                <label class="normalTxt formTxtbottom" for="understandsMed">&nbsp;Client understands Medical Deductions. (Required)</label> -->
                            </div>
                            <p class="normalTxt formTxtbottom" id="script">
                                Alright, great.
                            </p>
                            <br /><br />
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="reviewDeductionNext1" style="color: white; opacity: 1;" onclick="nextPage('Review Deductions');">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Review All Deductions</p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script"><b>Review other deductions (Optional)</b></p>
                            <button type="button" class="hidequestion" id="vehiclebtnWhite1" style="margin-bottom: 3%; display: block;" onclick="nextPage('Vehicle Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Vehicle Deduction
                            </button>
                            <button type="button" class="hidequestion" id="officebtnWhite1" style="margin-bottom: 3%; display: block;" onclick="nextPage('Home Office Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Home Office Deduction
                            </button>
                            <button type="button" class="hidequestion" id="199AbtnWhite1" style="margin-bottom: 3%; display: block;" onclick="nextPage('Code Section 199A Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Code Section 199A Deduction
                            </button>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="vehicleDeduction">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Medical Deduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Vehicle Deduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Next, lets talk about the Vehicle deductions.
                                <br /><br />
                                Now this is likely the most common deduction written off by small-businesses. The IRS allows one of two methods for deducting expenses related to the use of your vehicle for business. These are the Actual Expense Method or the Standard Mileage Method.
                                <br /><br />
                                The Actual Expense Method allows you to deduct the actual costs associated with maintaining the vehicle for business use, such as gas, oil changes, tires, insurance, and registration fees, etc. That could add up to thousands of dollars per year.
                                <br /><br />
                                The standard mileage method this year allows for a 67 cent per mile deduction (2023: 65.5 cents per mile). With the average American driving 15,000 miles per year, that can add up to a significant deduction. If just 50% of the mileage were for business this year, that would be around a $4,800 annual write off. 
                                <br /><br />
                                That's significant, isn't it?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     In order to proceed you must verify that the client understands vehicle deductions.
                                </p>
                                <!-- <input type="checkbox" id="understandsVeh" name="understandsVeh" onchange="showDeductBtns();" />
                                <label class="normalTxt formTxtbottom" for="understandsVeh">&nbsp;The client understands vehicle deductions. (Required)</label> -->
                            </div>
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="reviewDeductionNext2" style="color: white;opacity: 1;" onclick="nextPage('Review Deductions');">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Review All Deductions</p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script"><b>Review other deductions (Optional)</b></p>
                            <button type="button" class="hidequestion" id="vehiclebtnWhite2" style="margin-bottom: 3%; display: block;" onclick="nextPage('Medical Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Medical Deduction
                            </button>
                            <button type="button" class="hidequestion" id="officebtnWhite2" style="margin-bottom: 3%; display: block;" onclick="nextPage('Home Office Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Home Office Deduction
                            </button>
                            <button type="button" class="hidequestion" id="199AbtnWhite2" style="margin-bottom: 3%; display: block;" onclick="nextPage('Code Section 199A Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Code Section 199A Deduction
                            </button>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="homeOfficeDeduction">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Vehicle Deduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Home Office Deduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Next, lets talk about Home Office deduction.                                
                                <br /><br />
                                There are also two different methods allowed by the IRS for deducting these expenses.
                                <br /><br />
                                There is the simplified method, where you can take up to 300 sq. ft. of your home, as an office, at $5 per square foot and bam! You just found yourself another $1,500 annual write off.
                                <br /><br />
                                With method two, it can get even better. Its based on the square footage of your home, allowing you to deduct a percentage of the total costs of your rent/mortgage, taxes, maintenance and insurance, etc.
                                However, <span id="additionalFirstName14">{!opportunity.Account.Primary_Contact__r.FirstName}</span>, this deduction is more complicated due to a potential recapture tax in the event you sell your home.
                                Therefore, it is critical that you have a comprehensive tax strategy in place before taking advantage of the percentage deduction.
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     In order to proceed you must verify that the client understands home office deductions.
                                </p>
                                <!-- <input type="checkbox" id="understandsHome" name="understandsHome" onchange="showDeductBtns();" />
                                <label class="normalTxt formTxtbottom" for="understandsHome">&nbsp;The client understands home office deductions. (Required)</label> -->
                            </div>
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="reviewDeductionNext3" style="color: white;opacity: 1;" onclick="nextPage('Review Deductions');">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Review All Deductions</p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script"><b>Review other deductions (Optional)</b></p>
                            <button type="button" class="hidequestion" id="officebtnWhite3" style="margin-bottom: 3%; display: block;" onclick="nextPage('Medical Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Medical Deduction
                            </button>
                            <button type="button" class="hidequestion" id="vehiclebtnWhite3" style="margin-bottom: 3%; display: block;" onclick="nextPage('Vehicle Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Vehicle Deduction
                            </button>
                            <button type="button" class="hidequestion" id="199AbtnWhite3" style="margin-bottom: 3%; display: block;" onclick="nextPage('Code Section 199A Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Code Section 199A Deduction
                            </button>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="codeDeduction">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Home Office Deduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Code Section 199A Deduction
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Next, I would like to discuss the Code Section 199A deduction.                                
                                <br /><br />
                                Have you ever heard of this deduction before?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     Wait for an answer
                                </p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script">
                                Simply put, you may be able to deduct 20% of your Business Profits. Meaning, if you have net profits, you can take that 20% as a deduction on your personal income tax return.
                                <br /><br />
                                Wouldnt you agree that this is a major benefit to having a profitable business?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     Wait for an answer
                                </p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script">
                                I agree completely!
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     In order to proceed you must verify that the client understands Code Section 199A deduction
                                </p>
                                <!-- <input type="checkbox" id="understandsCode" name="understandsCode" onchange="showDeductBtns();" />
                                <label class="normalTxt formTxtbottom" for="understandsCode">&nbsp;The client understands the Code Section 199A deduction. (Required)</label> -->
                            </div>
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="reviewDeductionNext4" style="color: white;opacity: 1;" onclick="nextPage('Review Deductions');">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Review All Deductions</p>
                            </div>
                            <p class="normalTxt formTxtbottom" id="script">
                                <b>
                                    <br />
                                    Review other deductions (Optional)
                                </b>
                            </p>
                            <button type="button" class="hidequestion" id="199AbtnWhite4" style="margin-bottom: 3%; display: block;" onclick="nextPage('Medical Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Medical Deduction
                            </button>
                            <button type="button" class="hidequestion" id="vehiclebtnWhite4" style="margin-bottom: 3%; display: block;" onclick="nextPage('Vehicle Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Vehicle Deduction
                            </button>
                            <button type="button" class="hidequestion" id="officebtnWhite4" style="margin-bottom: 3%; display: block;" onclick="nextPage('Home Office Deduction');">
                                <i class="fas fa-arrow-right">&nbsp;</i>Go to Home Office Deduction
                            </button>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="reviewDeduction">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Code Section 199A Deduction</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Review Deductions
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                So, a quick recap. <span id="revDeductForEntity"></span>
                                along with the deduction(s) of:
                                <span id="dedMedical" style="display: none;"> - Medical</span>
                                <span id="dedVehicle" style="display: none;"> - Vehicle</span>
                                <span id="dedHomeOffice" style="display: none;"> - Home Office</span>
                                <span id="dedCodeSec" style="display: none;"> - 199A</span>
                                <br /><br />
                                We could probably talk for hours about your potential eligible deductions and we would never scratch the surface.
                                <br /><br />
                                So lets go ahead and tie this all together!
                            </p>
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="next" style="color: white; opacity: 1;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Start Paper Loss</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="paperloss">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Review Deductions</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Paper Loss
                            </p>
                        </div>
                        <!-- Paper Loss Intro -->
                        <div class="formTxt" id="vertSectLine1">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide1" onclick="getSecOne();">Current Slide</button>
                                <spam id="partSec1">Paper Loss Intro</spam>
                            </p>
                            <div class="formTxt" id="PaperlossIntro">
                                <p class="normalTxt formTxtbottom" id="script">
                                    One crucial piece of your business taxes that we want to take advantage of is called a paper loss. 
                                    <br /><br />
                                    The goal of creating a paper loss is to reduce your personal tax liability when you have more expenses than income from your business, using the first years expenses.
                                </p>
                            </div>
                        </div>
                        <!-- Paper Loss Formula -->
                        <div class="formTxt" id="vertSectLine2">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide2" onclick="getSecTwo();">Current Slide</button>
                                <spam id="partSec2">Paper Loss Preview</spam>
                            </p>
                            <div class="formTxt" id="PaperlossFormula">
                                <p class="normalTxt formTxtbottom" id="script">
                                    For most new business owners, they have to create a new habit that purchases made for the business and things that are being done for the business can POTENTIALLY be tax deductible. We want to allocate as many expenses as we can for you that the IRS considers ordinary and necessary for the business.
                                </p>
                            </div>
                        </div>
                        <!-- Paper Loss Example -->
                        <div class="formTxt" id="vertSectLine3">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide3" onclick="getSecThree();">Current Slide</button>
                                <spam id="partSec3">Paper Loss Example</spam>
                            </p>
                            <div class="formTxt" id="PaperlossExample">
                                <p class="normalTxt formTxtbottom" id="script">
                                    For example, in your salary from your W-2 job, let's say you're earning
                                </p>
                                <div class="form-floating">
                                    <select class="form-select" id="salaryAmount" style="color: #f15f22; width: 50%; padding-top: 25px; height: 54px; margin-bottom: 5%;" onchange="changePaperlossSalaryAmount(this);">
                                        <option disabled="disabled" selected="selected" style="color: #f15f22;">Select an Amount</option>
                                        <!--0-->
                                        <option>30,000</option>
                                        <!--1-->
                                        <option>50,000</option>
                                        <!--2-->
                                        <option>75,000</option>
                                        <!--3-->
                                        <option>100,000</option>
                                        <!--4-->
                                    </select>
                                    <label for="salaryAmount">W-2 Job Salary Amount</label>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    and you have a loss from your business of
                                </p>
                                <div class="form-floating">
                                    <select class="form-select" id="businessLossAmount" style="color: #f15f22; width: 50%; padding-top: 25px; height: 54px; margin-bottom: 5%;" onchange="changePaperlossbusinessLossAmount(this);">
                                        <option disabled="disabled" selected="selected" style="color: #f15f22;">Select an Amount</option>
                                        <!--0-->
                                        <option></option>
                                        <option></option>
                                        <option></option>
                                        <option></option>
                                    </select>
                                    <label for="businessLossAmount">Business Loss Amount</label>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Instead of reporting $<span id="amountforExample">__,___</span> in income on your personal taxes the business loss is going to pass through to your personal income tax and you would only report $<span id="incomeforExample">__,___</span> of income. The whole goal of corporate accounting and what we can provide for you is to help you potentially receive as much of a tax refund as you can get or
                                    help you owe less. 
                                    <br /><br />
                                    After the first year and as your business grows, having a solo 401K or IRA can become tools used to lower your AGI, control your tax rate, and shift income.
                                    <br /><br />
                                    This is what we call tax strategy and over the next year, we want to put together a plan that involves building that paper loss as high as possible since the IRS is expecting it.
                                    <br /><br />
                                    Make sense?
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Do you feel you have benefitted from our consultation so far today?
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait and listen. Engage if needed.
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Im sure you can see the importance of having a strategy or road map to follow when it comes to your taxes. I really hope that the knowledge I shared with you today did ease some of the anxiety that can come along with starting a business and thinking about your accounting and taxes.
                                </p>
                                <div id="engage">
                                    <p id="engageTxt">
                                         Wait for an answer
                                    </p>
                                </div>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Okay, great. That said, were not only here to help educate, we also work with entrepreneurs every day, developing and providing a range of advisory, accounting, tax, and bookkeeping services.
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="btn-paperloss">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">1800Accountant Features</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="features">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Paper Loss</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                1-800Accountant Introduction
                            </p>
                        </div>
                        <!-- 1-800Accountant Strategy -->
                        <div class="formTxt" id="vertLine1features">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide1features" onclick="getSecOnefeat();">Current Slide</button>
                                <spam id="partSec1">1-800Accountant Strategy</spam>
                            </p>
                            <div class="formTxt" id="accountantStrategy">
                                <p class="normalTxt formTxtbottom" id="script">
                                    That said, it is an absolute legal necessity to file your income taxes each year and track your business expenses. So, here at 1-800Accountant we're here to help!
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine2features">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide2features" onclick="getSecTwofeat();">Current Slide</button>
                                <spam id="partSec1">Other CPAs</spam>
                            </p>
                            <div class="formTxt" id="otherCPAs">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Unlike your traditional CPA firms that charge hourly, like an attorney, typically $200 - $400 per hour, we charge a flat rate. And with the IRS recommending you spend 20+ hours minimum with your accountants each year at an hourly rate that could mean basically writing your traditional CPA a blank check.
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine3features">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide3features" onclick="getSecThreefeat();">Current Slide</button>
                                <spam id="partSec1">How Were Different</spam>
                            </p>
                            <div class="formTxt" id="different">
                                <p class="normalTxt formTxtbottom" id="script">
                                    With you being a new business owner you can't project the amount of hours you may need. Thats why we operate differently. There are no hourly fees and we offer flat rates which is why our services are so affordable for the start-up business owner. 
                                    <br /><br />
                                    I want to make sure you can focus on what you get and not wonder what its going to cost.
                                    <br /><br />
                                    Most new clients are in the same situation as you, so we put together a discounted core package at a flat rate of
                                    <spam id="totalAnualCost"></spam>
                                    <br /><br />
                                    It starts with Tax Advisory
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="btn-features">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">1800Accountant Features</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="taxAdvisory">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">1-800Accountant Cost</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Tax Advisory
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Youll receive unlimited access to your team of accountants consisting of your Dedicated Tax Advisor, a Support Accountant, a Tax Analyst, and a Financial Planner who will custom-build an annual tax plan to save you as much as possible on your taxes.                                
                                <br /><br />
                                We'll...
                            </p>
                            <ul class="normalTxt formTxtbottom" style="padding-left: 25px; padding-bottom: 25px;">
                                <li class='bullet'>Get you set up with the correct documentation to take advantage of deductions</li>
                                <li class='bullet'>Monitor your situation year-round and alert you to any tax law changes</li>
                                <li class='bullet'>Keep you compliant with complicated IRS and state requirements and avoid costly penalties.</li>
                            </ul>
                            <p class="normalTxt formTxtbottom advisoryScriptDefault" id="script" style="display: none;">
                                We will answer questions on your time-sensitive ECE filing and file your BOI.
                                <br /><br />
                                Your financial planner will help you understand retirement options, which is a great way to save on taxes.
                            </p>
                            <p class="normalTxt formTxtbottom advisoryScriptNoBOI" id="script" style="display: none;">
                                We will answer questions on your time-sensitive ECE filing.
                                <br /><br />
                                Your financial planner will help you understand retirement options, which is a great way to save on taxes.
                            </p>
                        </div>
                        <div class="formTxt" id="btn-expertAccountant">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">1-800Accountant Portal Tour</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="portalTour">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Your Expert Accountant Team</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                The 1-800Accountant Portal Tour
                            </p>
                        </div>
                        <div class="formTxt" id="vertLine1portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide1portalTour" onclick="getSectionsPortal('Intro');">Current Slide</button>
                                <spam id="partSec1">1-800Accountant Portal Intro</spam>
                            </p>
                            <div class="formTxt" id="accountantPortal">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Part of tax advisory is complimentary access to our Portal, which grants you access to our
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine2portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide2portalTour" onclick="getSectionsPortal('Scheduler');">Current Slide</button>
                                <spam id="partSec1">Appointment Scheduler</spam>
                            </p>
                            <div class="formTxt" id="scheduler">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Appointment Scheduler to see availability on your accountants calendar                                
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine3portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide3portalTour" onclick="getSectionsPortal('Message');">Current Slide</button>
                                <spam id="partSec1">Message Center</spam>
                            </p>
                            <div class="formTxt" id="messageCenter">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Your Message Center to send questions to your team
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine4portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide4portalTour" onclick="getSectionsPortal('Tax');">Current Slide</button>
                                <spam id="partSec1">Tax Planner</spam>
                            </p>
                            <div class="formTxt" id="taxPlanner">
                                <p class="normalTxt formTxtbottom" id="script">
                                    A Tax Planner where you have real-time tracking of your tax liability or refund
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine5portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide5portalTour" onclick="getSectionsPortal('Bookkeeping');">Current Slide</button>
                                <spam id="partSec1">Bookkeeping</spam>
                            </p>
                            <div class="formTxt" id="featBookkeeping">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Bookkeeping software to prepare financial statements and sync business accounts to track revenue and expenses
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine6portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide6portalTour" onclick="getSectionsPortal('Document');">Current Slide</button>
                                <spam id="partSec1">Document Center</spam>
                            </p>
                            <div class="formTxt" id="DocumentCenter">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Document Center to upload important financial and IRS documents as well as receipts
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine7portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide7portalTour" onclick="getSectionsPortal('Invoices');">Current Slide</button>
                                <spam id="partSec1">Invoices</spam>
                            </p>
                            <div class="formTxt" id="featInvoices">
                                <p class="normalTxt formTxtbottom" id="script">
                                    You can create invoices to organize your customer billing and get paid faster
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine8portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide8portalTour" onclick="getSectionsPortal('Mobile');">Current Slide</button>
                                <spam id="partSec1">Mobile App</spam>
                            </p>
                            <div class="formTxt" id="mobileApp">
                                <p class="normalTxt formTxtbottom" id="script">
                                    We have a mobile app to track mileage and take pictures of receipts
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="vertLine9portalTour">
                            <p class="normalTxt discoTitle2" id="script">
                                <button type="button" id="currtSlide9portalTour" onclick="getSectionsPortal('Summary');">Current Slide</button>
                                <spam id="partSec1">Summary</spam>
                            </p>
                            <div class="formTxt" id="summary">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Everything you do in the Portal syncs automatically to your accounting team, so theres no need to duplicate efforts.
                                </p>
                            </div>
                        </div>
                        <div class="formTxt" id="btn-portalTour">
                            <div id="buttons">
                                <button type="button" class="start" id="portalNextBtn" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Preparing and Filing Income Taxes</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="filingBusinessTaxes">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">The 1-800Accountant Portal Tour</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Preparing and Filing Business Taxes
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Of course, your core package also includes the preparation and filing of your personal and annual business income taxes with the IRS and your state of incorporation.
                            </p>
                        </div>
                        <div id="engage">
                            <p id="engageTxt">
                                 Discuss any other filings that you have included in the quote outside of ECE and BOI.
                            </p>
                        </div>
                        <div class="formTxt" id="btn-filingBusinessTaxes">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Entity Classification Election</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="filingECE">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Preparing and Filing Business Taxes</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Prepare your Entity Classification Election
                            </p>
                        </div>
                        <div
                            class="businessFormationAlert"
                            style="width: fit-content; height: fit-content; padding-left: 16px; padding-right: 16px; padding-top: 5px; padding-bottom: 5px; background: rgba(23, 118, 182, 0.12); border-radius: 4px; justify-content: flex-start; align-items: center; gap: 12px; display: none; margin-top: 30px;"
                        >
                            <div style="padding-top: 8px; padding-bottom: 8px; border-radius: 4px; flex-direction: row; justify-content: flex-start; align-items: center; gap: 4px; display: inline-flex;">
                                <svg aria-hidden="true" class="slds-icon" style="fill: rgb(23, 118, 182, 1); width: 1.7rem; height: 1.7rem;">
                                    <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info_alt')}"></use>
                                </svg>
                                <div
                                    class="businessFormationAlertText"
                                    style="color: rgba(17.7, 22.61, 36.12, 0.91); font-size: 17px; font-family: Poppins; font-weight: 400; line-height: 20px; letter-spacing: 0.14px; word-wrap: break-word;"
                                >
                                    The clients business was formed {{x}} days ago.
                                </div>
                            </div>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom eceFilingTextDefault" id="script">
                                This also includes the preparation of your ECE.
                            </p>
                        </div>
                        <div class="formTxt" id="btn-filingECE">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Beneficial Ownership Information</p>
                            </div>
                        </div>
                    </div>

                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="boiSummary">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Filing your Entity Classification Election</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Beneficial Ownership Information
                            </p>
                        </div>
                        <div
                            class="businessFormationAlert"
                            style="
                                width: fit-content;
                                height: fit-content;
                                padding-left: 16px;
                                padding-right: 16px;
                                padding-top: 5px;
                                padding-bottom: 5px;
                                background: rgba(23, 118, 182, 0.12);
                                border-radius: 4px;
                                justify-content: flex-start;
                                align-items: center;
                                gap: 12px;
                                display: none;
                                margin-top: 30px;
                            "
                        >
                            <div style="padding-top: 8px; padding-bottom: 8px; border-radius: 4px; flex-direction: row; justify-content: flex-start; align-items: center; gap: 4px; display: inline-flex;">
                                <svg aria-hidden="true" class="slds-icon" style="fill: rgb(23, 118, 182, 1); width: 1.7rem; height: 1.7rem;">
                                    <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#info_alt')}"></use>
                                </svg>
                                <div
                                    class="businessFormationAlertText"
                                    style="color: rgba(17.7, 22.61, 36.12, 0.91); font-size: 17px; font-family: Poppins; font-weight: 400; line-height: 20px; letter-spacing: 0.14px; word-wrap: break-word;"
                                >
                                    The clients business was formed {{x}} days ago.
                                </div>
                            </div>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom boiFilingTextDefault" id="script">
                                And the filing of your Beneficial Ownership Information so you dont receive any penalties.
                            </p>
                        </div>
                        <div class="formTxt" id="btn-filingECE">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Presentation Wrap Up</p>
                            </div>
                        </div>
                    </div>

                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="presWrapUp">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Beneficial Ownership Information</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Presentation Wrap Up
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                And all this is 100% tax deductible, so well be writing this off.                                 
                                <br /><br />
                                Make sense?
                            </p>
                        </div>
                        <div id="engage">
                            <p id="engageTxt">
                                 Dont pause after the client answers.
                            </p>
                        </div>
                        <div class="formTxt" id="btn-filingECE">
                            <div id="buttons">
                                <button type="button" class="start" id="secondStart" style="color: white;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast" id="endNote">Verify Your Information</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="preparedPackages">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Presentation Wrap Up</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Prepared Packages
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                From our discussion today weve prepared a few plans that let you take advantage of our services to help your business grow.
                            </p>
                            <button type="button" class="yesBtn editPackageButton" id="editPackage" style="color: black; display: none;" onclick="showModalEditPackage();showWaitingScreen(false);">
                                <span class="material-icons">drive_file_rename_outline</span>&nbsp;Edit Package
                            </button>
                            <div id="buttons" style="margin-bottom: 3%;">
                                <button type="button" class="start" id="next" style="color: white; opacity: 1;" onclick="nextPage();">
                                    <i class="fas fa-arrow-right">&nbsp;</i>Next Section
                                </button>
                                <div class="divider"></div>
                                <p class="blast">Verify Your Information</p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="verifyInformation">
                        <div class="backMenu">
                            <button type="button" class="backBtn backToPrep" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Presentation Wrap Up</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                            <button type="button" class="backBtn backToReview" style="display: none;" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Review Discovery Questions</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Verify Your Information
                            </p>
                        </div>
                        <div class="formTxt">
                            <div style="margin-top: 50px;">
                                <p class="normalTxt formTxtbottom" id="script">
                                    <span style="font-weight: 600;">Phone and Email Address</span>
                                    <br /><br />
                                    The next steps are simple, {!businessOwner.First_Name__c}, I want to ensure the information we have on file is accurate, while also scheduling your onboarding appointment. 
                                    <br /><br />
                                    Is
                                    <spam id="busOwnerPhone">{!businessOwner.Phone__c}</spam>
                                    the best phone number for your accountant to call you on?
                                    <br /><br />
                                    Is
                                    <spam id="busOwnerEmail">{!businessOwner.Email__c}</spam>
                                    the best email address for your portal login?
                                </p>
                                <button type="button" class="yesBtn" id="editPackage" style="color: black;" onclick="showModalEditClientInfo();">
                                    <span class="material-icons">drive_file_rename_outline</span>&nbsp;Edit Client Information
                                </button>
                            </div>

                            <div style="margin-top: 70px;">
                                <p class="normalTxt formTxtbottom" id="script">
                                    <span style="font-weight: 600;">Billing Address</span>
                                    <br /><br />
                                    Could you confirm your billing address for me?
                                    <br /><br />
                                    <spam id="busOwnerAddress">{!businessOwner.Address__c}</spam>
                                    <br />
                                    <spam id="busOwnerCity">{!businessOwner.City__c}</spam>
                                    <spam id="busOwnerState"></spam>
                                    <spam id="busOwnerZip">{!businessOwner.Zip__c}</spam>
                                    <br />
                                    <spam id="busOwnerCountry">{!businessOwner.Country__c}</spam>
                                </p>
                                <button type="button" class="yesBtn" id="editPackage" style="color: black;" onclick="showModalEditBillingAdd();">
                                    <span class="material-icons">drive_file_rename_outline</span>&nbsp;Edit Billing Address
                                </button>
                            </div>
                            
                            <div style="margin-top: 80px;">
                                <p class="normalTxt formTxtbottom" id="script">
                                    <span style="font-weight: 600;">Payment Terms</span>
                                    <br /><br />
                                    <span id="planTerms">No Financing.</span>
                                </p>
                                <button type="button" class="yesBtn" id="editPackage" style="color: black;" onclick="showModalEditPayTerms();"><span class="material-icons">drive_file_rename_outline</span>&nbsp;Edit Payment Terms</button>
                            </div>

                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    Great.                        
                                    <br /><br />
                                    Let's go ahead and get your onboarding appointment scheduled. For your initial investment of <span id="finalAmou"></span> today, did you want to use a Visa, Mastercard, American Express, or Discover?
                                </p>
                            </div>

                            <div id="engage">
                                <p id="engageTxt">
                                     PAUSE! Do Not Say Anything!
                                </p>
                            </div>

                            <div class="formTxt">
                                <p class="normalTxt formTxtbottom" id="script">
                                    If the client objects, recap core components.
                                </p>
                            </div>

                            <div id="buttons" style="margin-bottom: 3%; margin-top: 5%;">
                                <button type="button" class="start" id="generateQuoteButton" style="color: white; opacity: 1;" onclick="showModalConfirmQuote();"><i class="fas fa-arrow-right">&nbsp;</i>Generate Quote</button>
                                <div class="divider"></div>
                                <p class="blast">Payment Details</p>
                                <div id="errorMesse" style="display: inline-flex;">
                                    <span class="material-icons" id="errorMessageIcon" style="padding-left: 2%; padding-top: 3%;">warning_amber</span>
                                    <p id="errorMessageText">
                                        Proceeding to payment details will lock the ChargeOver quote and require making any further edits to the quote within the Opportunity in Salesforce. To avoid this, make changes before proceeding and
                                        locking the quote by clicking the "Edit Quote" button in the top-left portion of the screen.
                                    </p>
                                </div>
                            </div>

                            

                            <p id="commonObjections">Common Objections</p>
                            <button class="accordion" onclick="accordionFunct(this, '1');">
                                I want to think about it<span class="material-icons arrows" id="lessArrow1">expand_less</span><span class="material-icons arrows" id="moreArrow1">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I understand. This is an important decision for you and your business. May I ask: What is it you will be thinking about the most?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    Extending conversation with tax strategy and urgency.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Extending conversation with strategy and urgency, then back to $
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '2');">
                                My business isnt making money<span class="material-icons arrows" id="lessArrow2">expand_less</span><span class="material-icons arrows" id="moreArrow2">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    It is common for a new business to have more money going out than coming in and as a new business owner, you could use that to your advantage.
                                    <br /><br />
                                    That said, its important that were strategizing every deduction and credit you are entitled to. Also, we need to ensure youre addressing your ECE with as soon as possible. Our whole goal is to make
                                    sure youre not funding the IRS {!businessOwner.First_Name__c}.
                                    <br /><br />
                                    Is it more of the investment youre thinking about, or the services?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    Extending conversation with tax strategy and urgency.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Extending conversation with strategy and urgency, then back to $
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '3');">
                                I need to speak with spouse/partner<span class="material-icons arrows" id="lessArrow3">expand_less</span><span class="material-icons arrows" id="moreArrow3">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I can understand. This is an important decision.
                                    <br /><br />
                                    May I ask what you think your spouse/partner will be thinking about the most?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    I know it feels like yesterday since you set your business up in {!opportunity.Account.Lead_Source_Date__c}, so we have some catching up to do.
                                    <br /><br />
                                    The good news is you are on the phone with me today.
                                    <br /><br />
                                    The next steps are very simple {!businessOwner.First_Name__c}, lets schedule your Discovery call on a day that works for you and your spouse.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Having everyone on the same page is important.
                                    <br /><br />
                                    Nevertheless, earlier you stated that you and your partner/spouse invested {!business.Startup_Costs__c} into your business, correct? This service ensures you protect that investment. In order to do that,
                                    its crucial that we create a comprehensive tax strategy that will help you find ways to recoup some of those startup costs.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '4');">
                                I read negative reviews of 1-800Accountant<span class="material-icons arrows" id="lessArrow4">expand_less</span><span class="material-icons arrows" id="moreArrow4">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I completely understand your concern. I also check reviews with the companies I may do business with and often factor them in prior to making a decision. So, I can absolutely relate with your concern.
                                    <br /><br />
                                    I want to assure you that a chief goal of 1-800Accountant is to not only meet but exceed the expectations of our clients. Keep in mind that we have an A rating with the Better Business Bureau, which is
                                    far above other well-known tax prep companies such as H &#38; R Block (1.2-star average rating) or TurboTax (1.1-star average rating.)
                                    <br /><br />
                                    We have earned the trust of hundreds of thousands of people like you for the past 20 years and that kind of trust has made us the nations leading virtual accounting firm. Additionally, whenever we do
                                    receive a negative review or a complaint from a customer, we ensure we go above and beyond to resolve the issue.
                                    <br /><br />
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '5');">
                                I want to research before moving forward<span class="material-icons arrows" id="lessArrow5">expand_less</span><span class="material-icons arrows" id="moreArrow5">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I understand. As a business owner, you want to ensure youre making the right decision for you and your business and I value that. Let me ask. What is it that youd like to research?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If they want to research the company</spam>
                                    <br />
                                    As a business owner, I would want to research as well. Let me save you the hassle. {!opportunity.Account.Lead_Source__c} has done the research for you. They know what it takes for a business to be
                                    successful, and our accountants know what it takes for a business to be successful, which is why out of all the accounting firms in the country, they trust us with their clients.This is why we dont
                                    operate that way. Since we need to address your ECE, and the overall tax strategy for this year, let's at least set your discovery appointment and wont think about taxes until then.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If they want to compare</spam>
                                    <br />
                                    I understand, I would want to compare myself. One thing Id like to point out is that your typical local accountant will charge billable hours typically $200-$300 per hour. We dont charge per hour. This
                                    allows you the freedom to access your accountant whenever you feel the need arises.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '6');">
                                I know a CPA or have a family member who is a CPA<span class="material-icons arrows" id="lessArrow6">expand_less</span><span class="material-icons arrows" id="moreArrow6">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If CPA is NOT a family member</spam>
                                    <br />
                                    Remember, we operate differently, we dont charge hourly fees or hidden costs which is why our services are so affordable for the start-up business owner.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If CPA IS a family member</spam>
                                    <br />
                                    In my experience, a lot of business owners make it a common practice of keeping business and family separate. In the end its up to whatever works best for you. Keep in mind that you will have a team that
                                    will be here to minimize your stress and maximize your tax savings through on demand, unlimited access.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                        </div>
                        <div class="modal" id="modalEditClientInfo">
                            <div class="content">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Edit Client Information</p>
                                            </td>
                                            <td>
                                                <button class="modalHeaderClose" onclick="closeModalEditClientInfo();"></button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBody">
                                    <div class="form-floating">
                                        <input type="email" class="form-control" id="emailModalEditClientInfo" placeholder="Email" required="required" value="{!businessOwner.Email__c}" onkeyup="" style="" />
                                        <label for="emailModalEditClientInfo">Email</label>
                                        <p id="emailFormatError" style="color: red;"></p>
                                    </div>
                                    <div class="form-floating">
                                        <input type="tel" class="form-control" id="phoneModalEditClientInfo" placeholder="Phone" required="required" value="{!businessOwner.Phone__c}" onkeyup="" style="" />
                                        <label for="phoneModalEditClientInfo">Phone</label>
                                    </div>
                                    <p id="modalEditClientInfoErrors" style="color: red;"></p>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalEditClientInfo();">Cancel</button>
                                    <button class="btnAddRow saveChanges" style="opacity: 1;" id="" onclick="saveClientInfo('personal');">Save Changes</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalEditBillingAdd">
                            <div class="content">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Edit Billing Address</p>
                                            </td>
                                            <td>
                                                <button class="modalHeaderClose" onclick="closeModalEditBillingAdd();"></button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBody">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="streetAddress" value="{!businessOwner.Address__c}" placeholder="streetAddress" required="required" onkeyup="" />
                                        <label for="streetAddress">Street Address</label>
                                    </div>
                                    <div style="position: relative; display: flex; padding-bottom: 24px;">
                                        <div class="form-floating" style="width: 75%;">
                                            <input type="text" class="form-control" id="cityAddress" value="{!businessOwner.City__c}" style="width: 225px; height: 54px;" placeholder="cityAddress" required="required" onkeyup="" />
                                            <label for="cityAddress">City</label>
                                        </div>
                                        <div class="form-floating">
                                            <label for="stateAddress" style="padding: 5px 12px; font-size: 11px; opacity: 0.75;">State</label>
                                            <apex:selectList styleClass="form-select" id="stateAddress" html-data-id="stateAddress" style="width: 225px; padding-top: 8%; height: 54px;" value="{!defaultState}" onchange="" size="1">
                                                <apex:selectOptions value="{!stateOfIncorporation}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </div>
                                    <div style="position: relative; display: flex; padding-bottom: 24px;">
                                        <div class="form-floating" style="width: 75%;">
                                            <input type="tel" class="form-control" id="zipAddress" value="{!businessOwner.Zip__c}" style="width: 225px; height: 54px;" placeholder="zipAddress" required="required" onkeyup="" />
                                            <label for="zipAddress">Zip</label>
                                        </div>
                                        <div class="form-floating">
                                            <label for="countryAddress" style="padding: 5px 12px; font-size: 11px; opacity: 0.75;">Country</label>
                                            <apex:selectList styleClass="form-select" id="countryAddress" html-data-id="countryAddress" style="width: 225px; padding-top: 8%; height: 54px;" value="{!defaultCountry}" onchange="" size="1">
                                                <apex:selectOptions value="{!contries}"></apex:selectOptions>
                                            </apex:selectList>
                                        </div>
                                    </div>
                                    <p id="modalEditBillingAddErrors" style="color: red;"></p>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalEditBillingAdd();">Cancel</button>
                                    <button class="btnAddRow saveChanges" style="opacity: 1;" id="" onclick="saveClientInfo('billing')">Save Changes</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal" id="modalEditPayTerms">
                            <div class="content">
                                <div id="modalHeader">
                                    <table id="modalHeaderTable" style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                        <tr>
                                            <td>
                                                <p class="modalHeaderTitle">Edit Payment Terms</p>
                                            </td>
                                            <td>
                                                <button class="modalHeaderClose" onclick="closeModalEditPayTerms(true);"></button>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="modalBody">
                                    <div class="form-floating">
                                        <!--<apex:selectList styleClass="form-select" style="height: auto;padding-top: 5%;padding-bottom: 5%;" id="payTerms" html-data-id="payTerms" value="{defaultNumberOfRentalProperties}" onchange="" size="1">
                              <apex:selectOptions value="{!numberOfRentalProperties}"></apex:selectOptions>
                              </apex:selectList>-->
                                        <label for="payTerms" id="payTermsLabel" style="position: relative; padding: 1rem 0rem;">Payment Terms</label>
                                        <select class="form-select" id="payTerms" style="width: 70%; padding-top: 3%; height: 54px;" onchange="calcFinance(this.value, true);">
                                            <option>No Financing</option>
                                            <!--1-->
                                            <option>2 Pay</option>
                                            <!--2-->
                                            <option>3 Pay</option>
                                            <!--3-->
                                            <option>4 Pay</option>
                                            <!--4-->
                                            <option>6 Pay</option>
                                            <!--5-->
                                            <option>Apply for Monthly Installments</option>
                                            <!--6-->
                                        </select>
                                    </div>
                                    <table id="payTable">
                                        <tr style="border-bottom: 1px solid rgba(18, 23, 36, 0.2);">
                                            <td>
                                                <p class="payTableTitle" style="margin-bottom: 10%;">Total Due</p>
                                            </td>
                                            <td>
                                                <p class="payTableAmount" id="payAmountDue" style="margin-bottom: 10%;"></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p class="payTableTitle" style="margin-top: 10%;">Due Today</p>
                                            </td>
                                            <td>
                                                <p class="payTableAmount" id="payAmountToday" style="margin-top: 10%;"></p>
                                            </td>
                                        </tr>
                                    </table>
                                    <p id="modalEditPayTermsErrors" style="color: red;"></p>
                                </div>
                                <div id="modalFooter">
                                    <button class="btnCloseModal" onclick="closeModalEditPayTerms(true);">Cancel</button>
                                    <button class="btnAddRow saveChanges" style="opacity: 1;" id="" onclick="savePayTerms();">Save Changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="paymentDetails">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Verify Information</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Payment Details
                            </p>
                        </div>
                        <div class="formTxt">
                            <iframe id="Changeover" title="Changeover" height="100%" width="100%" class="changeover" scrolling="yes" src=""> </iframe>
                        </div>
                        <!-- <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                <br />
                                Do you want to use a Visa, Mastercard, American Express, or Discover card for your initial investment today of <span id="finalAmou"></span>
                                <span id="finalMonthAmou"></span>
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     Listen. Do not say anything.
                                </p>
                            </div>
                        </div> -->
                        <div class="formTxt" id="cardInformation">
                            <p class="normalTxt formTxtbottom" id="script">
                                To confirm, you, {!businessOwner.First_Name__c} {!businessOwner.Last_Name__c} are the cardholder and are authorized to approve this transaction, correct?
                            </p>
                            <div id="engage">
                                <p id="engageTxt">
                                     They must be the Cardholder and/or the Cardholder must be present to give authorization
                                </p>
                            </div>

                            
                            
                            <!-- finalAmount is set to formatMoney(getDueToday()) -->
                            <!-- finalMonthAmount is set to formatMoney(monthlyTotal), based on sum of products with monthly billing freq -->
                            <!-- paymentAmount is set to  formatMoney(getInstallmentAmount()) -->
                            <!-- day is set to the # of today's date -->
                            <!-- planLength is set to numberOfPayments -1 -->
                            <p class="normalTxt formTxtbottom" id="script" style="margin-top: 45px;">
                                <span id="noFinancingScript">
                                    As confirmation, we will be charging <span id="finalAmount"></span> today <span id="monthAmountText" style="display: none">, and <span id="finalMonthAmount"></span> per month</span>.
                                    <br /><br />
                                    Do you authorize this transaction?
                                </span>
                                
                                
                                <span id="financingScript">
                                    <br />
                                    As a confirmation, we will be charging <span id="finalAmount"></span> today, and <span id="paymentAmount"></span> will be processed on the <span id="numDay"></span> of every month for the next <span id="planLength"></span>
                                    months until the payment is made in full.
                                    <br /><br />
                                    Do you authorize these transactions?
                                </span>
                            </p>
                            <div id="engage" style="margin-top: 35px;">
                                <p id="engageTxt">
                                     They must be the Cardholder and/or the Cardholder must be present to give authorization
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    Do you authorize this transaction and these terms?
                                </p>
                            </div>
                            
                            <input type="checkbox" id="authorizes" name="authorizes" onchange="activateNext();" />
                            <label class="normalTxt formTxtbottom" for="authorizes" style="display: inline;">&nbsp;The client authorizes this transaction and terms. (Required)</label>
                            
                            <div id="buttons" style="margin-bottom: 3%; margin-top: 5%; display: block;">
                                <p id="PostPurchaseError" style="color: red; padding-bottom: 10px; font-size: 18px; line-height: 28px; letter-spacing: 0.01em;"></p>
                                <button type="button" class="start" id="nextPayment" style="color: white;" onclick="isOpportunityPaid();"><i class="fas fa-arrow-right">&nbsp;</i>Continue</button>
                                <div class="divider"></div>
                                <p class="blast">Post Purchase</p>
                            </div>

                            <div Id="emailSent">
                                <p Id="engageTxt">
                                     Email sent to the client.
                                </p>
                            </div>

                            <div id="buttons">
                                <button type="button" id="btnSendQuote" onclick="sendQuoteByEmail();"><i class="fas fa-arrow-right">&nbsp;</i>Send Quote Via Email</button>
                                <button type="button" id="btnSendQuote" onclick="followUpCall();"><i class="fas fa-arrow-right">&nbsp;</i>Schedule a Follow-Up</button>
                            </div>
                            <p id="commonObjections">Common Objections</p>
                            <button class="accordion" onclick="accordionFunct(this, '1');">
                                I want to think about it<span class="material-icons arrows" id="lessArrow1">expand_less</span><span class="material-icons arrows" id="moreArrow1">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I understand. This is an important decision for you and your business. May I ask: What is it you will be thinking about the most?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    Extending conversation with tax strategy and urgency.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Extending conversation with strategy and urgency, then back to $
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '2');">
                                My business isnt making money<span class="material-icons arrows" id="lessArrow2">expand_less</span><span class="material-icons arrows" id="moreArrow2">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    It is common for a new business to have more money going out than coming in and as a new business owner, you could use that to your advantage.
                                    <br /><br />
                                    That said, its important that were strategizing every deduction and credit you are entitled to. Also, we need to ensure youre addressing your ECE with as soon as possible. Our whole goal is to make
                                    sure youre not funding the IRS {!businessOwner.First_Name__c}.
                                    <br /><br />
                                    Is it more of the investment youre thinking about, or the services?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    Extending conversation with tax strategy and urgency.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Extending conversation with strategy and urgency, then back to $
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '3');">
                                I need to speak with spouse/partner<span class="material-icons arrows" id="lessArrow3">expand_less</span><span class="material-icons arrows" id="moreArrow3">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I can understand. This is an important decision.
                                    <br /><br />
                                    May I ask what you think your spouse/partner will be thinking about the most?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Value</spam>
                                    <br />
                                    I know it feels like yesterday since you set your business up in {{Date}}, so we have some catching up to do.
                                    <br /><br />
                                    The good news is you are on the phone with me today.
                                    <br /><br />
                                    The next steps are very simple {!businessOwner.First_Name__c}, lets schedule your Discovery call on a day that works for you and your spouse.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If Money</spam>
                                    <br />
                                    Having everyone on the same page is important.
                                    <br /><br />
                                    Nevertheless, earlier you stated that you and your partner/spouse invested {{Invested Amount}} into your business, correct? This service ensures you protect that investment. In order to do that, its
                                    crucial that we create a comprehensive tax strategy that will help you find ways to recoup some of those startup costs.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '4');">
                                I read negative reviews of 1-800Accountant<span class="material-icons arrows" id="lessArrow4">expand_less</span><span class="material-icons arrows" id="moreArrow4">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I completely understand your concern. I also check reviews with the companies I may do business with and often factor them in prior to making a decision. So, I can absolutely relate with your concern.
                                    <br /><br />
                                    I want to assure you that a chief goal of 1-800Accountant is to not only meet but exceed the expectations of our clients. Keep in mind that we have an A rating with the Better Business Bureau, which is
                                    far above other well-known tax prep companies such as H &#38; R Block (1.2-star average rating) or TurboTax (1.1-star average rating.)
                                    <br /><br />
                                    We have earned the trust of hundreds of thousands of people like you for the past 20 years and that kind of trust has made us the nations leading virtual accounting firm. Additionally, whenever we do
                                    receive a negative review or a complaint from a customer, we ensure we go above and beyond to resolve the issue.
                                    <br /><br />
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '5');">
                                I want to research before moving forward<span class="material-icons arrows" id="lessArrow5">expand_less</span><span class="material-icons arrows" id="moreArrow5">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom" id="script">
                                    I understand. As a business owner, you want to ensure youre making the right decision for you and your business and I value that. Let me ask. What is it that youd like to research?
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If they want to research the company</spam>
                                    <br />
                                    As a business owner, I would want to research as well. Let me save you the hassle. {!opportunity.Account.Lead_Source__c} has done the research for you. They know what it takes for a business to be
                                    successful, and our accountants know what it takes for a business to be successful, which is why out of all the accounting firms in the country, they trust us with their clients.This is why we dont
                                    operate that way. Since we need to address your ECE, and the overall tax strategy for this year, let's at least set your discovery appointment and wont think about taxes until then.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If they want to compare</spam>
                                    <br />
                                    I understand, I would want to compare myself. One thing Id like to point out is that your typical local accountant will charge billable hours typically $200-$300 per hour. We dont charge per hour. This
                                    allows you the freedom to access your accountant whenever you feel the need arises.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                            <button class="accordion" onclick="accordionFunct(this, '6');">
                                I know a CPA or have a family member who is a CPA<span class="material-icons arrows" id="lessArrow6">expand_less</span><span class="material-icons arrows" id="moreArrow6">keyboard_arrow_down</span>
                            </button>
                            <div class="panel">
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If CPA is NOT a family member</spam>
                                    <br />
                                    Remember, we operate differently, we dont charge hourly fees or hidden costs which is why our services are so affordable for the start-up business owner.
                                </p>
                                <p class="normalTxt formTxtbottom optText" id="script">
                                    <spam id="optTitle">If CPA IS a family member</spam>
                                    <br />
                                    In my experience, a lot of business owners make it a common practice of keeping business and family separate. In the end its up to whatever works best for you. Keep in mind that you will have a team that
                                    will be here to minimize your stress and maximize your tax savings through on demand, unlimited access.
                                </p>
                                <p class="normalTxt formTxtbottom" id="script">
                                    With that in mind, would you like to use the same card you used with {!opportunity.Account.Lead_Source__c} or would you like to use another card?
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="slds-box slds-box_x-small slds-text-align_left slds-m-around--x-small" id="postPurchase">
                        <div class="backMenu">
                            <button type="button" class="backBtn" onclick="previousPage();">
                                <table id="backTable">
                                    <tr>
                                        <td>
                                            <span class="material-icons" id="backArrow">arrow_back</span>
                                        </td>
                                        <td>
                                            <p class="backTitle">Previous section</p>
                                            <p class="backDesc">Payment Details</p>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                        <div class="title">
                            <p class="titleTxt">
                                Post Purchase
                            </p>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                The first appointment I want to schedule with you today is your Onboarding meeting.
                                <br /><br />
                                This meeting will cover choosing your entity classification, information gathering, business goals, getting to know each other, expectations, and Q&#38;A. Once that is completed, your team will start strategizing and tax planning, drawing up your loan agreements, and more.
                                <br /><br />
                                I want to make sure to get you scheduled for the soonest time we have available. Are the mornings or afternoons typically better for you?
                            </p>
                        </div>

                        <div class="formTxt" style="height: 520px;">
                            <iframe id="Scheduler" title="Scheduler" height="100%" width="100%" class="scheduler" scrolling="yes" src=""> </iframe>
                        </div>
                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                CONGRATULATIONS and WELCOME to the 1-800Accountant family! Youve made an excellent decision for your business. We are so excited to partner with you and help you save time, money, and energy.
                                <br /><br />
                                We want you to be more focused on growing your business and making money, which is why you chose to work with us! 
                                <br /><br />
                                Over the next two weeks youll have a total of three introductory appointments: your onboarding meeting, scheduled for  [Date] at [Time], followed by two Advisory meetings. Setting aside time to attend these meetings will be important as this will begin the data collection, advisory, and planning process.
                                <br /><br />
                                We would like to continue sending you text message reminders for your meetings and any other action items that may be needed. 
                                <br /><br />
                                Is this okay with you?
                            </p>
                        </div>
                        <div id="engage">
                            <input type="checkbox" id="smsConsent" name="smsConsent" onchange="smsConsent(this);" />
                            <label class="normalTxt formTxtbottom" for="smsConsent">&nbsp;The client consents to receive text/SMS messages. (Optional)</label>
                        </div>

                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                In addition, Ive also just sent you three emails:
                                <br /><br />
                                The first is a confirmation of your first appointment that we just scheduled.
                                <br /><br />
                                The second is your invoice which outlines your services purchased:
                            </p>
                                <ul class="textList">
                                    <li>Advisory</li>
                                    <li>BTP (# of returns and list each business)</li>
                                    <li>PTP (# of returns)</li>
                                    <li>Online Portal Access with Bookkeeping Software</li>
                                    <li>Personal Financial Planning</li>
                                    <li>ECE Filing (if applicable)</li>
                                    <li>BOI Filing (unless Tailor Brands)</li>
                                    <li>[List any add-ons]</li>
                                </ul>
                                <br /><br />
                            <p class="normalTxt formTxtbottom" id="script">
                            The last and most important email to get started is your welcome email with your login information to the portal.

                            </p>
                            
                        </div>

                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                Attending meetings with your tax advisor, logging into your portal, syncing your bank transactions in the bookkeeping software, responding to messages, and uploading any requested documents will ensure a smooth and productive experience. When youre doing your part, that allows us to do ours.
                                <br /><br />
                                If for any reason you have questions, dont worry, your accountant can address them during your appointment!
                            </p>
                        </div>

                        <div id="engage">
                            <p id="engageTxt">
                                 Mention the survey.
                            </p>
                        </div>

                        <div class="formTxt">
                            <p class="normalTxt formTxtbottom" id="script">
                                My manager is going to be sending you a quick two-question survey. I'd appreciate it if you shared your good experience with us today!
                            </p>
                        </div>

                        <div class="formTxt" id="btn-post">
                            <div id="buttons">
                                <button type="button" class="start" id="ending" style="color: white;" onclick="endPresentation();"><span class="material-icons" style="vertical-align: middle;">close</span>&nbsp;End Presentation</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

    </apex:form>
    </html>
</apex:page>